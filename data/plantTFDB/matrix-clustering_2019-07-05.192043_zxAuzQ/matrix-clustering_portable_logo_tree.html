<!DOCTYPE html>
<meta charset="utf-8">

<head>
  <script type="text/javascript" src="js/DataTables-1.10.4/media/js/jquery.js"></script>
  <script type="text/javascript" src="js/d3.v3.min.js"></script>
  <title>Small Logo Forest </title>
  <link rel="stylesheet" type="text/css" href="stylesheet.css"/>
</head>


<style>

        .node {
                cursor: pointer;
        }

	.node circle {
		//fill: #fff;
		//stroke: steelblue;
		stroke-width: 2px;
	}


	.node {
		font: 12px sans-serif;
	}


	.link {
		fill: none;
		//stroke: #0D86D7;
		stroke-width: 1.5px;
	}
	
	svg {
		pointer-events: all;
		background-color: white;
		overflow: scroll;
	}

        #Logo_forest_header{
	   float: left;
	   margin: 7px 5px 7px 5px;
	   width: 1280px;
	   height: 380px;
	   position: relative;
	   display: block;
	   text-align: left;
	   clear : both;
	   color: black;
	   font-size: 16px;
	   border-radius:5px;
           background: #B1D4F9;
        }

	.legend {
	   text-align: left;
	   border-radius:5px;       
      	   text-align: center;
	   margin: 3px 5px 5px 5px;
	   width: 130px;
	   height: 20px;
	   padding: 4px;
	   cursor: pointer;
	   border-radius:5px;
           color: #ffffff;
           background:#cc0000;

	   display: inline-block;
	   position:relative;
	}

	.legend:active {
	   position:relative;
	   top:2px;
	}

</style>


<body>	

<div id="Logo_forest_header">
   <div><h2 style="text-align:center">Dynamic Logo Forest</h2></div>
   <ul>
      <li type="square" style="color:red;">We reccomend to use Firefox to display this page.</li>
      <li type="square">All the clusters with their respective motifs are represented as  a collection of hierarchical trees (Forest).</li>
      <li type="square">Each cluster has a different color and contains the following components:</li>
   </ul>
   <ol>
      <li>The hierarchical tree.</li>
      <li>At each collapsed node, the Branch motif (the summary of the descendant motifs of that branch, also known as Familial Binding Profile (FBP) ).</li>
      <li>The motif ID + other optional motif features are depicted in the leaves.</li>
      <li>The aligned logos are shown in the leaves.</li>
   </ol>
   <ul>
   <p><h3>Dynamic Features</h3>
      <ol>
         <li type="square">Click on each node to collapse it and display the Branch motif.</li>
         <li type="square">Click on the node again to expand the tree and show the descendant motifs.</li>
         <li type="square">Click on the buttons to change the logo (Direct|Reverse) orientation.</li>
         <li type="square">Click on the buttons to show the IC content at each branch.</li>
      </ol>
   </p>
   </ul>
</div>
.<br><br><br>

<div id="cluster_1" style="clear:both;border-left:100px;float:left;"><h2>cluster_1</h2></div>
<br><br><br>
<div id="cluster_10" style="clear:both;border-left:100px;float:left;"><h2>cluster_10</h2></div>
<br><br><br>
<div id="cluster_11" style="clear:both;border-left:100px;float:left;"><h2>cluster_11</h2></div>
<br><br><br>
<div id="cluster_12" style="clear:both;border-left:100px;float:left;"><h2>cluster_12</h2></div>
<br><br><br>
<div id="cluster_13" style="clear:both;border-left:100px;float:left;"><h2>cluster_13</h2></div>
<br><br><br>
<div id="cluster_14" style="clear:both;border-left:100px;float:left;"><h2>cluster_14</h2></div>
<br><br><br>
<div id="cluster_15" style="clear:both;border-left:100px;float:left;"><h2>cluster_15</h2></div>
<br><br><br>
<div id="cluster_16" style="clear:both;border-left:100px;float:left;"><h2>cluster_16</h2></div>
<br><br><br>
<div id="cluster_17" style="clear:both;border-left:100px;float:left;"><h2>cluster_17</h2></div>
<br><br><br>
<div id="cluster_18" style="clear:both;border-left:100px;float:left;"><h2>cluster_18</h2></div>
<br><br><br>
<div id="cluster_19" style="clear:both;border-left:100px;float:left;"><h2>cluster_19</h2></div>
<br><br><br>
<div id="cluster_2" style="clear:both;border-left:100px;float:left;"><h2>cluster_2</h2></div>
<br><br><br>
<div id="cluster_20" style="clear:both;border-left:100px;float:left;"><h2>cluster_20</h2></div>
<br><br><br>
<div id="cluster_21" style="clear:both;border-left:100px;float:left;"><h2>cluster_21</h2></div>
<br><br><br>
<div id="cluster_22" style="clear:both;border-left:100px;float:left;"><h2>cluster_22</h2></div>
<br><br><br>
<div id="cluster_23" style="clear:both;border-left:100px;float:left;"><h2>cluster_23</h2></div>
<br><br><br>
<div id="cluster_24" style="clear:both;border-left:100px;float:left;"><h2>cluster_24</h2></div>
<br><br><br>
<div id="cluster_25" style="clear:both;border-left:100px;float:left;"><h2>cluster_25</h2></div>
<br><br><br>
<div id="cluster_26" style="clear:both;border-left:100px;float:left;"><h2>cluster_26</h2></div>
<br><br><br>
<div id="cluster_27" style="clear:both;border-left:100px;float:left;"><h2>cluster_27</h2></div>
<br><br><br>
<div id="cluster_28" style="clear:both;border-left:100px;float:left;"><h2>cluster_28</h2></div>
<br><br><br>
<div id="cluster_29" style="clear:both;border-left:100px;float:left;"><h2>cluster_29</h2></div>
<br><br><br>
<div id="cluster_3" style="clear:both;border-left:100px;float:left;"><h2>cluster_3</h2></div>
<br><br><br>
<div id="cluster_30" style="clear:both;border-left:100px;float:left;"><h2>cluster_30</h2></div>
<br><br><br>
<div id="cluster_31" style="clear:both;border-left:100px;float:left;"><h2>cluster_31</h2></div>
<br><br><br>
<div id="cluster_32" style="clear:both;border-left:100px;float:left;"><h2>cluster_32</h2></div>
<br><br><br>
<div id="cluster_33" style="clear:both;border-left:100px;float:left;"><h2>cluster_33</h2></div>
<br><br><br>
<div id="cluster_34" style="clear:both;border-left:100px;float:left;"><h2>cluster_34</h2></div>
<br><br><br>
<div id="cluster_35" style="clear:both;border-left:100px;float:left;"><h2>cluster_35</h2></div>
<br><br><br>
<div id="cluster_36" style="clear:both;border-left:100px;float:left;"><h2>cluster_36</h2></div>
<br><br><br>
<div id="cluster_37" style="clear:both;border-left:100px;float:left;"><h2>cluster_37</h2></div>
<br><br><br>
<div id="cluster_38" style="clear:both;border-left:100px;float:left;"><h2>cluster_38</h2></div>
<br><br><br>
<div id="cluster_39" style="clear:both;border-left:100px;float:left;"><h2>cluster_39</h2></div>
<br><br><br>
<div id="cluster_4" style="clear:both;border-left:100px;float:left;"><h2>cluster_4</h2></div>
<br><br><br>
<div id="cluster_40" style="clear:both;border-left:100px;float:left;"><h2>cluster_40</h2></div>
<br><br><br>
<div id="cluster_41" style="clear:both;border-left:100px;float:left;"><h2>cluster_41</h2></div>
<br><br><br>
<div id="cluster_42" style="clear:both;border-left:100px;float:left;"><h2>cluster_42</h2></div>
<br><br><br>
<div id="cluster_43" style="clear:both;border-left:100px;float:left;"><h2>cluster_43</h2></div>
<br><br><br>
<div id="cluster_44" style="clear:both;border-left:100px;float:left;"><h2>cluster_44</h2></div>
<br><br><br>
<div id="cluster_45" style="clear:both;border-left:100px;float:left;"><h2>cluster_45</h2></div>
<br><br><br>
<div id="cluster_46" style="clear:both;border-left:100px;float:left;"><h2>cluster_46</h2></div>
<br><br><br>
<div id="cluster_47" style="clear:both;border-left:100px;float:left;"><h2>cluster_47</h2></div>
<br><br><br>
<div id="cluster_48" style="clear:both;border-left:100px;float:left;"><h2>cluster_48</h2></div>
<br><br><br>
<div id="cluster_49" style="clear:both;border-left:100px;float:left;"><h2>cluster_49</h2></div>
<br><br><br>
<div id="cluster_5" style="clear:both;border-left:100px;float:left;"><h2>cluster_5</h2></div>
<br><br><br>
<div id="cluster_50" style="clear:both;border-left:100px;float:left;"><h2>cluster_50</h2></div>
<br><br><br>
<div id="cluster_51" style="clear:both;border-left:100px;float:left;"><h2>cluster_51</h2></div>
<br><br><br>
<div id="cluster_52" style="clear:both;border-left:100px;float:left;"><h2>cluster_52</h2></div>
<br><br><br>
<div id="cluster_53" style="clear:both;border-left:100px;float:left;"><h2>cluster_53</h2></div>
<br><br><br>
<div id="cluster_54" style="clear:both;border-left:100px;float:left;"><h2>cluster_54</h2></div>
<br><br><br>
<div id="cluster_55" style="clear:both;border-left:100px;float:left;"><h2>cluster_55</h2></div>
<br><br><br>
<div id="cluster_56" style="clear:both;border-left:100px;float:left;"><h2>cluster_56</h2></div>
<br><br><br>
<div id="cluster_6" style="clear:both;border-left:100px;float:left;"><h2>cluster_6</h2></div>
<br><br><br>
<div id="cluster_7" style="clear:both;border-left:100px;float:left;"><h2>cluster_7</h2></div>
<br><br><br>
<div id="cluster_8" style="clear:both;border-left:100px;float:left;"><h2>cluster_8</h2></div>
<br><br><br>
<div id="cluster_9" style="clear:both;border-left:100px;float:left;"><h2>cluster_9</h2></div>
<br><br><br>



	<script type="text/javascript">



	(function() {
        var width = 2500,
	height = 50 + 87 * 28;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_1").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wmrwrdwtGmTGACGTsrcarw",
 "branch" : 25,
 "id" : "cluster_1_node_25",
 "ic" : "9.66",
 "size" : 22,
 "name" : "cluster_1",
 "image" : "matrix-clustering_aligned_logos/cluster_1_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_logo_rc.png",

  "children": [
  {
  "consensus" : "wdwwGmTGACGTGGCarw",
 "branch" : 22,
 "id" : "cluster_1_node_22",
 "ic" : "10.98",
 "size" : 22,
 "name" : "cluster_1_node_22_16motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_22_16motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_22_16motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wdwwGvTGACGTGGCarw",
 "branch" : 20,
 "id" : "cluster_1_node_20",
 "ic" : "10.97",
 "size" : 22,
 "name" : "cluster_1_node_20_13motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_20_13motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_20_13motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwwGmTGACGTGGCa",
 "branch" : 16,
 "id" : "cluster_1_node_16",
 "ic" : "10.84",
 "size" : 22,
 "name" : "cluster_1_node_16_12motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_16_12motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_16_12motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwwkvtsACGTGGCA",
 "branch" : 12,
 "id" : "cluster_1_node_12",
 "ic" : "10.73",
 "size" : 22,
 "name" : "cluster_1_node_12_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_12_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_12_5motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m368_AT3G56850", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m368_AT3G56850_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m368_AT3G56850_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m368_AT3G56850_logo.png",
 "name" : "AT3G56850",
 "ic" : "11.66",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGMCACGTSWCCWWW"
 },
 {
  "consensus" : "dwwkvtsACGTGGCa",
 "branch" : 11,
 "id" : "cluster_1_node_11",
 "ic" : "10.62",
 "size" : 22,
 "name" : "cluster_1_node_11_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_11_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_11_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwwkstsACGTGGCA",
 "branch" : 10,
 "id" : "cluster_1_node_10",
 "ic" : "10.98",
 "size" : 22,
 "name" : "cluster_1_node_10_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_10_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_10_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwwkstsACGTGGCa",
 "branch" : 8,
 "id" : "cluster_1_node_8",
 "ic" : "10.88",
 "size" : 22,
 "name" : "cluster_1_node_8_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_8_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_8_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m258_AT2G46270", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m258_AT2G46270_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m258_AT2G46270_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m258_AT2G46270_logo.png",
 "name" : "AT2G46270",
 "ic" : "11.51",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "DWWKSTSACGTGGCA"
 },
 {
  "label": "a.t_motifs_m68_AT1G32150", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m68_AT1G32150_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m68_AT1G32150_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m68_AT1G32150_logo.png",
 "name" : "AT1G32150",
 "ic" : "10.39",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "DWWKSTSACGTGGCA"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m224_AT2G35530", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m224_AT2G35530_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m224_AT2G35530_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m224_AT2G35530_logo.png",
 "name" : "AT2G35530",
 "ic" : "11.38",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGCCACGTSRSMWWH"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m292_AT3G10800", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m292_AT3G10800_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m292_AT3G10800_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m292_AT3G10800_logo.png",
 "name" : "AT3G10800",
 "ic" : "9.97",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGMCACGTSAYCWWH"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "dwtGmTGACGTGGCa",
 "branch" : 15,
 "id" : "cluster_1_node_15",
 "ic" : "11.67",
 "size" : 22,
 "name" : "cluster_1_node_15_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_15_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_15_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwtGmTGACGTGGCa",
 "branch" : 13,
 "id" : "cluster_1_node_13",
 "ic" : "11.55",
 "size" : 22,
 "name" : "cluster_1_node_13_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_13_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_13_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwwGmTGACGTGGCa",
 "branch" : 7,
 "id" : "cluster_1_node_7",
 "ic" : "12.00",
 "size" : 22,
 "name" : "cluster_1_node_7_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_7_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_7_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwwGmTGACGTGGCa",
 "branch" : 5,
 "id" : "cluster_1_node_5",
 "ic" : "11.68",
 "size" : 22,
 "name" : "cluster_1_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m511_AT5G15830", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m511_AT5G15830_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m511_AT5G15830_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m511_AT5G15830_logo.png",
 "name" : "AT5G15830",
 "ic" : "11.38",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGCCACGTCAKCWWH"
 },
 {
  "label": "a.t_motifs_m189_AT2G18160", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m189_AT2G18160_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m189_AT2G18160_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m189_AT2G18160_logo.png",
 "name" : "AT2G18160",
 "ic" : "12.04",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGCCACGTCAGCWWH"
 } 
 ] 
 },
 {
  "consensus" : "dwwGmTGACGTGGCa",
 "branch" : 4,
 "id" : "cluster_1_node_4",
 "ic" : "12.36",
 "size" : 22,
 "name" : "cluster_1_node_4_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_4_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_4_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwwGmTGACGTGGCa",
 "branch" : 1,
 "id" : "cluster_1_node_1",
 "ic" : "12.33",
 "size" : 22,
 "name" : "cluster_1_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m384_AT3G62420", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m384_AT3G62420_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m384_AT3G62420_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m384_AT3G62420_logo.png",
 "name" : "AT3G62420",
 "ic" : "12.33",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGCCACGTCAKCWWH"
 },
 {
  "label": "a.t_motifs_m453_AT4G34590", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m453_AT4G34590_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m453_AT4G34590_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m453_AT4G34590_logo.png",
 "name" : "AT4G34590",
 "ic" : "12.33",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "DWWGMTGACGTGGCA"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m154_AT1G75390", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m154_AT1G75390_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m154_AT1G75390_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m154_AT1G75390_logo.png",
 "name" : "AT1G75390",
 "ic" : "12.59",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGCCACGTCAKCWWH"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m501_AT5G11260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m501_AT5G11260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m501_AT5G11260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m501_AT5G11260_logo.png",
 "name" : "AT5G11260",
 "ic" : "10.89",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "KGCSACGTCATCAWH"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m182_AT2G04038", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m182_AT2G04038_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m182_AT2G04038_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m182_AT2G04038_logo.png",
 "name" : "AT2G04038",
 "ic" : "12.63",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "DWTGCTGACGTGGM"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m227_AT2G36270", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m227_AT2G36270_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m227_AT2G36270_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m227_AT2G36270_logo.png",
 "name" : "AT2G36270",
 "ic" : "11.61",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "WYTGMCACGTSWYCWYHW"
 } 
 ] 
 },
 {
  "consensus" : "tGCTGACGTGGm",
 "branch" : 17,
 "id" : "cluster_1_node_17",
 "ic" : "11.85",
 "size" : 22,
 "name" : "cluster_1_node_17_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_17_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_17_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m537_AT5G28770", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m537_AT5G28770_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m537_AT5G28770_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m537_AT5G28770_logo.png",
 "name" : "AT5G28770",
 "ic" : "7.97",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCCACGTSAGCA"
 },
 {
  "consensus" : "TGCTGACGTGGM",
 "branch" : 6,
 "id" : "cluster_1_node_6",
 "ic" : "13.68",
 "size" : 22,
 "name" : "cluster_1_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m540_AT5G38800", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m540_AT5G38800_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m540_AT5G38800_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m540_AT5G38800_logo.png",
 "name" : "AT5G38800",
 "ic" : "13.48",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGCTGACGTGGM"
 },
 {
  "label": "a.t_motifs_m341_AT3G30530", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m341_AT3G30530_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m341_AT3G30530_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m341_AT3G30530_logo.png",
 "name" : "AT3G30530",
 "ic" : "13.92",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "KCCACGTCAGCA"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "wmrwrrwtGmTGACGTCAyya",
 "branch" : 24,
 "id" : "cluster_1_node_24",
 "ic" : "11.47",
 "size" : 22,
 "name" : "cluster_1_node_24_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_24_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_24_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wmrwrrwtGmTGACGTCAyya",
 "branch" : 23,
 "id" : "cluster_1_node_23",
 "ic" : "11.71",
 "size" : 22,
 "name" : "cluster_1_node_23_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_23_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_23_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rrwtGmTGACGTCAyya",
 "branch" : 19,
 "id" : "cluster_1_node_19",
 "ic" : "11.53",
 "size" : 22,
 "name" : "cluster_1_node_19_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_19_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_19_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rwtGmTGACGTCAyy",
 "branch" : 14,
 "id" : "cluster_1_node_14",
 "ic" : "11.60",
 "size" : 22,
 "name" : "cluster_1_node_14_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_14_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_14_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wtGmTGACGTCAyh",
 "branch" : 2,
 "id" : "cluster_1_node_2",
 "ic" : "11.94",
 "size" : 22,
 "name" : "cluster_1_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m488_AT5G06960", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m488_AT5G06960_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m488_AT5G06960_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m488_AT5G06960_logo.png",
 "name" : "AT5G06960",
 "ic" : "12.11",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTGMTGACGTCAYH"
 },
 {
  "label": "a.t_motifs_m47_AT1G22070", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m47_AT1G22070_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m47_AT1G22070_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m47_AT1G22070_logo.png",
 "name" : "AT1G22070",
 "ic" : "11.82",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTGMTGACGTCAYH"
 } 
 ] 
 },
 {
  "consensus" : "rwtGmTGACGTCAyy",
 "branch" : 9,
 "id" : "cluster_1_node_9",
 "ic" : "11.38",
 "size" : 22,
 "name" : "cluster_1_node_9_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_9_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_9_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rwtGmTGACGTCAyy",
 "branch" : 3,
 "id" : "cluster_1_node_3",
 "ic" : "11.73",
 "size" : 22,
 "name" : "cluster_1_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m297_AT3G12250", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m297_AT3G12250_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m297_AT3G12250_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m297_AT3G12250_logo.png",
 "name" : "AT3G12250",
 "ic" : "11.76",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWTGMTGACGTCAYH"
 },
 {
  "label": "a.t_motifs_m607_AT5G65210", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m607_AT5G65210_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m607_AT5G65210_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m607_AT5G65210_logo.png",
 "name" : "AT5G65210",
 "ic" : "11.76",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "RRTGACGTCAKCAWH"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m486_AT5G06839", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m486_AT5G06839_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m486_AT5G06839_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m486_AT5G06839_logo.png",
 "name" : "AT5G06839",
 "ic" : "11.03",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "RRTGACGTCAKCATY"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m163_AT1G77920", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m163_AT1G77920_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m163_AT1G77920_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m163_AT1G77920_logo.png",
 "name" : "AT1G77920",
 "ic" : "11.79",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "RRAWRRTGACGTCAKCA"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m487_AT5G06950", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m487_AT5G06950_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m487_AT5G06950_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m487_AT5G06950_logo.png",
 "name" : "AT5G06950",
 "ic" : "12.08",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "WMRWWRWTGMTGACGTCAYY"
 } 
 ] 
 },
 {
  "consensus" : "tGmTGACGTCAy",
 "branch" : 21,
 "id" : "cluster_1_node_21",
 "ic" : "10.55",
 "size" : 22,
 "name" : "cluster_1_node_21_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_21_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_21_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GmTGACGTCAy",
 "branch" : 18,
 "id" : "cluster_1_node_18",
 "ic" : "11.12",
 "size" : 22,
 "name" : "cluster_1_node_18_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_1_node_18_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_1_node_18_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m17_AT1G08320", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m17_AT1G08320_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m17_AT1G08320_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m17_AT1G08320_logo.png",
 "name" : "AT1G08320",
 "ic" : "11.27",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "RTGACGTCAKC"
 },
 {
  "label": "a.t_motifs_m82_AT1G42990", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m82_AT1G42990_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m82_AT1G42990_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m82_AT1G42990_logo.png",
 "name" : "AT1G42990",
 "ic" : "8.14",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "RTGACGTCAY"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m497_AT5G10030", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m497_AT5G10030_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m497_AT5G10030_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m497_AT5G10030_logo.png",
 "name" : "AT5G10030",
 "ic" : "9.72",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGMTGACGTCA"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 300; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_1").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#1A9E77");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_1"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#1A9E77"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_1" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#1A9E77")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_1").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_1").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_1").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_1").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 12;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_2").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "taAGATATTTtttktTGb",
 "branch" : 9,
 "id" : "cluster_2_node_9",
 "ic" : "11.69",
 "size" : 18,
 "name" : "cluster_2",
 "image" : "matrix-clustering_aligned_logos/cluster_2_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m27_AT1G13260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m27_AT1G13260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m27_AT1G13260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m27_AT1G13260_logo.png",
 "name" : "AT1G13260",
 "ic" : "9.26",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "VCAACARAAWWHAYCWK"
 },
 {
  "consensus" : "twAGATATTTttwtw",
 "branch" : 8,
 "id" : "cluster_2_node_8",
 "ic" : "10.83",
 "size" : 18,
 "name" : "cluster_2_node_8_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_8_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_8_9motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m264_AT2G46830", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m264_AT2G46830_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m264_AT2G46830_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m264_AT2G46830_logo.png",
 "name" : "AT2G46830",
 "ic" : "9.69",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "AGATATTT"
 },
 {
  "consensus" : "twAGATATTTttwtw",
 "branch" : 7,
 "id" : "cluster_2_node_7",
 "ic" : "10.92",
 "size" : 18,
 "name" : "cluster_2_node_7_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_7_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_7_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "AGATATTTTtwt",
 "branch" : 5,
 "id" : "cluster_2_node_5",
 "ic" : "10.86",
 "size" : 18,
 "name" : "cluster_2_node_5_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_5_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_5_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "AGATATTTTt",
 "branch" : 2,
 "id" : "cluster_2_node_2",
 "ic" : "10.77",
 "size" : 18,
 "name" : "cluster_2_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m1_AT1G01060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m1_AT1G01060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m1_AT1G01060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m1_AT1G01060_logo.png",
 "name" : "AT1G01060",
 "ic" : "10.42",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "AWAAATATCT"
 },
 {
  "label": "a.t_motifs_m475_AT5G02840", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m475_AT5G02840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m475_AT5G02840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m475_AT5G02840_logo.png",
 "name" : "AT5G02840",
 "ic" : "11.31",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAATATCT"
 } 
 ] 
 },
 {
  "consensus" : "AGATATTTTtwt",
 "branch" : 4,
 "id" : "cluster_2_node_4",
 "ic" : "10.87",
 "size" : 18,
 "name" : "cluster_2_node_4_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_4_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_4_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m284_AT3G09600", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m284_AT3G09600_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m284_AT3G09600_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m284_AT3G09600_logo.png",
 "name" : "AT3G09600",
 "ic" : "10.76",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "AWAAAAATATCT"
 },
 {
  "consensus" : "AGATATTTTtt",
 "branch" : 1,
 "id" : "cluster_2_node_1",
 "ic" : "10.92",
 "size" : 18,
 "name" : "cluster_2_node_1_2motifs",
 "image" : ".",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m574_AT5G52660", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m574_AT5G52660_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m574_AT5G52660_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m574_AT5G52660_logo.png",
 "name" : "AT5G52660",
 "ic" : "10.96",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAAATATCT"
 },
 {
  "label": "a.t_motifs_m390_AT4G01280", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m390_AT4G01280_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m390_AT4G01280_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m390_AT4G01280_logo.png",
 "name" : "AT4G01280",
 "ic" : "10.90",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "WAAAAATATCT"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "twAGATATTTwywtw",
 "branch" : 6,
 "id" : "cluster_2_node_6",
 "ic" : "10.71",
 "size" : 18,
 "name" : "cluster_2_node_6_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_6_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_6_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "twAGATATTTwtwtw",
 "branch" : 3,
 "id" : "cluster_2_node_3",
 "ic" : "10.34",
 "size" : 18,
 "name" : "cluster_2_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_2_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_2_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m287_AT3G10113", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m287_AT3G10113_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m287_AT3G10113_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m287_AT3G10113_logo.png",
 "name" : "AT3G10113",
 "ic" : "10.39",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWAGATATTTWTWTW"
 },
 {
  "label": "a.t_motifs_m514_AT5G17300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m514_AT5G17300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m514_AT5G17300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m514_AT5G17300_logo.png",
 "name" : "AT5G17300",
 "ic" : "10.31",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWAGATATTTWTTT"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m35_AT1G18330", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m35_AT1G18330_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m35_AT1G18330_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m35_AT1G18330_logo.png",
 "name" : "AT1G18330",
 "ic" : "11.61",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWAGATATTTWY"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_2").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#55986A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_2"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#55986A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_2" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#55986A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_2").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_2").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_2").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_2").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 45;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_3").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "ddrwhwaaaAAAGTCAACgmywrttmaaa",
 "branch" : 42,
 "id" : "cluster_3_node_42",
 "ic" : "10.85",
 "size" : 29,
 "name" : "cluster_3",
 "image" : "matrix-clustering_aligned_logos/cluster_3_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_logo_rc.png",

  "children": [
  {
  "consensus" : "ddrwhwaaaAAAGTCAACgmywrttmaaa",
 "branch" : 41,
 "id" : "cluster_3_node_41",
 "ic" : "10.86",
 "size" : 29,
 "name" : "cluster_3_node_41_42motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_41_42motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_41_42motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaaAAAGTCAACgmywrttmaaa",
 "branch" : 40,
 "id" : "cluster_3_node_40",
 "ic" : "10.52",
 "size" : 29,
 "name" : "cluster_3_node_40_40motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_40_40motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_40_40motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaaAAAGTCAACgmh",
 "branch" : 39,
 "id" : "cluster_3_node_39",
 "ic" : "10.08",
 "size" : 29,
 "name" : "cluster_3_node_39_38motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_39_38motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_39_38motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "vyRGTCAACgg",
 "branch" : 38,
 "id" : "cluster_3_node_38",
 "ic" : "8.15",
 "size" : 29,
 "name" : "cluster_3_node_38_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_38_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_38_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "vyGGTCAAcgg",
 "branch" : 36,
 "id" : "cluster_3_node_36",
 "ic" : "8.08",
 "size" : 29,
 "name" : "cluster_3_node_36_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_36_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_36_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yRGTCAAc",
 "branch" : 24,
 "id" : "cluster_3_node_24",
 "ic" : "7.88",
 "size" : 29,
 "name" : "cluster_3_node_24_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_24_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_24_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yGGTCAAc",
 "branch" : 18,
 "id" : "cluster_3_node_18",
 "ic" : "7.62",
 "size" : 29,
 "name" : "cluster_3_node_18_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_18_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_18_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m121_AT1G66600", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m121_AT1G66600_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m121_AT1G66600_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m121_AT1G66600_logo.png",
 "name" : "AT1G66600",
 "ic" : "8.08",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTTGACCR"
 },
 {
  "label": "a.t_motifs_m579_AT5G56270", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m579_AT5G56270_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m579_AT5G56270_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m579_AT5G56270_logo.png",
 "name" : "AT5G56270",
 "ic" : "7.47",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "KTTGACYV"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m472_AT5G01900", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m472_AT5G01900_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m472_AT5G01900_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m472_AT5G01900_logo.png",
 "name" : "AT5G01900",
 "ic" : "9.12",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "KTTGACYA"
 } 
 ] 
 },
 {
  "consensus" : "vyGGTCAACgg",
 "branch" : 30,
 "id" : "cluster_3_node_30",
 "ic" : "8.09",
 "size" : 29,
 "name" : "cluster_3_node_30_3motifs",
 "image" : ".",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_30_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yGGTCAACGs",
 "branch" : 17,
 "id" : "cluster_3_node_17",
 "ic" : "8.06",
 "size" : 29,
 "name" : "cluster_3_node_17_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_17_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_17_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m248_AT2G44745", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m248_AT2G44745_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m248_AT2G44745_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m248_AT2G44745_logo.png",
 "name" : "AT2G44745",
 "ic" : "7.97",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "MGGTCAACGR"
 },
 {
  "label": "a.t_motifs_m525_AT5G22570", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m525_AT5G22570_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m525_AT5G22570_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m525_AT5G22570_logo.png",
 "name" : "AT5G22570",
 "ic" : "8.48",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "YRGTCAACGS"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m209_AT2G25000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m209_AT2G25000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m209_AT2G25000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m209_AT2G25000_logo.png",
 "name" : "AT2G25000",
 "ic" : "8.63",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "ASKTTGACCRB"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m266_AT2G47260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m266_AT2G47260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m266_AT2G47260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m266_AT2G47260_logo.png",
 "name" : "AT2G47260",
 "ic" : "9.24",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGTTGACY"
 } 
 ] 
 },
 {
  "consensus" : "aaaAAAGTCAACgmh",
 "branch" : 35,
 "id" : "cluster_3_node_35",
 "ic" : "10.10",
 "size" : 29,
 "name" : "cluster_3_node_35_31motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_35_31motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_35_31motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "raaAAAGTCAACgmh",
 "branch" : 34,
 "id" : "cluster_3_node_34",
 "ic" : "10.38",
 "size" : 29,
 "name" : "cluster_3_node_34_17motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_34_17motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_34_17motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "raaAAAGTCAACgmh",
 "branch" : 33,
 "id" : "cluster_3_node_33",
 "ic" : "10.37",
 "size" : 29,
 "name" : "cluster_3_node_33_16motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_33_16motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_33_16motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "raaAAAGTCAACgmh",
 "branch" : 29,
 "id" : "cluster_3_node_29",
 "ic" : "10.38",
 "size" : 29,
 "name" : "cluster_3_node_29_14motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_29_14motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_29_14motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aAAAGTCAACgmy",
 "branch" : 25,
 "id" : "cluster_3_node_25",
 "ic" : "10.13",
 "size" : 29,
 "name" : "cluster_3_node_25_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_25_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_25_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aAAAGTCAACgmy",
 "branch" : 20,
 "id" : "cluster_3_node_20",
 "ic" : "10.46",
 "size" : 29,
 "name" : "cluster_3_node_20_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_20_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_20_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aAAAGTCAACgmy",
 "branch" : 15,
 "id" : "cluster_3_node_15",
 "ic" : "10.78",
 "size" : 29,
 "name" : "cluster_3_node_15_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_15_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_15_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aAAAGTCAACkmt",
 "branch" : 3,
 "id" : "cluster_3_node_3",
 "ic" : "11.30",
 "size" : 29,
 "name" : "cluster_3_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m575_AT5G52830", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m575_AT5G52830_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m575_AT5G52830_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m575_AT5G52830_logo.png",
 "name" : "AT5G52830",
 "ic" : "11.86",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAGTCAACKMT"
 },
 {
  "label": "a.t_motifs_m389_AT4G01250", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m389_AT4G01250_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m389_AT4G01250_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m389_AT4G01250_logo.png",
 "name" : "AT4G01250",
 "ic" : "10.84",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "ATMGTTGACTTTT"
 } 
 ] 
 },
 {
  "consensus" : "aAAAGTCAACGvy",
 "branch" : 12,
 "id" : "cluster_3_node_12",
 "ic" : "10.56",
 "size" : 29,
 "name" : "cluster_3_node_12_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_12_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_12_4motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m489_AT5G07100", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m489_AT5G07100_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m489_AT5G07100_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m489_AT5G07100_logo.png",
 "name" : "AT5G07100",
 "ic" : "10.54",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "RBCGTTGACTTTT"
 },
 {
  "consensus" : "aAAAGTCAACGvh",
 "branch" : 8,
 "id" : "cluster_3_node_8",
 "ic" : "10.58",
 "size" : 29,
 "name" : "",
 "image" : ".",
 "image_rc" : ".",

  "children": [
  {
  "label": "a.t_motifs_m504_AT5G13080", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m504_AT5G13080_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m504_AT5G13080_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m504_AT5G13080_logo.png",
 "name" : "AT5G13080",
 "ic" : "10.01",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "DTCGTTGACTTTT"
 },
 {
  "consensus" : "aAAAGTCAACGsy",
 "branch" : 2,
 "id" : "cluster_3_node_2",
 "ic" : "10.96",
 "size" : 29,
 "name" : "cluster_3_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m66_AT1G30650", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m66_AT1G30650_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m66_AT1G30650_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m66_AT1G30650_logo.png",
 "name" : "AT1G30650",
 "ic" : "10.62",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "RKCGTTGACTTTT"
 },
 {
  "label": "a.t_motifs_m367_AT3G56400", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m367_AT3G56400_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m367_AT3G56400_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m367_AT3G56400_logo.png",
 "name" : "AT3G56400",
 "ic" : "11.36",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAGTCAACGSY"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m413_AT4G18170", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m413_AT4G18170_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m413_AT4G18170_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m413_AT4G18170_logo.png",
 "name" : "AT4G18170",
 "ic" : "9.30",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAGTCAAMGWH"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m433_AT4G26640", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m433_AT4G26640_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m433_AT4G26640_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m433_AT4G26640_logo.png",
 "name" : "AT4G26640",
 "ic" : "9.22",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWWRGTCAAMGBH"
 } 
 ] 
 },
 {
  "consensus" : "raaAAAGTCAACgmh",
 "branch" : 26,
 "id" : "cluster_3_node_26",
 "ic" : "10.69",
 "size" : 29,
 "name" : "cluster_3_node_26_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_26_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_26_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaAAAGTCAACgmy",
 "branch" : 14,
 "id" : "cluster_3_node_14",
 "ic" : "11.00",
 "size" : 29,
 "name" : "cluster_3_node_14_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_14_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_14_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaAAAGTCAACgmy",
 "branch" : 11,
 "id" : "cluster_3_node_11",
 "ic" : "11.46",
 "size" : 29,
 "name" : "cluster_3_node_11_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_11_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_11_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m208_AT2G24570", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m208_AT2G24570_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m208_AT2G24570_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m208_AT2G24570_logo.png",
 "name" : "AT2G24570",
 "ic" : "10.90",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "RBCGTTGACTTTTT"
 },
 {
  "consensus" : "aaAAAGTCAACgmy",
 "branch" : 6,
 "id" : "cluster_3_node_6",
 "ic" : "11.58",
 "size" : 29,
 "name" : "cluster_3_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m443_AT4G31550", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m443_AT4G31550_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m443_AT4G31550_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m443_AT4G31550_logo.png",
 "name" : "AT4G31550",
 "ic" : "10.92",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAAGTCAACGMY"
 },
 {
  "label": "a.t_motifs_m428_AT4G24240", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m428_AT4G24240_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m428_AT4G24240_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m428_AT4G24240_logo.png",
 "name" : "AT4G24240",
 "ic" : "12.42",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAAGTCAACGMY"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m257_AT2G46130", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m257_AT2G46130_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m257_AT2G46130_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m257_AT2G46130_logo.png",
 "name" : "AT2G46130",
 "ic" : "10.19",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAAGTCAACGAH"
 } 
 ] 
 },
 {
  "consensus" : "raaAAAGTCAAcgwh",
 "branch" : 21,
 "id" : "cluster_3_node_21",
 "ic" : "10.36",
 "size" : 29,
 "name" : "cluster_3_node_21_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_21_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_21_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m168_AT1G80840", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m168_AT1G80840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m168_AT1G80840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m168_AT1G80840_logo.png",
 "name" : "AT1G80840",
 "ic" : "9.35",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "RAAAAAGTCAAMRWH"
 },
 {
  "label": "a.t_motifs_m555_AT5G46350", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m555_AT5G46350_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m555_AT5G46350_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m555_AT5G46350_logo.png",
 "name" : "AT5G46350",
 "ic" : "11.97",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTCGTTGACTTTTTY"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "aAAGTCAACGch",
 "branch" : 27,
 "id" : "cluster_3_node_27",
 "ic" : "10.22",
 "size" : 29,
 "name" : "cluster_3_node_27_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_27_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_27_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m529_AT5G24110", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m529_AT5G24110_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m529_AT5G24110_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m529_AT5G24110_logo.png",
 "name" : "AT5G24110",
 "ic" : "10.71",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCGTTGACTTT"
 },
 {
  "label": "a.t_motifs_m239_AT2G40740", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m239_AT2G40740_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m239_AT2G40740_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m239_AT2G40740_logo.png",
 "name" : "AT2G40740",
 "ic" : "9.81",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAGTCAACGCH"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m547_AT5G41570", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m547_AT5G41570_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m547_AT5G41570_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m547_AT5G41570_logo.png",
 "name" : "AT5G41570",
 "ic" : "10.59",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAAAGTCAACGM"
 } 
 ] 
 },
 {
  "consensus" : "waaAAAGTCAAcg",
 "branch" : 32,
 "id" : "cluster_3_node_32",
 "ic" : "9.73",
 "size" : 29,
 "name" : "cluster_3_node_32_14motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_32_14motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_32_14motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "waaAAAGTCAAmr",
 "branch" : 28,
 "id" : "cluster_3_node_28",
 "ic" : "10.61",
 "size" : 29,
 "name" : "cluster_3_node_28_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_28_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_28_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaAAAGTCAAmg",
 "branch" : 23,
 "id" : "cluster_3_node_23",
 "ic" : "10.55",
 "size" : 29,
 "name" : "cluster_3_node_23_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_23_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_23_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m198_AT2G21900", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m198_AT2G21900_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m198_AT2G21900_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m198_AT2G21900_logo.png",
 "name" : "AT2G21900",
 "ic" : "9.03",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "YKTTGACTWWTK"
 },
 {
  "label": "a.t_motifs_m271_AT3G01970", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m271_AT3G01970_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m271_AT3G01970_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m271_AT3G01970_logo.png",
 "name" : "AT3G01970",
 "ic" : "11.29",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAAGTCAAMG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m535_AT5G26170", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m535_AT5G26170_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m535_AT5G26170_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m535_AT5G26170_logo.png",
 "name" : "AT5G26170",
 "ic" : "10.79",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "WAAAAAGTCAAMR"
 } 
 ] 
 },
 {
  "consensus" : "aaAAGTCAACg",
 "branch" : 31,
 "id" : "cluster_3_node_31",
 "ic" : "9.47",
 "size" : 29,
 "name" : "cluster_3_node_31_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_31_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_31_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaAAGTCAACg",
 "branch" : 22,
 "id" : "cluster_3_node_22",
 "ic" : "9.50",
 "size" : 29,
 "name" : "cluster_3_node_22_10motifs",
 "image" : ".",
 "image_rc" : ".",

  "children": [
  {
  "consensus" : "aaAAGTCAACg",
 "branch" : 19,
 "id" : "cluster_3_node_19",
 "ic" : "9.76",
 "size" : 29,
 "name" : "cluster_3_node_19_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_19_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_19_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaAAGTCAACG",
 "branch" : 13,
 "id" : "cluster_3_node_13",
 "ic" : "9.89",
 "size" : 29,
 "name" : "cluster_3_node_13_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_13_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_13_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m62_AT1G29280", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m62_AT1G29280_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m62_AT1G29280_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m62_AT1G29280_logo.png",
 "name" : "AT1G29280",
 "ic" : "10.05",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGTTGACTTTT"
 },
 {
  "label": "a.t_motifs_m259_AT2G46400", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m259_AT2G46400_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m259_AT2G46400_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m259_AT2G46400_logo.png",
 "name" : "AT2G46400",
 "ic" : "9.68",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGTTGACTTTK"
 } 
 ] 
 },
 {
  "consensus" : "aAAAGTCAACg",
 "branch" : 16,
 "id" : "cluster_3_node_16",
 "ic" : "9.79",
 "size" : 29,
 "name" : "cluster_3_node_16_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_16_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_16_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aawAGTCAAMg",
 "branch" : 9,
 "id" : "cluster_3_node_9",
 "ic" : "9.60",
 "size" : 29,
 "name" : "cluster_3_node_9_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_9_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_9_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaaAGTCAAmg",
 "branch" : 1,
 "id" : "cluster_3_node_1",
 "ic" : "9.68",
 "size" : 29,
 "name" : "cluster_3_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m233_AT2G38470", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m233_AT2G38470_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m233_AT2G38470_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m233_AT2G38470_logo.png",
 "name" : "AT2G38470",
 "ic" : "9.67",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKTTGACTWTT"
 },
 {
  "label": "a.t_motifs_m179_AT2G03340", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m179_AT2G03340_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m179_AT2G03340_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m179_AT2G03340_logo.png",
 "name" : "AT2G03340",
 "ic" : "9.71",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKTTGACTTTT"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m214_AT2G30250", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m214_AT2G30250_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m214_AT2G30250_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m214_AT2G30250_logo.png",
 "name" : "AT2G30250",
 "ic" : "9.53",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKTTGACYWTT"
 } 
 ] 
 },
 {
  "consensus" : "aAAAGTCAACg",
 "branch" : 10,
 "id" : "cluster_3_node_10",
 "ic" : "10.07",
 "size" : 29,
 "name" : "cluster_3_node_10_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_10_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_10_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aAAAGTCAACg",
 "branch" : 7,
 "id" : "cluster_3_node_7",
 "ic" : "10.62",
 "size" : 29,
 "name" : "cluster_3_node_7_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_7_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_7_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m63_AT1G29860", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m63_AT1G29860_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m63_AT1G29860_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m63_AT1G29860_logo.png",
 "name" : "AT1G29860",
 "ic" : "10.50",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKTTGACTTTT"
 },
 {
  "label": "a.t_motifs_m216_AT2G30590", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m216_AT2G30590_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m216_AT2G30590_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m216_AT2G30590_logo.png",
 "name" : "AT2G30590",
 "ic" : "10.82",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGTTGACTTTT"
 } 
 ] 
 },
 {
  "consensus" : "aaAAGTCAACk",
 "branch" : 4,
 "id" : "cluster_3_node_4",
 "ic" : "9.62",
 "size" : 29,
 "name" : "cluster_3_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m204_AT2G23320", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m204_AT2G23320_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m204_AT2G23320_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m204_AT2G23320_logo.png",
 "name" : "AT2G23320",
 "ic" : "9.51",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGTTGACTTTT"
 },
 {
  "label": "a.t_motifs_m425_AT4G23550", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m425_AT4G23550_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m425_AT4G23550_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m425_AT4G23550_logo.png",
 "name" : "AT4G23550",
 "ic" : "9.79",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "MGTTGACTTTT"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m445_AT4G31800", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m445_AT4G31800_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m445_AT4G31800_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m445_AT4G31800_logo.png",
 "name" : "AT4G31800",
 "ic" : "8.37",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "YSTTGACYTTK"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m132_AT1G69310", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m132_AT1G69310_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m132_AT1G69310_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m132_AT1G69310_logo.png",
 "name" : "AT1G69310",
 "ic" : "5.48",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKTTGACYWT"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "aamwwrGTCAACgmywrttmaaa",
 "branch" : 37,
 "id" : "cluster_3_node_37",
 "ic" : "9.66",
 "size" : 29,
 "name" : "cluster_3_node_37_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_37_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_37_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m396_AT4G04450", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m396_AT4G04450_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m396_AT4G04450_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m396_AT4G04450_logo.png",
 "name" : "AT4G04450",
 "ic" : "9.94",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "MWWRGTCAACGMYRDKTMAAA"
 },
 {
  "label": "a.t_motifs_m395_AT4G01720", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m395_AT4G01720_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m395_AT4G01720_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m395_AT4G01720_logo.png",
 "name" : "AT4G01720",
 "ic" : "9.24",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAMWWRGTCAACGMYWRTT"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "ddrwhwrmmwaRGTCAACg",
 "branch" : 5,
 "id" : "cluster_3_node_5",
 "ic" : "10.23",
 "size" : 29,
 "name" : "cluster_3_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_3_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_3_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m114_AT1G62300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m114_AT1G62300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m114_AT1G62300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m114_AT1G62300_logo.png",
 "name" : "AT1G62300",
 "ic" : "10.26",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "DDRWHWRMMWWRGTCAACG"
 },
 {
  "label": "a.t_motifs_m424_AT4G22070", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m424_AT4G22070_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m424_AT4G22070_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m424_AT4G22070_logo.png",
 "name" : "AT4G22070",
 "ic" : "10.29",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGTTGACYTTKKYWWWYMH"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m183_AT2G04880", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m183_AT2G04880_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m183_AT2G04880_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m183_AT2G04880_logo.png",
 "name" : "AT2G04880",
 "ic" : "10.14",
 "size" : 29,
 "title" : "a.t_motifs",
 "consensus_rc" : "RRCTCGGTCAA"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 300; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_3").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#73925E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_3"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#73925E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_3" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#73925E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_3").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_3").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_3").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_3").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 11;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_4").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "dwgATGwTGrA",
 "branch" : 8,
 "id" : "cluster_4_node_8",
 "ic" : "8.50",
 "size" : 11,
 "name" : "cluster_4",
 "image" : "matrix-clustering_aligned_logos/cluster_4_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_4_logo_rc.png",

  "children": [
  {
  "consensus" : "dwgATGATGgA",
 "branch" : 7,
 "id" : "cluster_4_node_7",
 "ic" : "9.01",
 "size" : 11,
 "name" : "cluster_4_node_7_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_4_node_7_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_4_node_7_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "gATGATGGA",
 "branch" : 6,
 "id" : "cluster_4_node_6",
 "ic" : "8.82",
 "size" : 11,
 "name" : "cluster_4_node_6_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_4_node_6_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_4_node_6_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "tMTGTTGy",
 "branch" : 3,
 "id" : "cluster_4_node_3",
 "ic" : "8.49",
 "size" : 11,
 "name" : "cluster_4_node_3_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_4_node_3_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_4_node_3_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "tATGTTGC",
 "branch" : 2,
 "id" : "cluster_4_node_2",
 "ic" : "8.32",
 "size" : 11,
 "name" : "cluster_4_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_4_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_4_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m128_AT1G68840", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m128_AT1G68840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m128_AT1G68840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m128_AT1G68840_logo.png",
 "name" : "AT1G68840",
 "ic" : "8.64",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCAACATM"
 },
 {
  "label": "a.t_motifs_m53_AT1G25560", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m53_AT1G25560_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m53_AT1G25560_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m53_AT1G25560_logo.png",
 "name" : "AT1G25560",
 "ic" : "8.13",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCAACAKW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m332_AT3G25730", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m332_AT3G25730_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m332_AT3G25730_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m332_AT3G25730_logo.png",
 "name" : "AT3G25730",
 "ic" : "9.33",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "TMTGTTGY"
 } 
 ] 
 },
 {
  "consensus" : "gATGATGGA",
 "branch" : 5,
 "id" : "cluster_4_node_5",
 "ic" : "10.12",
 "size" : 11,
 "name" : "cluster_4_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_4_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_4_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m234_AT2G38880", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m234_AT2G38880_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m234_AT2G38880_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m234_AT2G38880_logo.png",
 "name" : "AT2G38880",
 "ic" : "9.88",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "GWTGATGGA"
 },
 {
  "label": "a.t_motifs_m596_AT5G62165", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m596_AT5G62165_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m596_AT5G62165_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m596_AT5G62165_logo.png",
 "name" : "AT5G62165",
 "ic" : "8.23",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "RATGATG"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m444_AT4G31610", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m444_AT4G31610_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m444_AT4G31610_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m444_AT4G31610_logo.png",
 "name" : "AT4G31610",
 "ic" : "8.85",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "DWGDTGTAGC"
 } 
 ] 
 },
 {
  "consensus" : "TGkTGA",
 "branch" : 4,
 "id" : "cluster_4_node_4",
 "ic" : "7.46",
 "size" : 11,
 "name" : "cluster_4_node_4_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_4_node_4_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_4_node_4_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m582_AT5G58620", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m582_AT5G58620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m582_AT5G58620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m582_AT5G58620_logo.png",
 "name" : "AT5G58620",
 "ic" : "8.32",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGTTGA"
 },
 {
  "consensus" : "TGGTGA",
 "branch" : 1,
 "id" : "cluster_4_node_1",
 "ic" : "8.04",
 "size" : 11,
 "name" : "cluster_4_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_4_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_4_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m565_AT5G48670", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m565_AT5G48670_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m565_AT5G48670_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m565_AT5G48670_logo.png",
 "name" : "AT5G48670",
 "ic" : "8.32",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "TCACCA"
 },
 {
  "label": "a.t_motifs_m112_AT1G60920", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m112_AT1G60920_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m112_AT1G60920_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m112_AT1G60920_logo.png",
 "name" : "AT1G60920",
 "ic" : "7.92",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGGTGA"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_4").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#8A8C51");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_4"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#8A8C51"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_4" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#8A8C51")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_4").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_4").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_4").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_4").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 84;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_5").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "ygrygryGkCGGyGghggcGghggwkrmrg",
 "branch" : 81,
 "id" : "cluster_5_node_81",
 "ic" : "8.31",
 "size" : 30,
 "name" : "cluster_5",
 "image" : "matrix-clustering_aligned_logos/cluster_5_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_logo_rc.png",

  "children": [
  {
  "consensus" : "cggygrcGGyGGcGgyGgcGGhggwkrmrg",
 "branch" : 80,
 "id" : "cluster_5_node_80",
 "ic" : "9.55",
 "size" : 30,
 "name" : "cluster_5_node_80_53motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_80_53motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_80_53motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "cggygrCGGyGGcGgcggcGghggw",
 "branch" : 77,
 "id" : "cluster_5_node_77",
 "ic" : "9.36",
 "size" : 30,
 "name" : "cluster_5_node_77_50motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_77_50motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_77_50motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "kyggcGGyGgyggcGGcGghggw",
 "branch" : 76,
 "id" : "cluster_5_node_76",
 "ic" : "7.56",
 "size" : 30,
 "name" : "cluster_5_node_76_21motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_76_21motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_76_21motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "kygrCGGyGGmGghggyggyggw",
 "branch" : 67,
 "id" : "cluster_5_node_67",
 "ic" : "8.63",
 "size" : 30,
 "name" : "cluster_5_node_67_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_67_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_67_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "kyGkCGGyGrmgryggyggygr",
 "branch" : 61,
 "id" : "cluster_5_node_61",
 "ic" : "8.71",
 "size" : 30,
 "name" : "cluster_5_node_61_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_61_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_61_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yGkCGGyGghgryggyggtgr",
 "branch" : 53,
 "id" : "cluster_5_node_53",
 "ic" : "9.00",
 "size" : 30,
 "name" : "cluster_5_node_53_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_53_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_53_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GkCGGTGghgrhggyggygr",
 "branch" : 14,
 "id" : "cluster_5_node_14",
 "ic" : "9.18",
 "size" : 30,
 "name" : "cluster_5_node_14_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_14_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_14_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m436_AT4G28140", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m436_AT4G28140_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m436_AT4G28140_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m436_AT4G28140_logo.png",
 "name" : "AT4G28140",
 "ic" : "8.75",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCRCCRCCDYCKCCRCCGHC"
 },
 {
  "label": "a.t_motifs_m46_AT1G21910", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m46_AT1G21910_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m46_AT1G21910_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m46_AT1G21910_logo.png",
 "name" : "AT1G21910",
 "ic" : "10.03",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GKCGGTGGHGGWGRWGGWGR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m140_AT1G71450", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m140_AT1G71450_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m140_AT1G71450_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m140_AT1G71450_logo.png",
 "name" : "AT1G71450",
 "ic" : "9.58",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YGRCGGYGRHGGYGGYGGWG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m26_AT1G12630", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m26_AT1G12630_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m26_AT1G12630_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m26_AT1G12630_logo.png",
 "name" : "AT1G12630",
 "ic" : "8.98",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KTGTCGGYRRMRRHRRYGRCR"
 } 
 ] 
 },
 {
  "consensus" : "ygrcGGCGGcGghggcGgyggw",
 "branch" : 59,
 "id" : "cluster_5_node_59",
 "ic" : "9.79",
 "size" : 30,
 "name" : "cluster_5_node_59_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_59_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_59_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ggcGGCGGmgghGGcGGyGGw",
 "branch" : 32,
 "id" : "cluster_5_node_32",
 "ic" : "11.30",
 "size" : 30,
 "name" : "cluster_5_node_32_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_32_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_32_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m601_AT5G63090", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m601_AT5G63090_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m601_AT5G63090_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m601_AT5G63090_logo.png",
 "name" : "AT5G63090",
 "ic" : "11.34",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KGCGGCGGMGRHGGCGGMGGA"
 },
 {
  "consensus" : "gGcGGyGGhGgyGGyGGyGGw",
 "branch" : 17,
 "id" : "cluster_5_node_17",
 "ic" : "12.57",
 "size" : 30,
 "name" : "cluster_5_node_17_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_17_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_17_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m237_AT2G40340", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m237_AT2G40340_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m237_AT2G40340_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m237_AT2G40340_logo.png",
 "name" : "AT2G40340",
 "ic" : "11.69",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WCCACCRCCRCCDCCRCCKCC"
 },
 {
  "label": "a.t_motifs_m531_AT5G25390", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m531_AT5G25390_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m531_AT5G25390_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m531_AT5G25390_logo.png",
 "name" : "AT5G25390",
 "ic" : "14.17",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GGCGGYGGHGGYGGCGGYGGW"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "ygryGGCGGCGghgryggygrw",
 "branch" : 43,
 "id" : "cluster_5_node_43",
 "ic" : "10.03",
 "size" : 30,
 "name" : "cluster_5_node_43_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_43_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_43_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rryGGCGGCGgmgrhggyggw",
 "branch" : 36,
 "id" : "cluster_5_node_36",
 "ic" : "10.50",
 "size" : 30,
 "name" : "cluster_5_node_36_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_36_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_36_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m8_AT1G03800", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m8_AT1G03800_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m8_AT1G03800_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m8_AT1G03800_logo.png",
 "name" : "AT1G03800",
 "ic" : "10.37",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "DRYGGCGGCGGHGRMGGYGGW"
 },
 {
  "label": "a.t_motifs_m591_AT5G61600", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m591_AT5G61600_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m591_AT5G61600_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m591_AT5G61600_logo.png",
 "name" : "AT5G61600",
 "ic" : "10.67",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RRYGGCGGCGGMGRYGGYG"
 } 
 ] 
 },
 {
  "consensus" : "ygrCGGCGGcGghggygghgr",
 "branch" : 26,
 "id" : "cluster_5_node_26",
 "ic" : "9.82",
 "size" : 30,
 "name" : "cluster_5_node_26_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_26_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_26_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m315_AT3G20310", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m315_AT3G20310_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m315_AT3G20310_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m315_AT3G20310_logo.png",
 "name" : "AT3G20310",
 "ic" : "9.91",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGRCGGCGGMGRHGGCGRHGR"
 },
 {
  "label": "a.t_motifs_m559_AT5G47220", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m559_AT5G47220_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m559_AT5G47220_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m559_AT5G47220_logo.png",
 "name" : "AT5G47220",
 "ic" : "10.61",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YGRYGGCGGCGGHGGYGGHGG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "cggcgrhrrygGCGGCGGmgrw",
 "branch" : 71,
 "id" : "cluster_5_node_71",
 "ic" : "9.04",
 "size" : 30,
 "name" : "cluster_5_node_71_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_71_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_71_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "cggmgrhggyGGCGGCGGmggw",
 "branch" : 57,
 "id" : "cluster_5_node_57",
 "ic" : "9.41",
 "size" : 30,
 "name" : "cluster_5_node_57_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_57_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_57_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ygrhdryGGCGGCGGmgrhgg",
 "branch" : 10,
 "id" : "cluster_5_node_10",
 "ic" : "11.38",
 "size" : 30,
 "name" : "cluster_5_node_10_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_10_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_10_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m409_AT4G17490", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m409_AT4G17490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m409_AT4G17490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m409_AT4G17490_logo.png",
 "name" : "AT4G17490",
 "ic" : "11.92",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKGYKRYGGCGGCGGMGRHGG"
 },
 {
  "label": "a.t_motifs_m144_AT1G72360", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m144_AT1G72360_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m144_AT1G72360_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m144_AT1G72360_logo.png",
 "name" : "AT1G72360",
 "ic" : "11.18",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YGRHDRYGGCGGCGGMGRHGR"
 } 
 ] 
 },
 {
  "consensus" : "cggcgghrrygGCGGCGGmGrw",
 "branch" : 49,
 "id" : "cluster_5_node_49",
 "ic" : "10.29",
 "size" : 30,
 "name" : "cluster_5_node_49_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_49_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_49_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "cggcgrhrryGGCGGCGGmGr",
 "branch" : 46,
 "id" : "cluster_5_node_46",
 "ic" : "10.28",
 "size" : 30,
 "name" : "cluster_5_node_46_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_46_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_46_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "cggcgghrryGGCGGCGGmgr",
 "branch" : 25,
 "id" : "cluster_5_node_25",
 "ic" : "10.51",
 "size" : 30,
 "name" : "cluster_5_node_25_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_25_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_25_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m107_AT1G53910", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m107_AT1G53910_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m107_AT1G53910_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m107_AT1G53910_logo.png",
 "name" : "AT1G53910",
 "ic" : "10.59",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCKCCGCCGCCRYYWYCDCCG"
 },
 {
  "consensus" : "cggcgghgryGRCGGCGGmGr",
 "branch" : 15,
 "id" : "cluster_5_node_15",
 "ic" : "11.10",
 "size" : 30,
 "name" : "cluster_5_node_15_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_15_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_15_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m552_AT5G44210", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m552_AT5G44210_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m552_AT5G44210_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m552_AT5G44210_logo.png",
 "name" : "AT5G44210",
 "ic" : "11.14",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCKCCGCCGYCRYMKCCGCCR"
 },
 {
  "label": "a.t_motifs_m434_AT4G27950", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m434_AT4G27950_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m434_AT4G27950_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m434_AT4G27950_logo.png",
 "name" : "AT4G27950",
 "ic" : "11.83",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGGMGGHGGYGGCGGCGGMGG"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m605_AT5G64750", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m605_AT5G64750_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m605_AT5G64750_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m605_AT5G64750_logo.png",
 "name" : "AT5G64750",
 "ic" : "10.03",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKCCGCCGYMAYHTYCGCC"
 } 
 ] 
 },
 {
  "consensus" : "ggcgghrghgrCGGCGGmGgw",
 "branch" : 38,
 "id" : "cluster_5_node_38",
 "ic" : "10.49",
 "size" : 30,
 "name" : "cluster_5_node_38_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_38_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_38_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m530_AT5G25190", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m530_AT5G25190_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m530_AT5G25190_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m530_AT5G25190_logo.png",
 "name" : "AT5G25190",
 "ic" : "10.36",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WCCKCCRCCGCCDCCDCCG"
 },
 {
  "label": "a.t_motifs_m507_AT5G13910", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m507_AT5G13910_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m507_AT5G13910_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m507_AT5G13910_logo.png",
 "name" : "AT5G13910",
 "ic" : "10.51",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GGCGGYDGYGRCGGCGGMGGH"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "CGsCGgarrwkrCGGcGgmgr",
 "branch" : 56,
 "id" : "cluster_5_node_56",
 "ic" : "10.27",
 "size" : 30,
 "name" : "cluster_5_node_56_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_56_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_56_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m215_AT2G30340", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m215_AT2G30340_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m215_AT2G30340_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m215_AT2G30340_logo.png",
 "name" : "AT2G30340",
 "ic" : "9.51",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGCCGYMWWYTCCGSCG"
 },
 {
  "label": "a.t_motifs_m117_AT1G65620", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m117_AT1G65620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m117_AT1G65620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m117_AT1G65620_logo.png",
 "name" : "AT1G65620",
 "ic" : "10.58",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGSCGGMRRWKRCGGCGGMGR"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "cggygrCGGCGGcGghggmggy",
 "branch" : 73,
 "id" : "cluster_5_node_73",
 "ic" : "9.52",
 "size" : 30,
 "name" : "cluster_5_node_73_29motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_73_29motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_73_29motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "cgghrryGGCGGYGGmgg",
 "branch" : 70,
 "id" : "cluster_5_node_70",
 "ic" : "9.33",
 "size" : 30,
 "name" : "cluster_5_node_70_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_70_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_70_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rwrryGGCGGCGgmgg",
 "branch" : 65,
 "id" : "cluster_5_node_65",
 "ic" : "9.15",
 "size" : 30,
 "name" : "cluster_5_node_65_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_65_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_65_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rwrryGGCGGCGgmg",
 "branch" : 45,
 "id" : "cluster_5_node_45",
 "ic" : "9.34",
 "size" : 30,
 "name" : "cluster_5_node_45_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_45_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_45_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m452_AT4G34410", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m452_AT4G34410_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m452_AT4G34410_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m452_AT4G34410_logo.png",
 "name" : "AT4G34410",
 "ic" : "9.71",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKSCGCCGYMATTTY"
 },
 {
  "consensus" : "rhrryGGCGGCKgmg",
 "branch" : 22,
 "id" : "cluster_5_node_22",
 "ic" : "10.12",
 "size" : 30,
 "name" : "cluster_5_node_22_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_22_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_22_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m249_AT2G44840", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m249_AT2G44840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m249_AT2G44840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m249_AT2G44840_logo.png",
 "name" : "AT2G44840",
 "ic" : "10.11",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWAAYGGCGGCKGAG"
 },
 {
  "label": "a.t_motifs_m569_AT5G51190", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m569_AT5G51190_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m569_AT5G51190_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m569_AT5G51190_logo.png",
 "name" : "AT5G51190",
 "ic" : "10.77",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKCCGCCGCCRYYDC"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m615_AT5G67000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m615_AT5G67000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m615_AT5G67000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m615_AT5G67000_logo.png",
 "name" : "AT5G67000",
 "ic" : "8.04",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CMDCMGCCGYRWHMR"
 } 
 ] 
 },
 {
  "consensus" : "cggyggyGGCGGyGGh",
 "branch" : 58,
 "id" : "cluster_5_node_58",
 "ic" : "9.32",
 "size" : 30,
 "name" : "cluster_5_node_58_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_58_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_58_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ggygghGGCGGTGGh",
 "branch" : 30,
 "id" : "cluster_5_node_30",
 "ic" : "9.38",
 "size" : 30,
 "name" : "cluster_5_node_30_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_30_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_30_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m519_AT5G18450", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m519_AT5G18450_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m519_AT5G18450_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m519_AT5G18450_logo.png",
 "name" : "AT5G18450",
 "ic" : "9.95",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KCCRCCGCYTCCRCC"
 },
 {
  "label": "a.t_motifs_m49_AT1G22810", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m49_AT1G22810_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m49_AT1G22810_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m49_AT1G22810_logo.png",
 "name" : "AT1G22810",
 "ic" : "9.70",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "DCCACCGCCRCCRCC"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m490_AT5G07310", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m490_AT5G07310_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m490_AT5G07310_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m490_AT5G07310_logo.png",
 "name" : "AT5G07310",
 "ic" : "9.79",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGGCGRYGRCGGCGG"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "kyGrCGGYGGmGghggmggy",
 "branch" : 72,
 "id" : "cluster_5_node_72",
 "ic" : "9.15",
 "size" : 30,
 "name" : "cluster_5_node_72_22motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_72_22motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_72_22motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "kyGrCGGYGGmGghggmggy",
 "branch" : 62,
 "id" : "cluster_5_node_62",
 "ic" : "9.12",
 "size" : 30,
 "name" : "cluster_5_node_62_21motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_62_21motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_62_21motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ygrCGGCGGcGghggmggy",
 "branch" : 55,
 "id" : "cluster_5_node_55",
 "ic" : "9.72",
 "size" : 30,
 "name" : "cluster_5_node_55_16motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_55_16motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_55_16motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ygrCGGCGGmGghggm",
 "branch" : 52,
 "id" : "cluster_5_node_52",
 "ic" : "9.21",
 "size" : 30,
 "name" : "cluster_5_node_52_14motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_52_14motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_52_14motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m522_AT5G19790", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m522_AT5G19790_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m522_AT5G19790_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m522_AT5G19790_logo.png",
 "name" : "AT5G19790",
 "ic" : "8.43",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "MGMCGGCGRHGRMRG"
 },
 {
  "consensus" : "ygrCGGCGGmGghggm",
 "branch" : 48,
 "id" : "cluster_5_node_48",
 "ic" : "9.58",
 "size" : 30,
 "name" : "cluster_5_node_48_13motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_48_13motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_48_13motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ygrCGGCGGmGghgg",
 "branch" : 41,
 "id" : "cluster_5_node_41",
 "ic" : "9.54",
 "size" : 30,
 "name" : "cluster_5_node_41_12motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_41_12motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_41_12motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ygrCGGCGGmGghgg",
 "branch" : 29,
 "id" : "cluster_5_node_29",
 "ic" : "9.79",
 "size" : 30,
 "name" : "cluster_5_node_29_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_29_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_29_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ygrCGGCGGmGghgg",
 "branch" : 11,
 "id" : "cluster_5_node_11",
 "ic" : "10.06",
 "size" : 30,
 "name" : "cluster_5_node_11_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_11_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_11_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ygrCGGCGGmGghgg",
 "branch" : 9,
 "id" : "cluster_5_node_9",
 "ic" : "10.07",
 "size" : 30,
 "name" : "cluster_5_node_9_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_9_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_9_7motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m126_AT1G68550", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m126_AT1G68550_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m126_AT1G68550_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m126_AT1G68550_logo.png",
 "name" : "AT1G68550",
 "ic" : "10.17",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YGRCGGCGGMGGHGG"
 },
 {
  "consensus" : "ygrCGGCGGmGrhgg",
 "branch" : 8,
 "id" : "cluster_5_node_8",
 "ic" : "10.09",
 "size" : 30,
 "name" : "cluster_5_node_8_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_8_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_8_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ygrCGGCGGmGrhgg",
 "branch" : 5,
 "id" : "cluster_5_node_5",
 "ic" : "10.12",
 "size" : 30,
 "name" : "cluster_5_node_5_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_5_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_5_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ygrCGGCGGmGrhgg",
 "branch" : 3,
 "id" : "cluster_5_node_3",
 "ic" : "10.12",
 "size" : 30,
 "name" : "cluster_5_node_3_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_3_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_3_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "tgrCGGCGGmGrhgg",
 "branch" : 1,
 "id" : "cluster_5_node_1",
 "ic" : "10.10",
 "size" : 30,
 "name" : "cluster_5_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m59_AT1G28370", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m59_AT1G28370_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m59_AT1G28370_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m59_AT1G28370_logo.png",
 "name" : "AT1G28370",
 "ic" : "10.13",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGRCGGCGGMGGWGG"
 },
 {
  "label": "a.t_motifs_m96_AT1G50640", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m96_AT1G50640_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m96_AT1G50640_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m96_AT1G50640_logo.png",
 "name" : "AT1G50640",
 "ic" : "10.13",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CCDYCKCCGCCGYCR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m56_AT1G28160", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m56_AT1G28160_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m56_AT1G28160_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m56_AT1G28160_logo.png",
 "name" : "AT1G28160",
 "ic" : "10.27",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CCDYCKCCGCCGYCR"
 } 
 ] 
 },
 {
  "consensus" : "ykrCGGCGGmGghgg",
 "branch" : 4,
 "id" : "cluster_5_node_4",
 "ic" : "10.23",
 "size" : 30,
 "name" : "cluster_5_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m221_AT2G33710", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m221_AT2G33710_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m221_AT2G33710_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m221_AT2G33710_logo.png",
 "name" : "AT2G33710",
 "ic" : "10.31",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YKRCGGCGGMGGHGG"
 },
 {
  "label": "a.t_motifs_m83_AT1G43160", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m83_AT1G43160_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m83_AT1G43160_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m83_AT1G43160_logo.png",
 "name" : "AT1G43160",
 "ic" : "10.21",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CCDCCKCCGCCGYMA"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m520_AT5G18560", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m520_AT5G18560_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m520_AT5G18560_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m520_AT5G18560_logo.png",
 "name" : "AT5G18560",
 "ic" : "10.09",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "HRRCGGCGGMGRHGG"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m560_AT5G47230", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m560_AT5G47230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m560_AT5G47230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m560_AT5G47230_logo.png",
 "name" : "AT5G47230",
 "ic" : "10.44",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YGGCGGCGGCGGYGG"
 } 
 ] 
 },
 {
  "consensus" : "wGgCGGyGGmGgygg",
 "branch" : 13,
 "id" : "cluster_5_node_13",
 "ic" : "9.82",
 "size" : 30,
 "name" : "cluster_5_node_13_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_13_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_13_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m606_AT5G65130", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m606_AT5G65130_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m606_AT5G65130_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m606_AT5G65130_logo.png",
 "name" : "AT5G65130",
 "ic" : "10.24",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGGCGGYGGHGGYGG"
 },
 {
  "label": "a.t_motifs_m155_AT1G75490", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m155_AT1G75490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m155_AT1G75490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m155_AT1G75490_logo.png",
 "name" : "AT1G75490",
 "ic" : "9.69",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WGGCGGYGGMGGYGG"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "hdryGGCGGCGGmGr",
 "branch" : 18,
 "id" : "cluster_5_node_18",
 "ic" : "10.37",
 "size" : 30,
 "name" : "cluster_5_node_18_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_18_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_18_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m324_AT3G23220", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m324_AT3G23220_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m324_AT3G23220_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m324_AT3G23220_logo.png",
 "name" : "AT3G23220",
 "ic" : "10.61",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CCKCCGCCGCCRYCR"
 },
 {
  "label": "a.t_motifs_m307_AT3G15210", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m307_AT3G15210_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m307_AT3G15210_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m307_AT3G15210_logo.png",
 "name" : "AT3G15210",
 "ic" : "10.76",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WDRYGGCGGCGGMGR"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m105_AT1G53170", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m105_AT1G53170_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m105_AT1G53170_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m105_AT1G53170_logo.png",
 "name" : "AT1G53170",
 "ic" : "9.85",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KRCGGCGGMGGHGRM"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "ryGGCGGCGghggyggy",
 "branch" : 40,
 "id" : "cluster_5_node_40",
 "ic" : "10.72",
 "size" : 30,
 "name" : "cluster_5_node_40_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_40_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_40_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m218_AT2G31230", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m218_AT2G31230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m218_AT2G31230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m218_AT2G31230_logo.png",
 "name" : "AT2G31230",
 "ic" : "10.29",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RYGGCGGCKGHGGHG"
 },
 {
  "label": "a.t_motifs_m415_AT4G18450", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m415_AT4G18450_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m415_AT4G18450_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m415_AT4G18450_logo.png",
 "name" : "AT4G18450",
 "ic" : "11.11",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RCCGCCKCCGCCGCCRY"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "ktGkCGGTGrhgrhgr",
 "branch" : 47,
 "id" : "cluster_5_node_47",
 "ic" : "9.20",
 "size" : 30,
 "name" : "cluster_5_node_47_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_47_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_47_5motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m407_AT4G16750", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m407_AT4G16750_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m407_AT4G16750_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m407_AT4G16750_logo.png",
 "name" : "AT4G16750",
 "ic" : "8.59",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KYGTCGGYGRHGRHG"
 },
 {
  "consensus" : "tGkCGGTGghgrwgr",
 "branch" : 20,
 "id" : "cluster_5_node_20",
 "ic" : "9.33",
 "size" : 30,
 "name" : "cluster_5_node_20_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_20_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_20_4motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m225_AT2G35700", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m225_AT2G35700_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m225_AT2G35700_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m225_AT2G35700_logo.png",
 "name" : "AT2G35700",
 "ic" : "9.29",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCDYCDYCRCCGACA"
 },
 {
  "consensus" : "tGkCGGTGghggwgg",
 "branch" : 12,
 "id" : "cluster_5_node_12",
 "ic" : "9.60",
 "size" : 30,
 "name" : "cluster_5_node_12_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_12_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_12_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "tGkCGGTGrhgrtgr",
 "branch" : 6,
 "id" : "cluster_5_node_6",
 "ic" : "9.32",
 "size" : 30,
 "name" : "cluster_5_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m357_AT3G50260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m357_AT3G50260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m357_AT3G50260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m357_AT3G50260_logo.png",
 "name" : "AT3G50260",
 "ic" : "9.34",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGKCGGTGGHGRTGG"
 },
 {
  "label": "a.t_motifs_m616_AT5G67190", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m616_AT5G67190_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m616_AT5G67190_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m616_AT5G67190_logo.png",
 "name" : "AT5G67190",
 "ic" : "9.40",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGKCGGTGRHGRYGR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m85_AT1G44830", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m85_AT1G44830_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m85_AT1G44830_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m85_AT1G44830_logo.png",
 "name" : "AT1G44830",
 "ic" : "10.58",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGKCGGTGGMGGWGG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m370_AT3G57600", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m370_AT3G57600_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m370_AT3G57600_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m370_AT3G57600_logo.png",
 "name" : "AT3G57600",
 "ic" : "10.13",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GGCGGYGGMGG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "rmgryggyrrhdryGkCGGyGrwkrmrg",
 "branch" : 79,
 "id" : "cluster_5_node_79",
 "ic" : "9.50",
 "size" : 30,
 "name" : "cluster_5_node_79_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_79_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_79_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ggyggygrhdkTGtCGGTGgw",
 "branch" : 21,
 "id" : "cluster_5_node_21",
 "ic" : "10.03",
 "size" : 30,
 "name" : "cluster_5_node_21_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_21_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_21_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m442_AT4G31060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m442_AT4G31060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m442_AT4G31060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m442_AT4G31060_logo.png",
 "name" : "AT4G31060",
 "ic" : "9.86",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KKYGGYRRWDKTGTCGGTGG"
 },
 {
  "label": "a.t_motifs_m162_AT1G77640", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m162_AT1G77640_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m162_AT1G77640_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m162_AT1G77640_logo.png",
 "name" : "AT1G77640",
 "ic" : "10.34",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WCCACCGACAMHDYCRCCWYC"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m325_AT3G23240", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m325_AT3G23240_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m325_AT3G23240_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m325_AT3G23240_logo.png",
 "name" : "AT3G23240",
 "ic" : "11.05",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RMGRCRGYDGYRRYGGCGGCKRWKRMRG"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "wrdwwwTGTCGGyGrhrrwrrwr",
 "branch" : 78,
 "id" : "cluster_5_node_78",
 "ic" : "8.44",
 "size" : 30,
 "name" : "cluster_5_node_78_29motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_78_29motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_78_29motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wrdwwwTGTCGGYGrhrrwrrwr",
 "branch" : 74,
 "id" : "cluster_5_node_74",
 "ic" : "8.82",
 "size" : 30,
 "name" : "cluster_5_node_74_21motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_74_21motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_74_21motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rdwwwTGTCGGyGrhrr",
 "branch" : 69,
 "id" : "cluster_5_node_69",
 "ic" : "8.64",
 "size" : 30,
 "name" : "cluster_5_node_69_17motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_69_17motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_69_17motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dhdwtGTCGGygrhrr",
 "branch" : 66,
 "id" : "cluster_5_node_66",
 "ic" : "8.14",
 "size" : 30,
 "name" : "cluster_5_node_66_12motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_66_12motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_66_12motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dtkGwCGGYGghgr",
 "branch" : 44,
 "id" : "cluster_5_node_44",
 "ic" : "8.63",
 "size" : 30,
 "name" : "cluster_5_node_44_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_44_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_44_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dtkGwCGGYGghgr",
 "branch" : 16,
 "id" : "cluster_5_node_16",
 "ic" : "8.62",
 "size" : 30,
 "name" : "cluster_5_node_16_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_16_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_16_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m81_AT1G36060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m81_AT1G36060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m81_AT1G36060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m81_AT1G36060_logo.png",
 "name" : "AT1G36060",
 "ic" : "8.96",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCDCCACCGMCMAW"
 },
 {
  "label": "a.t_motifs_m40_AT1G19210", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m40_AT1G19210_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m40_AT1G19210_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m40_AT1G19210_logo.png",
 "name" : "AT1G19210",
 "ic" : "8.68",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCDYCRCCGWCCAH"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m88_AT1G46768", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m88_AT1G46768_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m88_AT1G46768_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m88_AT1G46768_logo.png",
 "name" : "AT1G46768",
 "ic" : "9.29",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCDCCRCCGMCAH"
 } 
 ] 
 },
 {
  "consensus" : "dhkwTGTCGGyrrmrd",
 "branch" : 54,
 "id" : "cluster_5_node_54",
 "ic" : "8.54",
 "size" : 30,
 "name" : "cluster_5_node_54_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_54_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_54_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ykaTGTCGGyrrmrd",
 "branch" : 51,
 "id" : "cluster_5_node_51",
 "ic" : "8.73",
 "size" : 30,
 "name" : "cluster_5_node_51_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_51_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_51_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ykaTGTCGGyrrard",
 "branch" : 31,
 "id" : "cluster_5_node_31",
 "ic" : "8.93",
 "size" : 30,
 "name" : "cluster_5_node_31_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_31_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_31_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ykATGTCGGyrrard",
 "branch" : 19,
 "id" : "cluster_5_node_19",
 "ic" : "9.59",
 "size" : 30,
 "name" : "cluster_5_node_19_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_19_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_19_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m25_AT1G12610", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m25_AT1G12610_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m25_AT1G12610_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m25_AT1G12610_logo.png",
 "name" : "AT1G12610",
 "ic" : "10.52",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYKYYGYCGACATCR"
 },
 {
  "label": "a.t_motifs_m430_AT4G25470", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m430_AT4G25470_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m430_AT4G25470_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m430_AT4G25470_logo.png",
 "name" : "AT4G25470",
 "ic" : "9.52",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YKATGTCGGYRRARD"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m572_AT5G52020", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m572_AT5G52020_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m572_AT5G52020_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m572_AT5G52020_logo.png",
 "name" : "AT5G52020",
 "ic" : "8.89",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYKYYGCCGACAMWW"
 } 
 ] 
 },
 {
  "consensus" : "ykatGTCGGyrrmr",
 "branch" : 37,
 "id" : "cluster_5_node_37",
 "ic" : "8.69",
 "size" : 30,
 "name" : "cluster_5_node_37_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_37_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_37_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ykatGTCGGyrrar",
 "branch" : 28,
 "id" : "cluster_5_node_28",
 "ic" : "8.68",
 "size" : 30,
 "name" : "cluster_5_node_28_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_28_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_28_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m571_AT5G51990", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m571_AT5G51990_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m571_AT5G51990_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m571_AT5G51990_logo.png",
 "name" : "AT5G51990",
 "ic" : "8.82",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KYYRCCGACATMR"
 },
 {
  "label": "a.t_motifs_m431_AT4G25480", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m431_AT4G25480_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m431_AT4G25480_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m431_AT4G25480_logo.png",
 "name" : "AT4G25480",
 "ic" : "8.53",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YKWTGTCGGYRRWR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m432_AT4G25490", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m432_AT4G25490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m432_AT4G25490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m432_AT4G25490_logo.png",
 "name" : "AT4G25490",
 "ic" : "8.62",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KATGTCGGYRRM"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "dwwkTGTCGGTGrhrd",
 "branch" : 35,
 "id" : "cluster_5_node_35",
 "ic" : "9.03",
 "size" : 30,
 "name" : "cluster_5_node_35_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_35_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_35_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwkTGTCGGTGrhrd",
 "branch" : 27,
 "id" : "cluster_5_node_27",
 "ic" : "8.99",
 "size" : 30,
 "name" : "cluster_5_node_27_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_27_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_27_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m250_AT2G44940", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m250_AT2G44940_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m250_AT2G44940_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m250_AT2G44940_logo.png",
 "name" : "AT2G44940",
 "ic" : "9.55",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "HYDYCACCGACAMWD"
 },
 {
  "label": "a.t_motifs_m311_AT3G16280", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m311_AT3G16280_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m311_AT3G16280_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m311_AT3G16280_logo.png",
 "name" : "AT3G16280",
 "ic" : "8.68",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YDYCACCGACAMWW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m533_AT5G25810", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m533_AT5G25810_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m533_AT5G25810_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m533_AT5G25810_logo.png",
 "name" : "AT5G25810",
 "ic" : "9.25",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "DHWKTGTCGGYGRAR"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "rwwwkTGTCGGTGrhd",
 "branch" : 34,
 "id" : "cluster_5_node_34",
 "ic" : "10.19",
 "size" : 30,
 "name" : "cluster_5_node_34_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_34_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_34_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rwwwkTGTCGGTGr",
 "branch" : 7,
 "id" : "cluster_5_node_7",
 "ic" : "9.92",
 "size" : 30,
 "name" : "cluster_5_node_7_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_7_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_7_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rwwwkTGTCGGTGr",
 "branch" : 2,
 "id" : "cluster_5_node_2",
 "ic" : "9.63",
 "size" : 30,
 "name" : "cluster_5_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m161_AT1G77200", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m161_AT1G77200_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m161_AT1G77200_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m161_AT1G77200_logo.png",
 "name" : "AT1G77200",
 "ic" : "9.91",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWWWKTGTCGGYGR"
 },
 {
  "label": "a.t_motifs_m217_AT2G31220", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m217_AT2G31220_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m217_AT2G31220_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m217_AT2G31220_logo.png",
 "name" : "AT2G31220",
 "ic" : "9.41",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCACCGACAMWWYY"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m376_AT3G60490", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m376_AT3G60490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m376_AT3G60490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m376_AT3G60490_logo.png",
 "name" : "AT3G60490",
 "ic" : "10.68",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCACCGACAMWWWY"
 } 
 ] 
 },
 {
  "consensus" : "rdwwkTGTCGGTGghd",
 "branch" : 24,
 "id" : "cluster_5_node_24",
 "ic" : "10.60",
 "size" : 30,
 "name" : "cluster_5_node_24_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_24_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_24_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m2_AT1G01250", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m2_AT1G01250_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m2_AT1G01250_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m2_AT1G01250_logo.png",
 "name" : "AT1G01250",
 "ic" : "10.28",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "DYCACCGACAMWWHY"
 },
 {
  "label": "a.t_motifs_m448_AT4G32800", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m448_AT4G32800_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m448_AT4G32800_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m448_AT4G32800_logo.png",
 "name" : "AT4G32800",
 "ic" : "11.02",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWWWKTGTCGGTGGHD"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "wgrywwtGTCGGTGrwkrwrrwr",
 "branch" : 63,
 "id" : "cluster_5_node_63",
 "ic" : "9.67",
 "size" : 30,
 "name" : "cluster_5_node_63_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_63_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_63_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wgrywatGTCGGTGrwkrwrr",
 "branch" : 60,
 "id" : "cluster_5_node_60",
 "ic" : "9.55",
 "size" : 30,
 "name" : "cluster_5_node_60_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_60_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_60_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwatGTCGGTGrwkrwr",
 "branch" : 33,
 "id" : "cluster_5_node_33",
 "ic" : "9.57",
 "size" : 30,
 "name" : "cluster_5_node_33_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_33_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_33_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m205_AT2G23340", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m205_AT2G23340_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m205_AT2G23340_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m205_AT2G23340_logo.png",
 "name" : "AT2G23340",
 "ic" : "10.47",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YDYMDYCACCGACAWWW"
 },
 {
  "label": "a.t_motifs_m232_AT2G38340", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m232_AT2G38340_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m232_AT2G38340_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m232_AT2G38340_logo.png",
 "name" : "AT2G38340",
 "ic" : "9.82",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YWAWGKCGGTKDADRWR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m293_AT3G11020", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m293_AT3G11020_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m293_AT3G11020_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m293_AT3G11020_logo.png",
 "name" : "AT3G11020",
 "ic" : "9.49",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYWYCWCCACCGMCWYHRYCW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m398_AT4G06746", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m398_AT4G06746_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m398_AT4G06746_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m398_AT4G06746_logo.png",
 "name" : "AT4G06746",
 "ic" : "10.48",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWKGTCGGTGRWDRTRRWR"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "wywTGTCGGywh",
 "branch" : 75,
 "id" : "cluster_5_node_75",
 "ic" : "7.60",
 "size" : 30,
 "name" : "cluster_5_node_75_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_75_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_75_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wywTGTCGGywh",
 "branch" : 68,
 "id" : "cluster_5_node_68",
 "ic" : "7.68",
 "size" : 30,
 "name" : "cluster_5_node_68_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_68_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_68_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wywTGTCGGyw",
 "branch" : 64,
 "id" : "cluster_5_node_64",
 "ic" : "7.60",
 "size" : 30,
 "name" : "cluster_5_node_64_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_64_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_64_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wytTGTCKGhw",
 "branch" : 50,
 "id" : "cluster_5_node_50",
 "ic" : "6.88",
 "size" : 30,
 "name" : "cluster_5_node_50_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_50_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_50_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m594_AT5G62000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m594_AT5G62000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m594_AT5G62000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m594_AT5G62000_logo.png",
 "name" : "AT5G62000",
 "ic" : "6.41",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "YTTGTCKSHW"
 },
 {
  "consensus" : "wyTTGTCGGy",
 "branch" : 42,
 "id" : "cluster_5_node_42",
 "ic" : "7.55",
 "size" : 30,
 "name" : "cluster_5_node_42_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_42_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_42_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m43_AT1G19850", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m43_AT1G19850_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m43_AT1G19850_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m43_AT1G19850_logo.png",
 "name" : "AT1G19850",
 "ic" : "7.66",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WYTTGTCGGY"
 },
 {
  "label": "a.t_motifs_m539_AT5G37020", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m539_AT5G37020_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m539_AT5G37020_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m539_AT5G37020_logo.png",
 "name" : "AT5G37020",
 "ic" : "5.49",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KCCGACARD"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "aTGTCGGy",
 "branch" : 39,
 "id" : "cluster_5_node_39",
 "ic" : "8.53",
 "size" : 30,
 "name" : "cluster_5_node_39_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_39_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_39_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m111_AT1G59750", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m111_AT1G59750_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m111_AT1G59750_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m111_AT1G59750_logo.png",
 "name" : "AT1G59750",
 "ic" : "8.47",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTGTCGGY"
 },
 {
  "label": "a.t_motifs_m115_AT1G63030", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m115_AT1G63030_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m115_AT1G63030_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m115_AT1G63030_logo.png",
 "name" : "AT1G63030",
 "ic" : "9.60",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCCGACAT"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m223_AT2G33860", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m223_AT2G33860_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m223_AT2G33860_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m223_AT2G33860_logo.png",
 "name" : "AT2G33860",
 "ic" : "8.98",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "DTTCCGACAA"
 } 
 ] 
 },
 {
  "consensus" : "ttGGtCGGyg",
 "branch" : 23,
 "id" : "cluster_5_node_23",
 "ic" : "6.81",
 "size" : 30,
 "name" : "cluster_5_node_23_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_5_node_23_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_5_node_23_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m151_AT1G74930", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m151_AT1G74930_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m151_AT1G74930_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m151_AT1G74930_logo.png",
 "name" : "AT1G74930",
 "ic" : "9.52",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTGGTCGGYG"
 },
 {
  "label": "a.t_motifs_m164_AT1G78080", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m164_AT1G78080_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m164_AT1G78080_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m164_AT1G78080_logo.png",
 "name" : "AT1G78080",
 "ic" : "5.31",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "DWKGTCGGYG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 420; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_5").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9D8444");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_5"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9D8444"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_5" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9D8444")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_5").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_5").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_5").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_5").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 34;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_6").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wwwtwawwmayyAAThATTrwwwtwwww",
 "branch" : 31,
 "id" : "cluster_6_node_31",
 "ic" : "10.20",
 "size" : 28,
 "name" : "cluster_6",
 "image" : "matrix-clustering_aligned_logos/cluster_6_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_logo_rc.png",

  "children": [
  {
  "consensus" : "wwwtwawwmayyAAThATTrwwwty",
 "branch" : 30,
 "id" : "cluster_6_node_30",
 "ic" : "9.95",
 "size" : 28,
 "name" : "cluster_6_node_30_31motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_30_31motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_30_31motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwwtwawthayTAATYAhrwww",
 "branch" : 26,
 "id" : "cluster_6_node_26",
 "ic" : "10.80",
 "size" : 28,
 "name" : "cluster_6_node_26_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_26_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_26_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wmayTAATyAhrwtw",
 "branch" : 21,
 "id" : "cluster_6_node_21",
 "ic" : "8.65",
 "size" : 28,
 "name" : "cluster_6_node_21_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_21_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_21_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wmayTAATYAhdwtw",
 "branch" : 6,
 "id" : "cluster_6_node_6",
 "ic" : "9.05",
 "size" : 28,
 "name" : "cluster_6_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m191_AT2G18350", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m191_AT2G18350_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m191_AT2G18350_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m191_AT2G18350_logo.png",
 "name" : "AT2G18350",
 "ic" : "9.27",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "WHAYTAATYAYDWTW"
 },
 {
  "label": "a.t_motifs_m609_AT5G65410", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m609_AT5G65410_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m609_AT5G65410_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m609_AT5G65410_logo.png",
 "name" : "AT5G65410",
 "ic" : "9.04",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWWCDTRATTARTKA"
 } 
 ] 
 },
 {
  "consensus" : "ayTAATtAmgt",
 "branch" : 17,
 "id" : "cluster_6_node_17",
 "ic" : "7.55",
 "size" : 28,
 "name" : "cluster_6_node_17_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_17_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_17_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m276_AT3G03660", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m276_AT3G03660_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m276_AT3G03660_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m276_AT3G03660_logo.png",
 "name" : "AT3G03660",
 "ic" : "9.35",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "AYTAATTAAYT"
 },
 {
  "label": "a.t_motifs_m153_AT1G75240", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m153_AT1G75240_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m153_AT1G75240_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m153_AT1G75240_logo.png",
 "name" : "AT1G75240",
 "ic" : "8.18",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "RYTAATYAYRT"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "wwwtwawthayTAATYAwdwww",
 "branch" : 23,
 "id" : "cluster_6_node_23",
 "ic" : "11.07",
 "size" : 28,
 "name" : "cluster_6_node_23_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_23_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_23_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m339_AT3G28920", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m339_AT3G28920_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m339_AT3G28920_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m339_AT3G28920_logo.png",
 "name" : "AT3G28920",
 "ic" : "9.51",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "TRATTARKDAWTWWW"
 },
 {
  "label": "a.t_motifs_m544_AT5G39760", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m544_AT5G39760_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m544_AT5G39760_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m544_AT5G39760_logo.png",
 "name" : "AT5G39760",
 "ic" : "11.19",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWWTWWWTWAYTAATTAWDWWW"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "rmwkyAATmATTrwwwty",
 "branch" : 29,
 "id" : "cluster_6_node_29",
 "ic" : "8.51",
 "size" : 28,
 "name" : "cluster_6_node_29_25motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_29_25motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_29_25motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rmwkyAATmATTrwwwty",
 "branch" : 28,
 "id" : "cluster_6_node_28",
 "ic" : "8.52",
 "size" : 28,
 "name" : "cluster_6_node_28_24motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_28_24motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_28_24motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rmwtyAATmATTrwd",
 "branch" : 27,
 "id" : "cluster_6_node_27",
 "ic" : "7.89",
 "size" : 28,
 "name" : "cluster_6_node_27_22motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_27_22motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_27_22motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "kCATTAAwTry",
 "branch" : 8,
 "id" : "cluster_6_node_8",
 "ic" : "9.81",
 "size" : 28,
 "name" : "cluster_6_node_8_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_8_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_8_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "kCATTAAwTry",
 "branch" : 4,
 "id" : "cluster_6_node_4",
 "ic" : "9.89",
 "size" : 28,
 "name" : "cluster_6_node_4_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_4_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_4_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m573_AT5G52170", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m573_AT5G52170_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m573_AT5G52170_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m573_AT5G52170_logo.png",
 "name" : "AT5G52170",
 "ic" : "9.85",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "DCATTAAWTRY"
 },
 {
  "consensus" : "kCATTAAwTry",
 "branch" : 1,
 "id" : "cluster_6_node_1",
 "ic" : "9.96",
 "size" : 28,
 "name" : "cluster_6_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m388_AT4G00730", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m388_AT4G00730_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m388_AT4G00730_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m388_AT4G00730_logo.png",
 "name" : "AT4G00730",
 "ic" : "10.14",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "RYAWTTAATGC"
 },
 {
  "label": "a.t_motifs_m380_AT3G61150", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m380_AT3G61150_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m380_AT3G61150_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m380_AT3G61150_logo.png",
 "name" : "AT3G61150",
 "ic" : "9.82",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "KCATTAAWTRY"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m146_AT1G73360", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m146_AT1G73360_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m146_AT1G73360_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m146_AT1G73360_logo.png",
 "name" : "AT1G73360",
 "ic" : "9.93",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "RYAWTWAATGM"
 } 
 ] 
 },
 {
  "consensus" : "rmwyyAATmATTrad",
 "branch" : 25,
 "id" : "cluster_6_node_25",
 "ic" : "8.54",
 "size" : 28,
 "name" : "cluster_6_node_25_18motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_25_18motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_25_18motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rmwyyAATmATTrad",
 "branch" : 24,
 "id" : "cluster_6_node_24",
 "ic" : "8.87",
 "size" : 28,
 "name" : "cluster_6_node_24_15motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_24_15motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_24_15motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rmwyyAATmATTrad",
 "branch" : 20,
 "id" : "cluster_6_node_20",
 "ic" : "8.94",
 "size" : 28,
 "name" : "cluster_6_node_20_14motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_20_14motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_20_14motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wyyAATCATtw",
 "branch" : 13,
 "id" : "cluster_6_node_13",
 "ic" : "8.83",
 "size" : 28,
 "name" : "cluster_6_node_13_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_13_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_13_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wyyAATCATTw",
 "branch" : 12,
 "id" : "cluster_6_node_12",
 "ic" : "8.95",
 "size" : 28,
 "name" : "cluster_6_node_12_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_12_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_12_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m561_AT5G47370", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m561_AT5G47370_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m561_AT5G47370_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m561_AT5G47370_logo.png",
 "name" : "AT5G47370",
 "ic" : "9.09",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "WAATGATTRRW"
 },
 {
  "label": "a.t_motifs_m466_AT4G37790", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m466_AT4G37790_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m466_AT4G37790_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m466_AT4G37790_logo.png",
 "name" : "AT4G37790",
 "ic" : "8.98",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "AATGATTRRK"
 } 
 ] 
 },
 {
  "consensus" : "syAATCATka",
 "branch" : 10,
 "id" : "cluster_6_node_10",
 "ic" : "7.63",
 "size" : 28,
 "name" : "cluster_6_node_10_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_10_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_10_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m382_AT3G61890", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m382_AT3G61890_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m382_AT3G61890_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m382_AT3G61890_logo.png",
 "name" : "AT3G61890",
 "ic" : "7.27",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCAATCAWTM"
 },
 {
  "label": "a.t_motifs_m408_AT4G17460", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m408_AT4G17460_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m408_AT4G17460_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m408_AT4G17460_logo.png",
 "name" : "AT4G17460",
 "ic" : "8.69",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "YMATGATTRS"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "rmaycAATmATTgad",
 "branch" : 19,
 "id" : "cluster_6_node_19",
 "ic" : "9.17",
 "size" : 28,
 "name" : "cluster_6_node_19_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_19_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_19_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ahyAATAATTrwd",
 "branch" : 18,
 "id" : "cluster_6_node_18",
 "ic" : "9.14",
 "size" : 28,
 "name" : "cluster_6_node_18_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_18_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_18_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ahyAATAATTrar",
 "branch" : 15,
 "id" : "cluster_6_node_15",
 "ic" : "9.56",
 "size" : 28,
 "name" : "cluster_6_node_15_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_15_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_15_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yyAATAATTrw",
 "branch" : 11,
 "id" : "cluster_6_node_11",
 "ic" : "9.10",
 "size" : 28,
 "name" : "cluster_6_node_11_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_11_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_11_6motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m139_AT1G70920", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m139_AT1G70920_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m139_AT1G70920_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m139_AT1G70920_logo.png",
 "name" : "AT1G70920",
 "ic" : "9.39",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "MYAATRATTRR"
 },
 {
  "consensus" : "hyAATAATTrw",
 "branch" : 9,
 "id" : "cluster_6_node_9",
 "ic" : "9.41",
 "size" : 28,
 "name" : "cluster_6_node_9_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_9_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_9_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "hcAATAATTgw",
 "branch" : 7,
 "id" : "cluster_6_node_7",
 "ic" : "9.96",
 "size" : 28,
 "name" : "cluster_6_node_7_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_7_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_7_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m612_AT5G66700", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m612_AT5G66700_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m612_AT5G66700_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m612_AT5G66700_logo.png",
 "name" : "AT5G66700",
 "ic" : "10.13",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "WCAATTATTGK"
 },
 {
  "consensus" : "wyAATAATTra",
 "branch" : 3,
 "id" : "cluster_6_node_3",
 "ic" : "9.97",
 "size" : 28,
 "name" : "cluster_6_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m268_AT3G01220", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m268_AT3G01220_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m268_AT3G01220_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m268_AT3G01220_logo.png",
 "name" : "AT3G01220",
 "ic" : "10.34",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYAATTATTRD"
 },
 {
  "label": "a.t_motifs_m269_AT3G01470", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m269_AT3G01470_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m269_AT3G01470_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m269_AT3G01470_logo.png",
 "name" : "AT3G01470",
 "ic" : "9.92",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "WYAATTATTRW"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "yyAATMATTrw",
 "branch" : 5,
 "id" : "cluster_6_node_5",
 "ic" : "9.11",
 "size" : 28,
 "name" : "cluster_6_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m608_AT5G65310", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m608_AT5G65310_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m608_AT5G65310_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m608_AT5G65310_logo.png",
 "name" : "AT5G65310",
 "ic" : "9.15",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYAATKATTRR"
 },
 {
  "label": "a.t_motifs_m137_AT1G69780", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m137_AT1G69780_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m137_AT1G69780_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m137_AT1G69780_logo.png",
 "name" : "AT1G69780",
 "ic" : "9.17",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "WYAATTATTRA"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m477_AT5G03790", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m477_AT5G03790_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m477_AT5G03790_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m477_AT5G03790_logo.png",
 "name" : "AT5G03790",
 "ic" : "10.82",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "AHCAATAATTGAR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m200_AT2G22430", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m200_AT2G22430_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m200_AT2G22430_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m200_AT2G22430_logo.png",
 "name" : "AT2G22430",
 "ic" : "7.89",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWDAATKATTR"
 } 
 ] 
 },
 {
  "consensus" : "rmayCAATmATTga",
 "branch" : 14,
 "id" : "cluster_6_node_14",
 "ic" : "9.61",
 "size" : 28,
 "name" : "cluster_6_node_14_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_14_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_14_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m177_AT2G02540", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m177_AT2G02540_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m177_AT2G02540_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m177_AT2G02540_logo.png",
 "name" : "AT2G02540",
 "ic" : "10.14",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCAATWATTGKTGY"
 },
 {
  "label": "a.t_motifs_m262_AT2G46680", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m262_AT2G46680_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m262_AT2G46680_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m262_AT2G46680_logo.png",
 "name" : "AT2G46680",
 "ic" : "10.43",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "AWYCAATCATTGA"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m187_AT2G17950", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m187_AT2G17950_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m187_AT2G17950_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m187_AT2G17950_logo.png",
 "name" : "AT2G17950",
 "ic" : "10.02",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "TRAWTGAWTGA"
 } 
 ] 
 },
 {
  "consensus" : "TwATCATwAt",
 "branch" : 22,
 "id" : "cluster_6_node_22",
 "ic" : "8.63",
 "size" : 28,
 "name" : "cluster_6_node_22_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_22_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_22_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m251_AT2G45190", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m251_AT2G45190_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m251_AT2G45190_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m251_AT2G45190_logo.png",
 "name" : "AT2G45190",
 "ic" : "5.74",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "ATTATKATWR"
 },
 {
  "consensus" : "TwATCATw",
 "branch" : 16,
 "id" : "cluster_6_node_16",
 "ic" : "8.06",
 "size" : 28,
 "name" : "cluster_6_node_16_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_16_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_16_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m131_AT1G69180", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m131_AT1G69180_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m131_AT1G69180_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m131_AT1G69180_logo.png",
 "name" : "AT1G69180",
 "ic" : "8.16",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWATCATW"
 },
 {
  "label": "a.t_motifs_m470_AT4G40060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m470_AT4G40060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m470_AT4G40060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m470_AT4G40060_logo.png",
 "name" : "AT4G40060",
 "ic" : "9.00",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "AATKATTA"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "rTmATCATTAywwty",
 "branch" : 2,
 "id" : "cluster_6_node_2",
 "ic" : "10.88",
 "size" : 28,
 "name" : "cluster_6_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_6_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_6_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m65_AT1G30490", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m65_AT1G30490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m65_AT1G30490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m65_AT1G30490_logo.png",
 "name" : "AT1G30490",
 "ic" : "10.90",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "RAWWRTAATGATKAY"
 },
 {
  "label": "a.t_motifs_m101_AT1G52150", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m101_AT1G52150_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m101_AT1G52150_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m101_AT1G52150_logo.png",
 "name" : "AT1G52150",
 "ic" : "10.93",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "RTMATCATTAYWWTY"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m454_AT4G35550", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m454_AT4G35550_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m454_AT4G35550_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m454_AT4G35550_logo.png",
 "name" : "AT4G35550",
 "ic" : "8.18",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTGATTGAYW"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m459_AT4G36740", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m459_AT4G36740_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m459_AT4G36740_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m459_AT4G36740_logo.png",
 "name" : "AT4G36740",
 "ic" : "11.22",
 "size" : 28,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWWWDWTTCAATWATTGGTKW"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 300; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_6").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AE7C37");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_6"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AE7C37"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_6" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AE7C37")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_6").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_6").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_6").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_6").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 23;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_7").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "ctsrCACGTGcv",
 "branch" : 20,
 "id" : "cluster_7_node_20",
 "ic" : "8.11",
 "size" : 12,
 "name" : "cluster_7",
 "image" : "matrix-clustering_aligned_logos/cluster_7_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_logo_rc.png",

  "children": [
  {
  "consensus" : "cysrCACGTGcv",
 "branch" : 19,
 "id" : "cluster_7_node_19",
 "ic" : "8.24",
 "size" : 12,
 "name" : "cluster_7_node_19_19motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_19_19motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_19_19motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ggCACGTGc",
 "branch" : 18,
 "id" : "cluster_7_node_18",
 "ic" : "7.69",
 "size" : 12,
 "name" : "cluster_7_node_18_12motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_18_12motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_18_12motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ggCACGTGc",
 "branch" : 15,
 "id" : "cluster_7_node_15",
 "ic" : "7.69",
 "size" : 12,
 "name" : "cluster_7_node_15_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_15_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_15_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "gCACGTGC",
 "branch" : 11,
 "id" : "cluster_7_node_11",
 "ic" : "7.97",
 "size" : 12,
 "name" : "cluster_7_node_11_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_11_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_11_8motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m385_AT4G00050", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m385_AT4G00050_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m385_AT4G00050_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m385_AT4G00050_logo.png",
 "name" : "AT4G00050",
 "ic" : "8.83",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "KCACGTGG"
 },
 {
  "consensus" : "gCACGTGC",
 "branch" : 9,
 "id" : "cluster_7_node_9",
 "ic" : "7.97",
 "size" : 12,
 "name" : "cluster_7_node_9_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_9_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_9_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GCACGTGC",
 "branch" : 3,
 "id" : "cluster_7_node_3",
 "ic" : "8.87",
 "size" : 12,
 "name" : "cluster_7_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m564_AT5G48560", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m564_AT5G48560_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m564_AT5G48560_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m564_AT5G48560_logo.png",
 "name" : "AT5G48560",
 "ic" : "11.09",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCACGTGC"
 },
 {
  "label": "a.t_motifs_m260_AT2G46510", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m260_AT2G46510_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m260_AT2G46510_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m260_AT2G46510_logo.png",
 "name" : "AT2G46510",
 "ic" : "8.84",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCACGTGC"
 } 
 ] 
 },
 {
  "consensus" : "rCACGTGc",
 "branch" : 7,
 "id" : "cluster_7_node_7",
 "ic" : "7.76",
 "size" : 12,
 "name" : "cluster_7_node_7_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_7_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_7_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rCACGTGc",
 "branch" : 6,
 "id" : "cluster_7_node_6",
 "ic" : "7.83",
 "size" : 12,
 "name" : "cluster_7_node_6_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_6_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_6_4motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m411_AT4G17880", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m411_AT4G17880_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m411_AT4G17880_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m411_AT4G17880_logo.png",
 "name" : "AT4G17880",
 "ic" : "8.30",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCACGTGY"
 },
 {
  "consensus" : "rCACGTGc",
 "branch" : 5,
 "id" : "cluster_7_node_5",
 "ic" : "7.82",
 "size" : 12,
 "name" : "cluster_7_node_5_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_5_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_5_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rCACGTGc",
 "branch" : 1,
 "id" : "cluster_7_node_1",
 "ic" : "7.86",
 "size" : 12,
 "name" : "cluster_7_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m406_AT4G16430", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m406_AT4G16430_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m406_AT4G16430_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m406_AT4G16430_logo.png",
 "name" : "AT4G16430",
 "ic" : "7.35",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "RCACGTGY"
 },
 {
  "label": "a.t_motifs_m3_AT1G01260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m3_AT1G01260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m3_AT1G01260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m3_AT1G01260_logo.png",
 "name" : "AT1G01260",
 "ic" : "8.49",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCACGTGY"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m71_AT1G32640", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m71_AT1G32640_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m71_AT1G32640_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m71_AT1G32640_logo.png",
 "name" : "AT1G32640",
 "ic" : "7.27",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "RCACGTGY"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m557_AT5G46760", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m557_AT5G46760_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m557_AT5G46760_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m557_AT5G46760_logo.png",
 "name" : "AT5G46760",
 "ic" : "6.74",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "VCACGTGB"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "gcCAYGTGa",
 "branch" : 14,
 "id" : "cluster_7_node_14",
 "ic" : "8.19",
 "size" : 12,
 "name" : "cluster_7_node_14_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_14_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_14_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "gcCAYGTGa",
 "branch" : 10,
 "id" : "cluster_7_node_10",
 "ic" : "7.88",
 "size" : 12,
 "name" : "cluster_7_node_10_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_10_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_10_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m247_AT2G43010", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m247_AT2G43010_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m247_AT2G43010_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m247_AT2G43010_logo.png",
 "name" : "AT2G43010",
 "ic" : "8.07",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCCAYGTGA"
 },
 {
  "label": "a.t_motifs_m462_AT4G36930", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m462_AT4G36930_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m462_AT4G36930_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m462_AT4G36930_logo.png",
 "name" : "AT4G36930",
 "ic" : "6.59",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "VCACGTGSG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m374_AT3G59060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m374_AT3G59060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m374_AT3G59060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m374_AT3G59060_logo.png",
 "name" : "AT3G59060",
 "ic" : "8.95",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "SCAYGTGR"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m451_AT4G34000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m451_AT4G34000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m451_AT4G34000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m451_AT4G34000_logo.png",
 "name" : "AT4G34000",
 "ic" : "11.09",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "ACACGTGT"
 } 
 ] 
 },
 {
  "consensus" : "cysrCACGTGcv",
 "branch" : 17,
 "id" : "cluster_7_node_17",
 "ic" : "8.84",
 "size" : 12,
 "name" : "cluster_7_node_17_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_17_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_17_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GGCACGTGCC",
 "branch" : 13,
 "id" : "cluster_7_node_13",
 "ic" : "11.28",
 "size" : 12,
 "name" : "cluster_7_node_13_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_13_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_13_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m206_AT2G24260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m206_AT2G24260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m206_AT2G24260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m206_AT2G24260_logo.png",
 "name" : "AT2G24260",
 "ic" : "6.61",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "HSCACGTGSD"
 },
 {
  "label": "a.t_motifs_m401_AT4G14410", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m401_AT4G14410_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m401_AT4G14410_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m401_AT4G14410_logo.png",
 "name" : "AT4G14410",
 "ic" : "11.47",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "GGCACGTGCC"
 } 
 ] 
 },
 {
  "consensus" : "cycrCACGTGcr",
 "branch" : 16,
 "id" : "cluster_7_node_16",
 "ic" : "8.82",
 "size" : 12,
 "name" : "cluster_7_node_16_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_16_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_16_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ycaCACGTGyr",
 "branch" : 8,
 "id" : "cluster_7_node_8",
 "ic" : "10.25",
 "size" : 12,
 "name" : "cluster_7_node_8_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_8_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_8_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ycaCACGTGYr",
 "branch" : 4,
 "id" : "cluster_7_node_4",
 "ic" : "10.42",
 "size" : 12,
 "name" : "cluster_7_node_4_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_4_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_4_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ycaCACGTGYr",
 "branch" : 2,
 "id" : "cluster_7_node_2",
 "ic" : "10.64",
 "size" : 12,
 "name" : "cluster_7_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m165_AT1G78700", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m165_AT1G78700_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m165_AT1G78700_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m165_AT1G78700_logo.png",
 "name" : "AT1G78700",
 "ic" : "10.55",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCACACGTGYR"
 },
 {
  "label": "a.t_motifs_m460_AT4G36780", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m460_AT4G36780_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m460_AT4G36780_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m460_AT4G36780_logo.png",
 "name" : "AT4G36780",
 "ic" : "10.77",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "YRCACGTGTGR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m418_AT4G18890", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m418_AT4G18890_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m418_AT4G18890_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m418_AT4G18890_logo.png",
 "name" : "AT4G18890",
 "ic" : "10.15",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCACACGTGYR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m41_AT1G19350", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m41_AT1G19350_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m41_AT1G19350_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m41_AT1G19350_logo.png",
 "name" : "AT1G19350",
 "ic" : "9.10",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "BSMCACGTGYG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m190_AT2G18300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m190_AT2G18300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m190_AT2G18300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m190_AT2G18300_logo.png",
 "name" : "AT2G18300",
 "ic" : "8.23",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "AGCACGTGCMCG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "dgCCACGTGr",
 "branch" : 12,
 "id" : "cluster_7_node_12",
 "ic" : "8.58",
 "size" : 12,
 "name" : "cluster_7_node_12_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_7_node_12_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_7_node_12_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m20_AT1G09530", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m20_AT1G09530_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m20_AT1G09530_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m20_AT1G09530_logo.png",
 "name" : "AT1G09530",
 "ic" : "8.89",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCACGTGGCH"
 },
 {
  "label": "a.t_motifs_m458_AT4G36730", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m458_AT4G36730_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m458_AT4G36730_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m458_AT4G36730_logo.png",
 "name" : "AT4G36730",
 "ic" : "5.72",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "KKMCACGTSR"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 300; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_7").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BE7328");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_7"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BE7328"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_7" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BE7328")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_7").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_7").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_7").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_7").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 42;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_8").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "waaaaaaaaAaaraaaramAAAAAgwaaawwwwa",
 "branch" : 39,
 "id" : "cluster_8_node_39",
 "ic" : "9.55",
 "size" : 34,
 "name" : "cluster_8",
 "image" : "matrix-clustering_aligned_logos/cluster_8_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_logo_rc.png",

  "children": [
  {
  "consensus" : "aawsAwAAAGtdrmwwww",
 "branch" : 33,
 "id" : "cluster_8_node_33",
 "ic" : "8.87",
 "size" : 34,
 "name" : "cluster_8_node_33_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_33_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_33_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aawsAWAAAGkdrawwww",
 "branch" : 30,
 "id" : "cluster_8_node_30",
 "ic" : "8.87",
 "size" : 34,
 "name" : "cluster_8_node_30_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_30_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_30_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aawsAWAAAGkdra",
 "branch" : 25,
 "id" : "cluster_8_node_25",
 "ic" : "8.02",
 "size" : 34,
 "name" : "cluster_8_node_25_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_25_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_25_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rsAwAAAGTdra",
 "branch" : 20,
 "id" : "cluster_8_node_20",
 "ic" : "7.94",
 "size" : 34,
 "name" : "cluster_8_node_20_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_20_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_20_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "sAWAAAGkdra",
 "branch" : 5,
 "id" : "cluster_8_node_5",
 "ic" : "8.28",
 "size" : 34,
 "name" : "cluster_8_node_5_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_5_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_5_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "sAAAAAGkdra",
 "branch" : 2,
 "id" : "cluster_8_node_2",
 "ic" : "8.39",
 "size" : 34,
 "name" : "cluster_8_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m261_AT2G46590", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m261_AT2G46590_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m261_AT2G46590_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m261_AT2G46590_logo.png",
 "name" : "AT2G46590",
 "ic" : "8.43",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYHMCTTTTTS"
 },
 {
  "label": "a.t_motifs_m602_AT5G63260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m602_AT5G63260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m602_AT5G63260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m602_AT5G63260_logo.png",
 "name" : "AT5G63260",
 "ic" : "8.41",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYHMCTTTWTS"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m362_AT3G52440", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m362_AT3G52440_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m362_AT3G52440_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m362_AT3G52440_logo.png",
 "name" : "AT3G52440",
 "ic" : "8.24",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTHMCTTTWTS"
 } 
 ] 
 },
 {
  "consensus" : "rsawAAAGTrr",
 "branch" : 17,
 "id" : "cluster_8_node_17",
 "ic" : "7.61",
 "size" : 34,
 "name" : "cluster_8_node_17_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_17_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_17_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m543_AT5G39660", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m543_AT5G39660_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m543_AT5G39660_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m543_AT5G39660_logo.png",
 "name" : "AT5G39660",
 "ic" : "6.38",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "DYRCTTTWTK"
 },
 {
  "label": "a.t_motifs_m89_AT1G47655", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m89_AT1G47655_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m89_AT1G47655_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m89_AT1G47655_logo.png",
 "name" : "AT1G47655",
 "ic" : "7.70",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYACTTTWTSY"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m296_AT3G12130", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m296_AT3G12130_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m296_AT3G12130_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m296_AT3G12130_logo.png",
 "name" : "AT3G12130",
 "ic" : "7.88",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYWMCTTTTTSWTT"
 } 
 ] 
 },
 {
  "consensus" : "sAAAAAGkwAawwww",
 "branch" : 11,
 "id" : "cluster_8_node_11",
 "ic" : "9.20",
 "size" : 34,
 "name" : "cluster_8_node_11_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_11_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_11_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m588_AT5G60850", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m588_AT5G60850_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m588_AT5G60850_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m588_AT5G60850_logo.png",
 "name" : "AT5G60850",
 "ic" : "8.92",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWWTTWMCTTTTTS"
 },
 {
  "label": "a.t_motifs_m229_AT2G37590", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m229_AT2G37590_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m229_AT2G37590_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m229_AT2G37590_logo.png",
 "name" : "AT2G37590",
 "ic" : "9.65",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "MAAAAAGTWAAAWWW"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "rawAAAGtrrCTTTw",
 "branch" : 21,
 "id" : "cluster_8_node_21",
 "ic" : "10.29",
 "size" : 34,
 "name" : "cluster_8_node_21_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_21_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_21_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m422_AT4G21080", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m422_AT4G21080_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m422_AT4G21080_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m422_AT4G21080_logo.png",
 "name" : "AT4G21080",
 "ic" : "9.11",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAGYWACTTTWTY"
 },
 {
  "label": "a.t_motifs_m421_AT4G21040", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m421_AT4G21040_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m421_AT4G21040_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m421_AT4G21040_logo.png",
 "name" : "AT4G21040",
 "ic" : "12.40",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "AWAAAGWRGCTTTW"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "waaaaaaaaAaaraaaramAAAAArwaaaaaaaa",
 "branch" : 38,
 "id" : "cluster_8_node_38",
 "ic" : "9.22",
 "size" : 34,
 "name" : "cluster_8_node_38_30motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_38_30motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_38_30motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "waaaaaaaaAAAraaaaaraaAAAgwaaaaaaaa",
 "branch" : 36,
 "id" : "cluster_8_node_36",
 "ic" : "10.15",
 "size" : 34,
 "name" : "cluster_8_node_36_17motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_36_17motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_36_17motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m587_AT5G60130", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m587_AT5G60130_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m587_AT5G60130_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m587_AT5G60130_logo.png",
 "name" : "AT5G60130",
 "ic" : "11.10",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTTTSCTTAKWWTTTGCTT"
 },
 {
  "consensus" : "waaaaaaaaAAArwaaaaraAAAAGwaaaaaaaa",
 "branch" : 34,
 "id" : "cluster_8_node_34",
 "ic" : "10.30",
 "size" : 34,
 "name" : "cluster_8_node_34_16motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_34_16motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_34_16motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "waaaaaaaaaaaarrAAAAAGkraaaaaar",
 "branch" : 31,
 "id" : "cluster_8_node_31",
 "ic" : "11.26",
 "size" : 34,
 "name" : "cluster_8_node_31_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_31_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_31_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "waaaaaaaaaaaarrAAAAAGtraaaa",
 "branch" : 28,
 "id" : "cluster_8_node_28",
 "ic" : "11.04",
 "size" : 34,
 "name" : "cluster_8_node_28_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_28_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_28_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaaaaaaaarrAAAAAGtraaaa",
 "branch" : 23,
 "id" : "cluster_8_node_23",
 "ic" : "10.23",
 "size" : 34,
 "name" : "cluster_8_node_23_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_23_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_23_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaaaaaarrAAAAAGtraaaa",
 "branch" : 15,
 "id" : "cluster_8_node_15",
 "ic" : "9.76",
 "size" : 34,
 "name" : "cluster_8_node_15_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_15_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_15_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaaaarvAAAAAGtdaawa",
 "branch" : 8,
 "id" : "cluster_8_node_8",
 "ic" : "9.65",
 "size" : 34,
 "name" : "cluster_8_node_8_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_8_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_8_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m348_AT3G47500", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m348_AT3G47500_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m348_AT3G47500_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m348_AT3G47500_logo.png",
 "name" : "AT3G47500",
 "ic" : "10.03",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTYACTTTTTCYTTTTT"
 },
 {
  "label": "a.t_motifs_m116_AT1G64620", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m116_AT1G64620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m116_AT1G64620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m116_AT1G64620_logo.png",
 "name" : "AT1G64620",
 "ic" : "9.81",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWTTWMCTTTTTKTTTTWW"
 } 
 ] 
 },
 {
  "consensus" : "aaaaaaarrAAAAAGtraaaa",
 "branch" : 7,
 "id" : "cluster_8_node_7",
 "ic" : "9.73",
 "size" : 34,
 "name" : "cluster_8_node_7_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_7_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_7_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m61_AT1G29160", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m61_AT1G29160_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m61_AT1G29160_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m61_AT1G29160_logo.png",
 "name" : "AT1G29160",
 "ic" : "9.89",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTYACTTTTTYTTTTTTTT"
 },
 {
  "label": "a.t_motifs_m600_AT5G62940", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m600_AT5G62940_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m600_AT5G62940_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m600_AT5G62940_logo.png",
 "name" : "AT5G62940",
 "ic" : "9.97",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWTYWACTTTTTYYTTTTTTY"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "aaaaaaAarrrAAAAAGtwaa",
 "branch" : 16,
 "id" : "cluster_8_node_16",
 "ic" : "10.11",
 "size" : 34,
 "name" : "cluster_8_node_16_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_16_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_16_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m366_AT3G55370", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m366_AT3G55370_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m366_AT3G55370_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m366_AT3G55370_logo.png",
 "name" : "AT3G55370",
 "ic" : "10.91",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAAAAARRRAAAAAGWAAA"
 },
 {
  "label": "a.t_motifs_m344_AT3G45610", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m344_AT3G45610_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m344_AT3G45610_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m344_AT3G45610_logo.png",
 "name" : "AT3G45610",
 "ic" : "9.51",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAAARRSAAAAAGTWRA"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m135_AT1G69570", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m135_AT1G69570_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m135_AT1G69570_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m135_AT1G69570_logo.png",
 "name" : "AT1G69570",
 "ic" : "12.19",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "WAAAAAAAAAAAARRAAAAAGTRAAAA"
 } 
 ] 
 },
 {
  "consensus" : "aaaaarAAAAAGkwaaaaaar",
 "branch" : 22,
 "id" : "cluster_8_node_22",
 "ic" : "9.40",
 "size" : 34,
 "name" : "cluster_8_node_22_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_22_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_22_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m100_AT1G51700", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m100_AT1G51700_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m100_AT1G51700_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m100_AT1G51700_logo.png",
 "name" : "AT1G51700",
 "ic" : "9.51",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "YWTTTTYTACTTTTTYTTTTT"
 },
 {
  "label": "a.t_motifs_m420_AT4G21030", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m420_AT4G21030_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m420_AT4G21030_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m420_AT4G21030_logo.png",
 "name" : "AT4G21030",
 "ic" : "10.33",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTTTRCCTTTTTYTTTT"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "waaaaaaaAAAAGwaAaaaaaaaaraaaaaaaaw",
 "branch" : 32,
 "id" : "cluster_8_node_32",
 "ic" : "11.18",
 "size" : 34,
 "name" : "cluster_8_node_32_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_32_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_32_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "waaaaaaaAAAAGtwAaaaaaaaaraaaaaaaaw",
 "branch" : 29,
 "id" : "cluster_8_node_29",
 "ic" : "12.37",
 "size" : 34,
 "name" : "cluster_8_node_29_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_29_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_29_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aAAAAAGtwAaaaaaaaaraaaaaaaaw",
 "branch" : 26,
 "id" : "cluster_8_node_26",
 "ic" : "11.56",
 "size" : 34,
 "name" : "cluster_8_node_26_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_26_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_26_4motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m467_AT4G38000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m467_AT4G38000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m467_AT4G38000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m467_AT4G38000_logo.png",
 "name" : "AT4G38000",
 "ic" : "12.18",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "WAAAAAGWWAAAAAAAAAAAAWAAAAAW"
 },
 {
  "consensus" : "aaAAAAGtwaaaaaaaaarraa",
 "branch" : 13,
 "id" : "cluster_8_node_13",
 "ic" : "9.90",
 "size" : 34,
 "name" : "cluster_8_node_13_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_13_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_13_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m358_AT3G50410", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m358_AT3G50410_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m358_AT3G50410_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m358_AT3G50410_logo.png",
 "name" : "AT3G50410",
 "ic" : "9.15",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAAGYWRAAAAARARRRAA"
 },
 {
  "consensus" : "aAAAAAGtwAaaaaaaaaraa",
 "branch" : 6,
 "id" : "cluster_8_node_6",
 "ic" : "10.34",
 "size" : 34,
 "name" : "cluster_8_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m474_AT5G02460", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m474_AT5G02460_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m474_AT5G02460_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m474_AT5G02460_logo.png",
 "name" : "AT5G02460",
 "ic" : "10.91",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYTTTTTYTTTTTWCTTTTTT"
 },
 {
  "label": "a.t_motifs_m213_AT2G28810", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m213_AT2G28810_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m213_AT2G28810_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m213_AT2G28810_logo.png",
 "name" : "AT2G28810",
 "ic" : "10.28",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "VAAAAAGTWAAAAAAAAARAA"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m614_AT5G66940", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m614_AT5G66940_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m614_AT5G66940_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m614_AT5G66940_logo.png",
 "name" : "AT5G66940",
 "ic" : "11.61",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "WAAAAAAAAAAAGTAAAAARAAAAAAAAW"
 } 
 ] 
 },
 {
  "consensus" : "arArArArArArAaArarArr",
 "branch" : 18,
 "id" : "cluster_8_node_18",
 "ic" : "10.15",
 "size" : 34,
 "name" : "cluster_8_node_18_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_18_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_18_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m255_AT2G45660", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m255_AT2G45660_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m255_AT2G45660_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m255_AT2G45660_logo.png",
 "name" : "AT2G45660",
 "ic" : "10.69",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "ARARARARARARAARRARARR"
 },
 {
  "label": "a.t_motifs_m515_AT5G17430", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m515_AT5G17430_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m515_AT5G17430_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m515_AT5G17430_logo.png",
 "name" : "AT5G17430",
 "ic" : "11.58",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYTYTYTYYYTYTYTTYHTT"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "masaAAAmGACAAAAawaawaa",
 "branch" : 37,
 "id" : "cluster_8_node_37",
 "ic" : "10.17",
 "size" : 34,
 "name" : "cluster_8_node_37_13motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_37_13motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_37_13motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "mavaAAAmGACAAAAawaawaa",
 "branch" : 35,
 "id" : "cluster_8_node_35",
 "ic" : "11.23",
 "size" : 34,
 "name" : "cluster_8_node_35_12motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_35_12motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_35_12motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "masaAAAmGACAAAAawaawaa",
 "branch" : 27,
 "id" : "cluster_8_node_27",
 "ic" : "12.10",
 "size" : 34,
 "name" : "cluster_8_node_27_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_27_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_27_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "masAAAAmGACAAAAawaawaa",
 "branch" : 24,
 "id" : "cluster_8_node_24",
 "ic" : "12.32",
 "size" : 34,
 "name" : "cluster_8_node_24_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_24_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_24_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "masAAaAmGACAAAAawaawaa",
 "branch" : 19,
 "id" : "cluster_8_node_19",
 "ic" : "11.55",
 "size" : 34,
 "name" : "cluster_8_node_19_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_19_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_19_5motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m303_AT3G13810", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m303_AT3G13810_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m303_AT3G13810_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m303_AT3G13810_logo.png",
 "name" : "AT3G13810",
 "ic" : "10.46",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "ARAAAAMGACAAAAAWAAAAA"
 },
 {
  "consensus" : "masAAAAmGACAAAAawaaw",
 "branch" : 12,
 "id" : "cluster_8_node_12",
 "ic" : "11.87",
 "size" : 34,
 "name" : "cluster_8_node_12_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_12_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_12_4motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m170_AT2G01570", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m170_AT2G01570_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m170_AT2G01570_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m170_AT2G01570_logo.png",
 "name" : "AT2G01570",
 "ic" : "9.01",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYTTYYTTTSTCTYTTTCTB"
 },
 {
  "consensus" : "masAAAAmGACAAAAawwww",
 "branch" : 3,
 "id" : "cluster_8_node_3",
 "ic" : "12.93",
 "size" : 34,
 "name" : "cluster_8_node_3_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_3_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_3_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "masAAAAmGACAAAAawwww",
 "branch" : 1,
 "id" : "cluster_8_node_1",
 "ic" : "12.88",
 "size" : 34,
 "name" : "cluster_8_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m476_AT5G03150", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m476_AT5G03150_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m476_AT5G03150_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m476_AT5G03150_logo.png",
 "name" : "AT5G03150",
 "ic" : "12.57",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "MASAAAAMGACAAAAAWWWW"
 },
 {
  "label": "a.t_motifs_m9_AT1G03840", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m9_AT1G03840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m9_AT1G03840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m9_AT1G03840_logo.png",
 "name" : "AT1G03840",
 "ic" : "13.31",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWTWTTTTTGTCKTTTTSTD"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m30_AT1G14580", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m30_AT1G14580_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m30_AT1G14580_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m30_AT1G14580_logo.png",
 "name" : "AT1G14580",
 "ic" : "13.56",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "MRSWAAACGACAAAAAWAWW"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "masWAAAmGACAAAAawa",
 "branch" : 14,
 "id" : "cluster_8_node_14",
 "ic" : "12.92",
 "size" : 34,
 "name" : "cluster_8_node_14_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_14_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_14_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "mrswAAACGACAAAAw",
 "branch" : 10,
 "id" : "cluster_8_node_10",
 "ic" : "12.95",
 "size" : 34,
 "name" : "cluster_8_node_10_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_10_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_10_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m174_AT2G02070", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m174_AT2G02070_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m174_AT2G02070_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m174_AT2G02070_logo.png",
 "name" : "AT2G02070",
 "ic" : "12.87",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "CRSWAAACGACAAAAW"
 },
 {
  "label": "a.t_motifs_m359_AT3G50700", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m359_AT3G50700_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m359_AT3G50700_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m359_AT3G50700_logo.png",
 "name" : "AT3G50700",
 "ic" : "13.30",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTGTCKTTTWSYD"
 } 
 ] 
 },
 {
  "consensus" : "masAAAAmGACAAAAawa",
 "branch" : 9,
 "id" : "cluster_8_node_9",
 "ic" : "12.95",
 "size" : 34,
 "name" : "cluster_8_node_9_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_9_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_9_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "masAAAAmGACAAAAaw",
 "branch" : 4,
 "id" : "cluster_8_node_4",
 "ic" : "12.93",
 "size" : 34,
 "name" : "cluster_8_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_8_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_8_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m613_AT5G66730", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m613_AT5G66730_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m613_AT5G66730_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m613_AT5G66730_logo.png",
 "name" : "AT5G66730",
 "ic" : "12.82",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTTTTTGTCKTTTTSTD"
 },
 {
  "label": "a.t_motifs_m175_AT2G02080", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m175_AT2G02080_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m175_AT2G02080_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m175_AT2G02080_logo.png",
 "name" : "AT2G02080",
 "ic" : "13.31",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWTTTTGTCKTTTTSTK"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m109_AT1G55110", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m109_AT1G55110_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m109_AT1G55110_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m109_AT1G55110_logo.png",
 "name" : "AT1G55110",
 "ic" : "12.91",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWTTTTTGTCGTTTTSYK"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m173_AT2G01940", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m173_AT2G01940_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m173_AT2G01940_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m173_AT2G01940_logo.png",
 "name" : "AT2G01940",
 "ic" : "11.90",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTTTTGTCTTWTTYT"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m92_AT1G49480", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m92_AT1G49480_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m92_AT1G49480_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m92_AT1G49480_logo.png",
 "name" : "AT1G49480",
 "ic" : "11.75",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTTTTTTTTTKTY"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m427_AT4G24020", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m427_AT4G24020_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m427_AT4G24020_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m427_AT4G24020_logo.png",
 "name" : "AT4G24020",
 "ic" : "7.66",
 "size" : 34,
 "title" : "a.t_motifs",
 "consensus_rc" : "HYYSAARRGYCAWWW"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 300; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_8").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CD6918");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_8"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CD6918"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_8" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CD6918")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_8").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_8").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_8").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_8").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 29;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_9").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "tawrGAAkmTTCtakwagmw",
 "branch" : 26,
 "id" : "cluster_9_node_26",
 "ic" : "8.18",
 "size" : 20,
 "name" : "cluster_9",
 "image" : "matrix-clustering_aligned_logos/cluster_9_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_logo_rc.png",

  "children": [
  {
  "consensus" : "tcwrGAAgcTTCTAGAAgmw",
 "branch" : 21,
 "id" : "cluster_9_node_21",
 "ic" : "12.11",
 "size" : 20,
 "name" : "cluster_9_node_21_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_21_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_21_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rGAAgcTTCTAGAAgmw",
 "branch" : 20,
 "id" : "cluster_9_node_20",
 "ic" : "12.11",
 "size" : 20,
 "name" : "cluster_9_node_20_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_20_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_20_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rGAAgcTTCTAGAAg",
 "branch" : 17,
 "id" : "cluster_9_node_17",
 "ic" : "11.78",
 "size" : 20,
 "name" : "cluster_9_node_17_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_17_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_17_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rGAAgcTTCTAGAAg",
 "branch" : 12,
 "id" : "cluster_9_node_12",
 "ic" : "11.99",
 "size" : 20,
 "name" : "cluster_9_node_12_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_12_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_12_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rGAAgmTTCTAGAAg",
 "branch" : 7,
 "id" : "cluster_9_node_7",
 "ic" : "11.62",
 "size" : 20,
 "name" : "cluster_9_node_7_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_7_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_7_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rGAAgmTTCTAGAAg",
 "branch" : 3,
 "id" : "cluster_9_node_3",
 "ic" : "11.93",
 "size" : 20,
 "name" : "cluster_9_node_3_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_3_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_3_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m87_AT1G46264", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m87_AT1G46264_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m87_AT1G46264_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m87_AT1G46264_logo.png",
 "name" : "AT1G46264",
 "ic" : "13.65",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "CTTCTAGAAGCTTCT"
 },
 {
  "consensus" : "rGAAgmTTCTAGAAg",
 "branch" : 1,
 "id" : "cluster_9_node_1",
 "ic" : "11.71",
 "size" : 20,
 "name" : "cluster_9_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m322_AT3G22830", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m322_AT3G22830_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m322_AT3G22830_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m322_AT3G22830_logo.png",
 "name" : "AT3G22830",
 "ic" : "10.84",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "CTTCTAGAAKSTTCY"
 },
 {
  "label": "a.t_motifs_m285_AT3G09735", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m285_AT3G09735_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m285_AT3G09735_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m285_AT3G09735_logo.png",
 "name" : "AT3G09735",
 "ic" : "12.78",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "YTTCTAGAAKCTTCY"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m240_AT2G41690", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m240_AT2G41690_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m240_AT2G41690_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m240_AT2G41690_logo.png",
 "name" : "AT2G41690",
 "ic" : "9.88",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "RGAAGMTTCTAGAAG"
 } 
 ] 
 },
 {
  "consensus" : "rGAAgcTTCTAGAA",
 "branch" : 9,
 "id" : "cluster_9_node_9",
 "ic" : "12.61",
 "size" : 20,
 "name" : "cluster_9_node_9_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_9_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_9_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m400_AT4G11660", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m400_AT4G11660_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m400_AT4G11660_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m400_AT4G11660_logo.png",
 "name" : "AT4G11660",
 "ic" : "12.52",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "AGAAGCTTCTAGAA"
 },
 {
  "label": "a.t_motifs_m274_AT3G02990", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m274_AT3G02990_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m274_AT3G02990_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m274_AT3G02990_logo.png",
 "name" : "AT3G02990",
 "ic" : "12.02",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "TCTAGAAGCTTCY"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "GAAgcTTCTAGA",
 "branch" : 10,
 "id" : "cluster_9_node_10",
 "ic" : "10.51",
 "size" : 20,
 "name" : "cluster_9_node_10_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_10_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_10_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GAAgcTTCTAGA",
 "branch" : 4,
 "id" : "cluster_9_node_4",
 "ic" : "10.01",
 "size" : 20,
 "name" : "cluster_9_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m513_AT5G16820", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m513_AT5G16820_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m513_AT5G16820_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m513_AT5G16820_logo.png",
 "name" : "AT5G16820",
 "ic" : "10.24",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "TCTAGAAGCTTC"
 },
 {
  "label": "a.t_motifs_m595_AT5G62020", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m595_AT5G62020_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m595_AT5G62020_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m595_AT5G62020_logo.png",
 "name" : "AT5G62020",
 "ic" : "10.17",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "TCTRGAAGCTTC"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m330_AT3G24520", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m330_AT3G24520_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m330_AT3G24520_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m330_AT3G24520_logo.png",
 "name" : "AT3G24520",
 "ic" : "10.96",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "GAAGCTTCTAG"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m551_AT5G43840", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m551_AT5G43840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m551_AT5G43840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m551_AT5G43840_logo.png",
 "name" : "AT5G43840",
 "ic" : "12.96",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "WKCTTCTAGAAKCTTC"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m417_AT4G18880", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m417_AT4G18880_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m417_AT4G18880_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m417_AT4G18880_logo.png",
 "name" : "AT4G18880",
 "ic" : "11.69",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "KCTTCTAGAAGCTTCTWGA"
 } 
 ] 
 },
 {
  "consensus" : "aarGAATMTTCbwwtct",
 "branch" : 25,
 "id" : "cluster_9_node_25",
 "ic" : "8.02",
 "size" : 20,
 "name" : "cluster_9_node_25_16motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_25_16motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_25_16motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aarGAATMTTCbwwtct",
 "branch" : 24,
 "id" : "cluster_9_node_24",
 "ic" : "7.91",
 "size" : 20,
 "name" : "cluster_9_node_24_15motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_24_15motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_24_15motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rGAATMTtykaTwct",
 "branch" : 23,
 "id" : "cluster_9_node_23",
 "ic" : "8.89",
 "size" : 20,
 "name" : "cluster_9_node_23_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_23_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_23_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rGAATmTTctd",
 "branch" : 13,
 "id" : "cluster_9_node_13",
 "ic" : "8.50",
 "size" : 20,
 "name" : "cluster_9_node_13_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_13_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_13_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rGAATMTTytd",
 "branch" : 6,
 "id" : "cluster_9_node_6",
 "ic" : "8.59",
 "size" : 20,
 "name" : "cluster_9_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m463_AT4G37180", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m463_AT4G37180_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m463_AT4G37180_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m463_AT4G37180_logo.png",
 "name" : "AT4G37180",
 "ic" : "8.93",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "RGAATCTTYTD"
 },
 {
  "label": "a.t_motifs_m52_AT1G25550", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m52_AT1G25550_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m52_AT1G25550_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m52_AT1G25550_logo.png",
 "name" : "AT1G25550",
 "ic" : "8.59",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "HWGAAKATTCY"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m180_AT2G03500", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m180_AT2G03500_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m180_AT2G03500_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m180_AT2G03500_logo.png",
 "name" : "AT2G03500",
 "ic" : "9.28",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "YRGAATATTCY"
 } 
 ] 
 },
 {
  "consensus" : "rGAATCTtygATwct",
 "branch" : 19,
 "id" : "cluster_9_node_19",
 "ic" : "9.01",
 "size" : 20,
 "name" : "cluster_9_node_19_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_19_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_19_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m28_AT1G13300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m28_AT1G13300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m28_AT1G13300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m28_AT1G13300_logo.png",
 "name" : "AT1G13300",
 "ic" : "9.18",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "RGAATMTTCGATWCT"
 },
 {
  "consensus" : "GAATCTttgATtc",
 "branch" : 15,
 "id" : "cluster_9_node_15",
 "ic" : "8.89",
 "size" : 20,
 "name" : "cluster_9_node_15_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_15_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_15_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m127_AT1G68670", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m127_AT1G68670_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m127_AT1G68670_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m127_AT1G68670_logo.png",
 "name" : "AT1G68670",
 "ic" : "8.52",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "GAATCTTTGATTC"
 },
 {
  "label": "a.t_motifs_m93_AT1G49560", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m93_AT1G49560_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m93_AT1G49560_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m93_AT1G49560_logo.png",
 "name" : "AT1G49560",
 "ic" : "8.88",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "GAATCTTTGAT"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "aarGAAtATTCywwtt",
 "branch" : 22,
 "id" : "cluster_9_node_22",
 "ic" : "8.87",
 "size" : 20,
 "name" : "cluster_9_node_22_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_22_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_22_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aarGAATATTCywwtt",
 "branch" : 18,
 "id" : "cluster_9_node_18",
 "ic" : "9.00",
 "size" : 20,
 "name" : "cluster_9_node_18_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_18_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_18_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "twrrAAkATTCytttt",
 "branch" : 16,
 "id" : "cluster_9_node_16",
 "ic" : "9.12",
 "size" : 20,
 "name" : "cluster_9_node_16_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_16_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_16_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "twarAAkATTCyytt",
 "branch" : 14,
 "id" : "cluster_9_node_14",
 "ic" : "8.82",
 "size" : 20,
 "name" : "cluster_9_node_14_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_14_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_14_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m236_AT2G40260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m236_AT2G40260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m236_AT2G40260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m236_AT2G40260_logo.png",
 "name" : "AT2G40260",
 "ic" : "9.20",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "AARRGAATRTWWWWA"
 },
 {
  "consensus" : "arrAAkATTCyhtt",
 "branch" : 5,
 "id" : "cluster_9_node_5",
 "ic" : "9.13",
 "size" : 20,
 "name" : "cluster_9_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m277_AT3G04030", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m277_AT3G04030_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m277_AT3G04030_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m277_AT3G04030_logo.png",
 "name" : "AT3G04030",
 "ic" : "9.00",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "AARAAKATTCYHTT"
 },
 {
  "label": "a.t_motifs_m554_AT5G45580", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m554_AT5G45580_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m554_AT5G45580_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m554_AT5G45580_logo.png",
 "name" : "AT5G45580",
 "ic" : "9.44",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "WRRAAKATTCYTTT"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "rGAATATTCytttt",
 "branch" : 11,
 "id" : "cluster_9_node_11",
 "ic" : "10.32",
 "size" : 20,
 "name" : "cluster_9_node_11_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_11_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_11_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m299_AT3G12730", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m299_AT3G12730_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m299_AT3G12730_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m299_AT3G12730_logo.png",
 "name" : "AT3G12730",
 "ic" : "11.62",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "RGAATATTCYYTTT"
 },
 {
  "label": "a.t_motifs_m169_AT2G01060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m169_AT2G01060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m169_AT2G01060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m169_AT2G01060_logo.png",
 "name" : "AT2G01060",
 "ic" : "10.08",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "RGAATATTCYTTT"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "aarGAATATTCbaww",
 "branch" : 8,
 "id" : "cluster_9_node_8",
 "ic" : "10.31",
 "size" : 20,
 "name" : "cluster_9_node_8_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_8_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_8_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aarGAATATTCbaww",
 "branch" : 2,
 "id" : "cluster_9_node_2",
 "ic" : "10.77",
 "size" : 20,
 "name" : "cluster_9_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_9_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_9_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m538_AT5G29000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m538_AT5G29000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m538_AT5G29000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m538_AT5G29000_logo.png",
 "name" : "AT5G29000",
 "ic" : "10.61",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWTVGAATATTCYTT"
 },
 {
  "label": "a.t_motifs_m195_AT2G20400", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m195_AT2G20400_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m195_AT2G20400_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m195_AT2G20400_logo.png",
 "name" : "AT2G20400",
 "ic" : "11.11",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWYVGAATATTCYTT"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m69_AT1G32240", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m69_AT1G32240_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m69_AT1G32240_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m69_AT1G32240_logo.png",
 "name" : "AT1G32240",
 "ic" : "10.08",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "ARAGAATATTCTWAW"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m231_AT2G38300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m231_AT2G38300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m231_AT2G38300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m231_AT2G38300_logo.png",
 "name" : "AT2G38300",
 "ic" : "8.51",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAHATTCYYTT"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m549_AT5G42630", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m549_AT5G42630_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m549_AT5G42630_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m549_AT5G42630_logo.png",
 "name" : "AT5G42630",
 "ic" : "8.74",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "GAATATTC"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 300; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_9").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D75F0A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_9"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D75F0A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_9" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D75F0A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_9").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_9").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_9").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_9").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 21;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_10").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wadwwwwdwCsGTTAydwwwgTTr",
 "branch" : 18,
 "id" : "cluster_10_node_18",
 "ic" : "9.50",
 "size" : 24,
 "name" : "cluster_10",
 "image" : "matrix-clustering_aligned_logos/cluster_10_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_logo_rc.png",

  "children": [
  {
  "consensus" : "wadwwwwdwCsGTTAyrdwww",
 "branch" : 17,
 "id" : "cluster_10_node_17",
 "ic" : "8.03",
 "size" : 24,
 "name" : "cluster_10_node_17_17motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_17_17motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_17_17motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "awwrwdwCsGTTAyrdwww",
 "branch" : 16,
 "id" : "cluster_10_node_16",
 "ic" : "7.85",
 "size" : 24,
 "name" : "cluster_10_node_16_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_16_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_16_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "awwwyrwmCGTTACawwww",
 "branch" : 15,
 "id" : "cluster_10_node_15",
 "ic" : "10.06",
 "size" : 24,
 "name" : "cluster_10_node_15_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_15_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_15_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yrwmCGTTACawwww",
 "branch" : 12,
 "id" : "cluster_10_node_12",
 "ic" : "9.36",
 "size" : 24,
 "name" : "cluster_10_node_12_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_12_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_12_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m416_AT4G18770", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m416_AT4G18770_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m416_AT4G18770_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m416_AT4G18770_logo.png",
 "name" : "AT4G18770",
 "ic" : "9.48",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "YWWMCGTTACWWWWW"
 },
 {
  "label": "a.t_motifs_m583_AT5G58850", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m583_AT5G58850_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m583_AT5G58850_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m583_AT5G58850_logo.png",
 "name" : "AT5G58850",
 "ic" : "8.65",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "YGTAACGKWYR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m337_AT3G27785", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m337_AT3G27785_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m337_AT3G27785_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m337_AT3G27785_logo.png",
 "name" : "AT3G27785",
 "ic" : "10.59",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWYGTAACGKWYRWWWT"
 } 
 ] 
 },
 {
  "consensus" : "rwdwCsGTTAydkww",
 "branch" : 14,
 "id" : "cluster_10_node_14",
 "ic" : "7.46",
 "size" : 24,
 "name" : "cluster_10_node_14_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_14_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_14_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rwdwYrGTTAy",
 "branch" : 3,
 "id" : "cluster_10_node_3",
 "ic" : "7.41",
 "size" : 24,
 "name" : "cluster_10_node_3_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_3_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_3_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rwwwCrGTTAb",
 "branch" : 2,
 "id" : "cluster_10_node_2",
 "ic" : "7.41",
 "size" : 24,
 "name" : "cluster_10_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m485_AT5G06100", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m485_AT5G06100_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m485_AT5G06100_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m485_AT5G06100_logo.png",
 "name" : "AT5G06100",
 "ic" : "7.72",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "DWKWCRGTTAT"
 },
 {
  "label": "a.t_motifs_m210_AT2G26960", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m210_AT2G26960_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m210_AT2G26960_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m210_AT2G26960_logo.png",
 "name" : "AT2G26960",
 "ic" : "7.39",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "RAWWCGGTTAS"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m119_AT1G66370", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m119_AT1G66370_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m119_AT1G66370_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m119_AT1G66370_logo.png",
 "name" : "AT1G66370",
 "ic" : "8.14",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "ATAACKRAMTW"
 } 
 ] 
 },
 {
  "consensus" : "rwtwCsGTTAtdkww",
 "branch" : 10,
 "id" : "cluster_10_node_10",
 "ic" : "7.34",
 "size" : 24,
 "name" : "cluster_10_node_10_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_10_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_10_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m516_AT5G17800", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m516_AT5G17800_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m516_AT5G17800_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m516_AT5G17800_logo.png",
 "name" : "AT5G17800",
 "ic" : "8.85",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "AWWWCCGTTATTWWW"
 },
 {
  "consensus" : "rwtwCgGTTayrktt",
 "branch" : 7,
 "id" : "cluster_10_node_7",
 "ic" : "7.50",
 "size" : 24,
 "name" : "cluster_10_node_7_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_7_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_7_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m295_AT3G11440", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m295_AT3G11440_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m295_AT3G11440_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m295_AT3G11440_logo.png",
 "name" : "AT3G11440",
 "ic" : "7.37",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "WKDCGGTTAYRRT"
 },
 {
  "label": "a.t_motifs_m219_AT2G32460", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m219_AT2G32460_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m219_AT2G32460_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m219_AT2G32460_logo.png",
 "name" : "AT2G32460",
 "ic" : "7.85",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWTWCGGTTWYRKTT"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "wadwwwtdaCcGTTrr",
 "branch" : 13,
 "id" : "cluster_10_node_13",
 "ic" : "8.00",
 "size" : 24,
 "name" : "cluster_10_node_13_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_13_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_13_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wadwwwtdaCCGTTrr",
 "branch" : 11,
 "id" : "cluster_10_node_11",
 "ic" : "8.08",
 "size" : 24,
 "name" : "cluster_10_node_11_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_11_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_11_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yrgttwwdwCsGTTA",
 "branch" : 5,
 "id" : "cluster_10_node_5",
 "ic" : "7.77",
 "size" : 24,
 "name" : "cluster_10_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m203_AT2G23290", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m203_AT2G23290_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m203_AT2G23290_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m203_AT2G23290_logo.png",
 "name" : "AT2G23290",
 "ic" : "8.25",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "RGTTWWTWCSGTTA"
 },
 {
  "label": "a.t_motifs_m356_AT3G50060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m356_AT3G50060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m356_AT3G50060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m356_AT3G50060_logo.png",
 "name" : "AT3G50060",
 "ic" : "7.80",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "TAACSGTHWWWWYHR"
 } 
 ] 
 },
 {
  "consensus" : "awwwwwTrRCCGTTrr",
 "branch" : 6,
 "id" : "cluster_10_node_6",
 "ic" : "9.82",
 "size" : 24,
 "name" : "cluster_10_node_6_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_6_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_6_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwwwwTrrCCGTTrr",
 "branch" : 1,
 "id" : "cluster_10_node_1",
 "ic" : "9.59",
 "size" : 24,
 "name" : "cluster_10_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m447_AT4G32730", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m447_AT4G32730_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m447_AT4G32730_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m447_AT4G32730_logo.png",
 "name" : "AT4G32730",
 "ic" : "9.51",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYAACGGTHAWWWWW"
 },
 {
  "label": "a.t_motifs_m502_AT5G11510", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m502_AT5G11510_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m502_AT5G11510_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m502_AT5G11510_logo.png",
 "name" : "AT5G11510",
 "ic" : "9.73",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYAACGGYYATWWWW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m473_AT5G02320", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m473_AT5G02320_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m473_AT5G02320_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m473_AT5G02320_logo.png",
 "name" : "AT5G02320",
 "ic" : "10.14",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "YAACGGYHAWWWWTT"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "wtwwwwwCsGTTA",
 "branch" : 9,
 "id" : "cluster_10_node_9",
 "ic" : "8.44",
 "size" : 24,
 "name" : "cluster_10_node_9_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_9_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_9_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwwtwCsGTTA",
 "branch" : 4,
 "id" : "cluster_10_node_4",
 "ic" : "7.77",
 "size" : 24,
 "name" : "cluster_10_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m34_AT1G17950", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m34_AT1G17950_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m34_AT1G17950_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m34_AT1G17950_logo.png",
 "name" : "AT1G17950",
 "ic" : "8.76",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "TAACGGTWWHR"
 },
 {
  "label": "a.t_motifs_m464_AT4G37260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m464_AT4G37260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m464_AT4G37260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m464_AT4G37260_logo.png",
 "name" : "AT4G37260",
 "ic" : "7.93",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWWTWCVGTTA"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m134_AT1G69560", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m134_AT1G69560_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m134_AT1G69560_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m134_AT1G69560_logo.png",
 "name" : "AT1G69560",
 "ic" : "9.96",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "TAACGGTWWWDAW"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "dwdwCsGTTwwwwymGTTr",
 "branch" : 8,
 "id" : "cluster_10_node_8",
 "ic" : "9.32",
 "size" : 24,
 "name" : "cluster_10_node_8_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_10_node_8_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_10_node_8_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m283_AT3G09230", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m283_AT3G09230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m283_AT3G09230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m283_AT3G09230_logo.png",
 "name" : "AT3G09230",
 "ic" : "9.14",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "HAASADHWWWAACSGTWAH"
 },
 {
  "label": "a.t_motifs_m617_AT5G67300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m617_AT5G67300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m617_AT5G67300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m617_AT5G67300_logo.png",
 "name" : "AT5G67300",
 "ic" : "10.64",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "YAACBGWWWWAACBGWHWH"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_10").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D0612C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_10"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D0612C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_10" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D0612C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_10").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_10").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_10").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_10").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 52;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_11").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "arrTwrCkTgwwkwwcAmGywAyctt",
 "branch" : 49,
 "id" : "cluster_11_node_49",
 "ic" : "10.11",
 "size" : 26,
 "name" : "cluster_11",
 "image" : "matrix-clustering_aligned_logos/cluster_11_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_logo_rc.png",

  "children": [
  {
  "consensus" : "arrTwrCkTgwdbwwcAmGywAyc",
 "branch" : 47,
 "id" : "cluster_11_node_47",
 "ic" : "10.96",
 "size" : 26,
 "name" : "cluster_11_node_47_44motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_47_44motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_47_44motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "arrTwrCkTgwdbwwcAmGywAyc",
 "branch" : 46,
 "id" : "cluster_11_node_46",
 "ic" : "11.07",
 "size" : 26,
 "name" : "cluster_11_node_46_43motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_46_43motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_46_43motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ardTtmCkTGtwmaaCAmG",
 "branch" : 41,
 "id" : "cluster_11_node_41",
 "ic" : "9.12",
 "size" : 26,
 "name" : "cluster_11_node_41_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_41_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_41_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "arkTTwCKTGtwymaCAmG",
 "branch" : 15,
 "id" : "cluster_11_node_15",
 "ic" : "11.02",
 "size" : 26,
 "name" : "cluster_11_node_15_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_15_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_15_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m76_AT1G34190", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m76_AT1G34190_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m76_AT1G34190_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m76_AT1G34190_logo.png",
 "name" : "AT1G34190",
 "ic" : "12.29",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKTGTKSWVCAAGWAAMHT"
 },
 {
  "label": "a.t_motifs_m576_AT5G53950", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m576_AT5G53950_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m576_AT5G53950_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m576_AT5G53950_logo.png",
 "name" : "AT5G53950",
 "ic" : "10.71",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "MGDTTRCKTGTWYHACAMG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m176_AT2G02450", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m176_AT2G02450_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m176_AT2G02450_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m176_AT2G02450_logo.png",
 "name" : "AT2G02450",
 "ic" : "8.73",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "ARDTKMCGTRTWRRWYASG"
 } 
 ] 
 },
 {
  "consensus" : "rTwrCkTgwdbwwcAmGywAyc",
 "branch" : 45,
 "id" : "cluster_11_node_45",
 "ic" : "11.14",
 "size" : 26,
 "name" : "cluster_11_node_45_40motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_45_40motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_45_40motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "gTwrCKTgwdbwwcAMGy",
 "branch" : 43,
 "id" : "cluster_11_node_43",
 "ic" : "9.85",
 "size" : 26,
 "name" : "cluster_11_node_43_25motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_43_25motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_43_25motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "gTwrCkTGwdgwwcAmGy",
 "branch" : 40,
 "id" : "cluster_11_node_40",
 "ic" : "9.80",
 "size" : 26,
 "name" : "cluster_11_node_40_21motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_40_21motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_40_21motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "gTwrCkTGwdgwwcAmGw",
 "branch" : 39,
 "id" : "cluster_11_node_39",
 "ic" : "9.94",
 "size" : 26,
 "name" : "cluster_11_node_39_20motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_39_20motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_39_20motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wrCkTgwdgwwcAmG",
 "branch" : 35,
 "id" : "cluster_11_node_35",
 "ic" : "8.33",
 "size" : 26,
 "name" : "cluster_11_node_35_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_35_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_35_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wrCkTgwdgwwsAmG",
 "branch" : 31,
 "id" : "cluster_11_node_31",
 "ic" : "8.39",
 "size" : 26,
 "name" : "cluster_11_node_31_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_31_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_31_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wrCkTgwrgawsAAG",
 "branch" : 19,
 "id" : "cluster_11_node_19",
 "ic" : "8.82",
 "size" : 26,
 "name" : "cluster_11_node_19_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_19_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_19_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "arCkTrwdgawsAAG",
 "branch" : 3,
 "id" : "cluster_11_node_3",
 "ic" : "9.01",
 "size" : 26,
 "name" : "cluster_11_node_3_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_3_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_3_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "arCkTrwwgawsAAG",
 "branch" : 2,
 "id" : "cluster_11_node_2",
 "ic" : "9.03",
 "size" : 26,
 "name" : "cluster_11_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m439_AT4G29230", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m439_AT4G29230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m439_AT4G29230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m439_AT4G29230_logo.png",
 "name" : "AT4G29230",
 "ic" : "9.60",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CTTSWTCWWCAMGYT"
 },
 {
  "label": "a.t_motifs_m437_AT4G28500", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m437_AT4G28500_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m437_AT4G28500_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m437_AT4G28500_logo.png",
 "name" : "AT4G28500",
 "ic" : "8.63",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "WRCKTRWRGAWSAAG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m60_AT1G28470", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m60_AT1G28470_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m60_AT1G28470_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m60_AT1G28470_logo.png",
 "name" : "AT1G28470",
 "ic" : "9.19",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKTSWTCHWYAMGYW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m412_AT4G17980", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m412_AT4G17980_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m412_AT4G17980_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m412_AT4G17980_logo.png",
 "name" : "AT4G17980",
 "ic" : "9.46",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CTTSWTYYTCAMGYA"
 } 
 ] 
 },
 {
  "consensus" : "TrCkTgtkytwyAmG",
 "branch" : 18,
 "id" : "cluster_11_node_18",
 "ic" : "8.87",
 "size" : 26,
 "name" : "cluster_11_node_18_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_18_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_18_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "trCkTGtkcyrCAmG",
 "branch" : 11,
 "id" : "cluster_11_node_11",
 "ic" : "9.46",
 "size" : 26,
 "name" : "cluster_11_node_11_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_11_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_11_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m542_AT5G39610", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m542_AT5G39610_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m542_AT5G39610_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m542_AT5G39610_logo.png",
 "name" : "AT5G39610",
 "ic" : "9.71",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "WRCKTGTKBTACAMG"
 },
 {
  "label": "a.t_motifs_m75_AT1G34180", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m75_AT1G34180_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m75_AT1G34180_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m75_AT1G34180_logo.png",
 "name" : "AT1G34180",
 "ic" : "9.86",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TVCKTGTKCYSCAMG"
 } 
 ] 
 },
 {
  "consensus" : "TGCkTgwdtttyAmG",
 "branch" : 5,
 "id" : "cluster_11_node_5",
 "ic" : "9.02",
 "size" : 26,
 "name" : "cluster_11_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m456_AT4G36160", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m456_AT4G36160_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m456_AT4G36160_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m456_AT4G36160_logo.png",
 "name" : "AT4G36160",
 "ic" : "8.98",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TRCKTGWDTTTYAMG"
 },
 {
  "label": "a.t_motifs_m24_AT1G12260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m24_AT1G12260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m24_AT1G12260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m24_AT1G12260_logo.png",
 "name" : "AT1G12260",
 "ic" : "9.22",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGCKTRWWTTTYAMG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m188_AT2G18060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m188_AT2G18060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m188_AT2G18060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m188_AT2G18060_logo.png",
 "name" : "AT2G18060",
 "ic" : "7.61",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CKTRWAWWWCAMG"
 } 
 ] 
 },
 {
  "consensus" : "gTtrCTTGtdshaCAMGw",
 "branch" : 32,
 "id" : "cluster_11_node_32",
 "ic" : "10.46",
 "size" : 26,
 "name" : "cluster_11_node_32_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_32_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_32_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "gTTtCTTGtrsaaCAAGw",
 "branch" : 24,
 "id" : "cluster_11_node_24",
 "ic" : "12.98",
 "size" : 26,
 "name" : "cluster_11_node_24_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_24_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_24_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m310_AT3G15510", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m310_AT3G15510_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m310_AT3G15510_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m310_AT3G15510_logo.png",
 "name" : "AT3G15510",
 "ic" : "12.80",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTTTCTTGYRSAACAAG"
 },
 {
  "label": "a.t_motifs_m290_AT3G10500", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m290_AT3G10500_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m290_AT3G10500_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m290_AT3G10500_logo.png",
 "name" : "AT3G10500",
 "ic" : "12.90",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "WCTTGYTCYMCAAGAAA"
 } 
 ] 
 },
 {
  "consensus" : "TwrCKTGtdbyaCAMG",
 "branch" : 27,
 "id" : "cluster_11_node_27",
 "ic" : "9.89",
 "size" : 26,
 "name" : "cluster_11_node_27_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_27_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_27_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TwrCKTGydgyaCAMG",
 "branch" : 20,
 "id" : "cluster_11_node_20",
 "ic" : "10.06",
 "size" : 26,
 "name" : "cluster_11_node_20_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_20_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_20_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TwrCKTGtdyyaCAMG",
 "branch" : 14,
 "id" : "cluster_11_node_14",
 "ic" : "10.09",
 "size" : 26,
 "name" : "cluster_11_node_14_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_14_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_14_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TtrCTTGttcyaCAmG",
 "branch" : 12,
 "id" : "cluster_11_node_12",
 "ic" : "10.22",
 "size" : 26,
 "name" : "cluster_11_node_12_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_12_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_12_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TtrCTTgttyhaCAmG",
 "branch" : 6,
 "id" : "cluster_11_node_6",
 "ic" : "10.12",
 "size" : 26,
 "name" : "cluster_11_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m275_AT3G03200", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m275_AT3G03200_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m275_AT3G03200_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m275_AT3G03200_logo.png",
 "name" : "AT3G03200",
 "ic" : "10.26",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTRCTTSWWCYWCAMG"
 },
 {
  "label": "a.t_motifs_m306_AT3G15170", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m306_AT3G15170_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m306_AT3G15170_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m306_AT3G15170_logo.png",
 "name" : "AT3G15170",
 "ic" : "10.28",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTACKTGTTYHACAMG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m73_AT1G32870", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m73_AT1G32870_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m73_AT1G32870_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m73_AT1G32870_logo.png",
 "name" : "AT1G32870",
 "ic" : "11.33",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTRCTTGYTCYSCAAG"
 } 
 ] 
 },
 {
  "consensus" : "TwrCkTGyddyaCAAG",
 "branch" : 10,
 "id" : "cluster_11_node_10",
 "ic" : "10.41",
 "size" : 26,
 "name" : "cluster_11_node_10_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_10_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_10_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m288_AT3G10480", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m288_AT3G10480_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m288_AT3G10480_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m288_AT3G10480_logo.png",
 "name" : "AT3G10480",
 "ic" : "11.74",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWACKTGYDWYRCAAG"
 },
 {
  "consensus" : "TwrCkTGtdkmaCAMG",
 "branch" : 9,
 "id" : "cluster_11_node_9",
 "ic" : "10.07",
 "size" : 26,
 "name" : "cluster_11_node_9_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_9_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_9_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m118_AT1G65910", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m118_AT1G65910_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m118_AT1G65910_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m118_AT1G65910_logo.png",
 "name" : "AT1G65910",
 "ic" : "10.07",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWRCKTGHRRMASAAG"
 },
 {
  "label": "a.t_motifs_m314_AT3G18400", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m314_AT3G18400_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m314_AT3G18400_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m314_AT3G18400_logo.png",
 "name" : "AT3G18400",
 "ic" : "10.48",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWRCKTGTKKYACAMG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m39_AT1G19040", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m39_AT1G19040_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m39_AT1G19040_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m39_AT1G19040_logo.png",
 "name" : "AT1G19040",
 "ic" : "11.38",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CTTGYKCYSCAAGYWW"
 } 
 ] 
 },
 {
  "consensus" : "TTgCTTswwyytyAmG",
 "branch" : 8,
 "id" : "cluster_11_node_8",
 "ic" : "10.54",
 "size" : 26,
 "name" : "cluster_11_node_8_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_8_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_8_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m611_AT5G66300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m611_AT5G66300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m611_AT5G66300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m611_AT5G66300_logo.png",
 "name" : "AT5G66300",
 "ic" : "10.65",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTGCTTSWWYTTYAMG"
 },
 {
  "label": "a.t_motifs_m556_AT5G46590", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m556_AT5G46590_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m556_AT5G46590_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m556_AT5G46590_logo.png",
 "name" : "AT5G46590",
 "ic" : "10.82",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTRCTTSWTYYTYAMG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m263_AT2G46770", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m263_AT2G46770_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m263_AT2G46770_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m263_AT2G46770_logo.png",
 "name" : "AT2G46770",
 "ic" : "9.79",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCKTGWWWTTYAMGYWA"
 } 
 ] 
 },
 {
  "consensus" : "wmCTTvttyaayAAGt",
 "branch" : 37,
 "id" : "cluster_11_node_37",
 "ic" : "10.50",
 "size" : 26,
 "name" : "cluster_11_node_37_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_37_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_37_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aCTTsttyhayAAGt",
 "branch" : 22,
 "id" : "cluster_11_node_22",
 "ic" : "10.89",
 "size" : 26,
 "name" : "cluster_11_node_22_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_22_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_22_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m6_AT1G02230", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m6_AT1G02230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m6_AT1G02230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m6_AT1G02230_logo.png",
 "name" : "AT1G02230",
 "ic" : "11.04",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "ACTTRYWRARSAAG"
 },
 {
  "label": "a.t_motifs_m392_AT4G01540", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m392_AT4G01540_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m392_AT4G01540_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m392_AT4G01540_logo.png",
 "name" : "AT4G01540",
 "ic" : "10.75",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "ACTTRDKRAASAAGT"
 } 
 ] 
 },
 {
  "consensus" : "wmCTTmwtcacyAAG",
 "branch" : 21,
 "id" : "cluster_11_node_21",
 "ic" : "9.68",
 "size" : 26,
 "name" : "cluster_11_node_21_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_21_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_21_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m353_AT3G49530", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m353_AT3G49530_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m353_AT3G49530_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m353_AT3G49530_logo.png",
 "name" : "AT3G49530",
 "ic" : "10.66",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TMCTTMATMRSYAAG"
 },
 {
  "label": "a.t_motifs_m393_AT4G01550", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m393_AT4G01550_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m393_AT4G01550_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m393_AT4G01550_logo.png",
 "name" : "AT4G01550",
 "ic" : "9.89",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CTTRTTRAASAAGKW"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "rTwrCkTGtdwwacAmGywAyc",
 "branch" : 42,
 "id" : "cluster_11_node_42",
 "ic" : "11.07",
 "size" : 26,
 "name" : "cluster_11_node_42_15motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_42_15motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_42_15motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rTwrCkTGwddwacAmGywAyc",
 "branch" : 36,
 "id" : "cluster_11_node_36",
 "ic" : "11.36",
 "size" : 26,
 "name" : "cluster_11_node_36_13motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_36_13motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_36_13motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rTwrCkTgwdwwwyAmGywAyc",
 "branch" : 34,
 "id" : "cluster_11_node_34",
 "ic" : "11.29",
 "size" : 26,
 "name" : "cluster_11_node_34_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_34_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_34_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TTgCKTgwwwtwyAmGywAyc",
 "branch" : 13,
 "id" : "cluster_11_node_13",
 "ic" : "11.57",
 "size" : 26,
 "name" : "cluster_11_node_13_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_13_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_13_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TTgCKTgwwwtwyAmGywAyc",
 "branch" : 4,
 "id" : "cluster_11_node_4",
 "ic" : "11.52",
 "size" : 26,
 "name" : "cluster_11_node_4_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_4_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_4_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TtrCKTgwwwtwyAMGywAyc",
 "branch" : 1,
 "id" : "cluster_11_node_1",
 "ic" : "11.56",
 "size" : 26,
 "name" : "cluster_11_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m167_AT1G79580", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m167_AT1G79580_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m167_AT1G79580_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m167_AT1G79580_logo.png",
 "name" : "AT1G79580",
 "ic" : "11.40",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTRCKTGWDWYWYAMGYWAYC"
 },
 {
  "label": "a.t_motifs_m399_AT4G10350", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m399_AT4G10350_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m399_AT4G10350_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m399_AT4G10350_logo.png",
 "name" : "AT4G10350",
 "ic" : "11.82",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTRCKTGWWWTWYAMGYWAYC"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m598_AT5G62380", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m598_AT5G62380_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m598_AT5G62380_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m598_AT5G62380_logo.png",
 "name" : "AT5G62380",
 "ic" : "11.69",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "GRWWRCKTRAAWWWCAMGCAA"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m108_AT1G54330", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m108_AT1G54330_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m108_AT1G54330_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m108_AT1G54330_logo.png",
 "name" : "AT1G54330",
 "ic" : "12.77",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "GRTWRCKTGTDRAACAMGYAA"
 } 
 ] 
 },
 {
  "consensus" : "rTwrCkTGtrdaacAMGhaAyc",
 "branch" : 28,
 "id" : "cluster_11_node_28",
 "ic" : "12.01",
 "size" : 26,
 "name" : "cluster_11_node_28_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_28_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_28_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rTwrCKTGtrdaacAmGyaAhc",
 "branch" : 17,
 "id" : "cluster_11_node_17",
 "ic" : "12.33",
 "size" : 26,
 "name" : "cluster_11_node_17_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_17_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_17_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m278_AT3G04060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m278_AT3G04060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m278_AT3G04060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m278_AT3G04060_logo.png",
 "name" : "AT3G04060",
 "ic" : "12.36",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "GDTTRCKTGTKYYACAMGYWA"
 },
 {
  "label": "a.t_motifs_m491_AT5G07680", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m491_AT5G07680_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m491_AT5G07680_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m491_AT5G07680_logo.png",
 "name" : "AT5G07680",
 "ic" : "12.16",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "DTTACKTGTTMYACAMGYWAY"
 } 
 ] 
 },
 {
  "consensus" : "rTwrCKTGyrkywsAAGmAAc",
 "branch" : 23,
 "id" : "cluster_11_node_23",
 "ic" : "12.44",
 "size" : 26,
 "name" : "cluster_11_node_23_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_23_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_23_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m289_AT3G10490", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m289_AT3G10490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m289_AT3G10490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m289_AT3G10490_logo.png",
 "name" : "AT3G10490",
 "ic" : "11.58",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWRCKTGYKKBCCAAGAAAC"
 },
 {
  "label": "a.t_motifs_m70_AT1G32510", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m70_AT1G32510_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m70_AT1G32510_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m70_AT1G32510_logo.png",
 "name" : "AT1G32510",
 "ic" : "13.75",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTTGCTTSWRHYRCAAGYWAY"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "TwrCKTGtrdhaCAmGyaAy",
 "branch" : 33,
 "id" : "cluster_11_node_33",
 "ic" : "11.51",
 "size" : 26,
 "name" : "cluster_11_node_33_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_33_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_33_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TwrCkTGtrdhacAmGyaA",
 "branch" : 26,
 "id" : "cluster_11_node_26",
 "ic" : "11.33",
 "size" : 26,
 "name" : "cluster_11_node_26_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_26_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_26_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TwrCKTRtrdwacAmGtaA",
 "branch" : 16,
 "id" : "cluster_11_node_16",
 "ic" : "11.24",
 "size" : 26,
 "name" : "cluster_11_node_16_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_16_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_16_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TwrCGTrtrraacAmGyAA",
 "branch" : 7,
 "id" : "cluster_11_node_7",
 "ic" : "11.67",
 "size" : 26,
 "name" : "cluster_11_node_7_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_7_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_7_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m518_AT5G18270", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m518_AT5G18270_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m518_AT5G18270_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m518_AT5G18270_logo.png",
 "name" : "AT5G18270",
 "ic" : "12.22",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWACKTGTKYYACAMGYWA"
 },
 {
  "label": "a.t_motifs_m505_AT5G13180", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m505_AT5G13180_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m505_AT5G13180_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m505_AT5G13180_logo.png",
 "name" : "AT5G13180",
 "ic" : "11.48",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWRCGTRWAWWACAMGYAA"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m207_AT2G24430", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m207_AT2G24430_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m207_AT2G24430_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m207_AT2G24430_logo.png",
 "name" : "AT2G24430",
 "ic" : "9.93",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWCKTGTWMHACAMGYWA"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m313_AT3G17730", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m313_AT3G17730_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m313_AT3G17730_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m313_AT3G17730_logo.png",
 "name" : "AT3G17730",
 "ic" : "10.06",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TRCKTGTDMYACAMGYW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m156_AT1G76420", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m156_AT1G76420_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m156_AT1G76420_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m156_AT1G76420_logo.png",
 "name" : "AT1G76420",
 "ic" : "10.92",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "RTTRCKTGTTYYWYACGY"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "TwaCTTgttywaCAAGTTwyc",
 "branch" : 38,
 "id" : "cluster_11_node_38",
 "ic" : "11.88",
 "size" : 26,
 "name" : "cluster_11_node_38_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_38_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_38_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m7_AT1G02250", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m7_AT1G02250_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m7_AT1G02250_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m7_AT1G02250_logo.png",
 "name" : "AT1G02250",
 "ic" : "11.88",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWACTTRTWRAASAAGYWA"
 },
 {
  "label": "a.t_motifs_m603_AT5G64060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m603_AT5G64060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m603_AT5G64060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m603_AT5G64060_logo.png",
 "name" : "AT5G64060",
 "ic" : "13.10",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TDACTTGYWCMVCAAGTTWYC"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m211_AT2G27300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m211_AT2G27300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m211_AT2G27300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m211_AT2G27300_logo.png",
 "name" : "AT2G27300",
 "ic" : "10.60",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWCYTSARRRWGAAGRAAM"
 } 
 ] 
 },
 {
  "consensus" : "rrtkmCGTrwwwwwywcGyhwyctt",
 "branch" : 48,
 "id" : "cluster_11_node_48",
 "ic" : "8.24",
 "size" : 26,
 "name" : "cluster_11_node_48_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_48_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_48_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ygCCGTrwhhtyymCGbyry",
 "branch" : 30,
 "id" : "cluster_11_node_30",
 "ic" : "9.42",
 "size" : 26,
 "name" : "cluster_11_node_30_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_30_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_30_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m246_AT2G43000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m246_AT2G43000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m246_AT2G43000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m246_AT2G43000_logo.png",
 "name" : "AT2G43000",
 "ic" : "9.11",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "RYRRCGKRRADDWYACGGCR"
 },
 {
  "consensus" : "ygcCGTrwhytycMCGby",
 "branch" : 25,
 "id" : "cluster_11_node_25",
 "ic" : "9.24",
 "size" : 26,
 "name" : "cluster_11_node_25_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_25_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_25_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m545_AT5G39820", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m545_AT5G39820_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m545_AT5G39820_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m545_AT5G39820_logo.png",
 "name" : "AT5G39820",
 "ic" : "9.35",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "RVCGTGRARRWYACGGCR"
 },
 {
  "label": "a.t_motifs_m301_AT3G12910", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m301_AT3G12910_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m301_AT3G12910_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m301_AT3G12910_logo.png",
 "name" : "AT3G12910",
 "ic" : "9.73",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "MCGKCRWHTYYMCGSCR"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "rrTkaCGTrwwdwaywyGwmwwctt",
 "branch" : 44,
 "id" : "cluster_11_node_44",
 "ic" : "9.17",
 "size" : 26,
 "name" : "cluster_11_node_44_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_44_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_44_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rrTkaCGTrwwdwaywmGaww",
 "branch" : 29,
 "id" : "cluster_11_node_29",
 "ic" : "8.81",
 "size" : 26,
 "name" : "cluster_11_node_29_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_11_node_29_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_11_node_29_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m102_AT1G52880", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m102_AT1G52880_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m102_AT1G52880_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m102_AT1G52880_logo.png",
 "name" : "AT1G52880",
 "ic" : "8.60",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TKACGTRTWWWWYACGHWW"
 },
 {
  "label": "a.t_motifs_m309_AT3G15500", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m309_AT3G15500_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m309_AT3G15500_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m309_AT3G15500_logo.png",
 "name" : "AT3G15500",
 "ic" : "8.96",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "RRWKMCGTRWWDWAYWHGAMW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m4_AT1G01720", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m4_AT1G01720_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m4_AT1G01720_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m4_AT1G01720_logo.png",
 "name" : "AT1G01720",
 "ic" : "7.70",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAGWWKMCRWRTYMWWYACGTM"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 300; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_11").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C76342");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_11"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C76342"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_11" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C76342")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_11").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_11").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_11").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_11").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 17;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_12").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wwdtCCGTACaawtww",
 "branch" : 14,
 "id" : "cluster_12_node_14",
 "ic" : "8.50",
 "size" : 16,
 "name" : "cluster_12",
 "image" : "matrix-clustering_aligned_logos/cluster_12_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_logo_rc.png",

  "children": [
  {
  "consensus" : "wwdtCCGTACaawtww",
 "branch" : 13,
 "id" : "cluster_12_node_13",
 "ic" : "8.71",
 "size" : 16,
 "name" : "cluster_12_node_13_13motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_13_13motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_13_13motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wawwaAGTACAawwww",
 "branch" : 12,
 "id" : "cluster_12_node_12",
 "ic" : "9.07",
 "size" : 16,
 "name" : "cluster_12_node_12_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_12_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_12_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m54_AT1G27360", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m54_AT1G27360_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m54_AT1G27360_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m54_AT1G27360_logo.png",
 "name" : "AT1G27360",
 "ic" : "7.99",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTGTACTKWHT"
 },
 {
  "label": "a.t_motifs_m5_AT1G02065", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m5_AT1G02065_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m5_AT1G02065_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m5_AT1G02065_logo.png",
 "name" : "AT1G02065",
 "ic" : "8.83",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWWRWRGTACRWWWWW"
 } 
 ] 
 },
 {
  "consensus" : "ydtCCGTACaawth",
 "branch" : 11,
 "id" : "cluster_12_node_11",
 "ic" : "8.44",
 "size" : 16,
 "name" : "cluster_12_node_11_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_11_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_11_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ktCCGTACrga",
 "branch" : 10,
 "id" : "cluster_12_node_10",
 "ic" : "8.00",
 "size" : 16,
 "name" : "cluster_12_node_10_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_10_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_10_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "krcCGTACgga",
 "branch" : 9,
 "id" : "cluster_12_node_9",
 "ic" : "6.90",
 "size" : 16,
 "name" : "cluster_12_node_9_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_9_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_9_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "krcCGTACgv",
 "branch" : 5,
 "id" : "cluster_12_node_5",
 "ic" : "5.51",
 "size" : 16,
 "name" : "cluster_12_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m104_AT1G53160", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m104_AT1G53160_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m104_AT1G53160_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m104_AT1G53160_logo.png",
 "name" : "AT1G53160",
 "ic" : "6.20",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "DDCCGTACDM"
 },
 {
  "label": "a.t_motifs_m521_AT5G18830", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m521_AT5G18830_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m521_AT5G18830_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m521_AT5G18830_logo.png",
 "name" : "AT5G18830",
 "ic" : "6.00",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "BRYCGTACGG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m265_AT2G47070", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m265_AT2G47070_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m265_AT2G47070_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m265_AT2G47070_logo.png",
 "name" : "AT2G47070",
 "ic" : "10.19",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "TCCGTACGGH"
 } 
 ] 
 },
 {
  "consensus" : "tCCGTACa",
 "branch" : 3,
 "id" : "cluster_12_node_3",
 "ic" : "8.09",
 "size" : 16,
 "name" : "cluster_12_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m375_AT3G60030", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m375_AT3G60030_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m375_AT3G60030_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m375_AT3G60030_logo.png",
 "name" : "AT3G60030",
 "ic" : "5.16",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "DYCGTACW"
 },
 {
  "label": "a.t_motifs_m222_AT2G33810", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m222_AT2G33810_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m222_AT2G33810_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m222_AT2G33810_logo.png",
 "name" : "AT2G33810",
 "ic" : "8.83",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGTACGGA"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "ydtCCGTACaawth",
 "branch" : 7,
 "id" : "cluster_12_node_7",
 "ic" : "8.53",
 "size" : 16,
 "name" : "cluster_12_node_7_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_7_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_7_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dtCCGTACaawt",
 "branch" : 6,
 "id" : "cluster_12_node_6",
 "ic" : "8.30",
 "size" : 16,
 "name" : "cluster_12_node_6_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_6_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_6_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwcmGTACaat",
 "branch" : 2,
 "id" : "cluster_12_node_2",
 "ic" : "7.35",
 "size" : 16,
 "name" : "cluster_12_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m242_AT2G42200", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m242_AT2G42200_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m242_AT2G42200_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m242_AT2G42200_logo.png",
 "name" : "AT2G42200",
 "ic" : "7.03",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWMMGTACAWT"
 },
 {
  "label": "a.t_motifs_m568_AT5G50570", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m568_AT5G50570_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m568_AT5G50570_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m568_AT5G50570_logo.png",
 "name" : "AT5G50570",
 "ic" : "8.01",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "DWCCGTACAAW"
 } 
 ] 
 },
 {
  "consensus" : "dTCCGTACaawt",
 "branch" : 4,
 "id" : "cluster_12_node_4",
 "ic" : "9.41",
 "size" : 16,
 "name" : "cluster_12_node_4_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_4_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_4_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m45_AT1G20980", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m45_AT1G20980_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m45_AT1G20980_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m45_AT1G20980_logo.png",
 "name" : "AT1G20980",
 "ic" : "8.82",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWTTGTACGGA"
 },
 {
  "consensus" : "dTCCGTACaawt",
 "branch" : 1,
 "id" : "cluster_12_node_1",
 "ic" : "9.69",
 "size" : 16,
 "name" : "cluster_12_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m308_AT3G15270", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m308_AT3G15270_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m308_AT3G15270_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m308_AT3G15270_logo.png",
 "name" : "AT3G15270",
 "ic" : "10.30",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "DTCCGTACRRTT"
 },
 {
  "label": "a.t_motifs_m558_AT5G46830", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m558_AT5G46830_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m558_AT5G46830_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m558_AT5G46830_logo.png",
 "name" : "AT5G46830",
 "ic" : "9.27",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "RTCCGTACAAWT"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m371_AT3G57920", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m371_AT3G57920_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m371_AT3G57920_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m371_AT3G57920_logo.png",
 "name" : "AT3G57920",
 "ic" : "10.33",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "YKTCCGTACAATTH"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "WYCTCGTACh",
 "branch" : 8,
 "id" : "cluster_12_node_8",
 "ic" : "9.86",
 "size" : 16,
 "name" : "cluster_12_node_8_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_12_node_8_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_12_node_8_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m365_AT3G54990", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m365_AT3G54990_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m365_AT3G54990_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m365_AT3G54990_logo.png",
 "name" : "AT3G54990",
 "ic" : "9.27",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTACGAGR"
 },
 {
  "label": "a.t_motifs_m212_AT2G28550", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m212_AT2G28550_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m212_AT2G28550_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m212_AT2G28550_logo.png",
 "name" : "AT2G28550",
 "ic" : "9.72",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "DGTACGAGGW"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_12").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BE6557");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_12"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BE6557"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_12" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BE6557")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_12").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_12").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_12").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_12").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 5;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_13").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "ttdkCmACTTGcaw",
 "branch" : 2,
 "id" : "cluster_13_node_2",
 "ic" : "9.66",
 "size" : 14,
 "name" : "cluster_13",
 "image" : "matrix-clustering_aligned_logos/cluster_13_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_13_logo_rc.png",

  "children": [
  {
  "consensus" : "wkCmACTTGCa",
 "branch" : 1,
 "id" : "cluster_13_node_1",
 "ic" : "9.83",
 "size" : 14,
 "name" : "cluster_13_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_13_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_13_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m79_AT1G35460", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m79_AT1G35460_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m79_AT1G35460_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m79_AT1G35460_logo.png",
 "name" : "AT1G35460",
 "ic" : "10.04",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "WGCMACTTGCA"
 },
 {
  "label": "a.t_motifs_m243_AT2G42280", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m243_AT2G42280_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m243_AT2G42280_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m243_AT2G42280_logo.png",
 "name" : "AT2G42280",
 "ic" : "9.36",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "KGCAAGTKGMH"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m97_AT1G51140", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m97_AT1G51140_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m97_AT1G51140_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m97_AT1G51140_logo.png",
 "name" : "AT1G51140",
 "ic" : "9.36",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "WKGCAAGTKGMHAA"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_13").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B3686A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_13"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B3686A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_13" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B3686A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_13").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_13").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_13").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_13").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 20;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_14").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "dGTGGGgmCCAChwshwatgkwkkkmyyay",
 "branch" : 17,
 "id" : "cluster_14_node_17",
 "ic" : "9.94",
 "size" : 30,
 "name" : "cluster_14",
 "image" : "matrix-clustering_aligned_logos/cluster_14_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_logo_rc.png",

  "children": [
  {
  "consensus" : "wgTgGGgmCCAChw",
 "branch" : 16,
 "id" : "cluster_14_node_16",
 "ic" : "8.83",
 "size" : 30,
 "name" : "cluster_14_node_16_14motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_16_14motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_16_14motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wgTgGGgmCCAChw",
 "branch" : 14,
 "id" : "cluster_14_node_14",
 "ic" : "8.82",
 "size" : 30,
 "name" : "cluster_14_node_14_12motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_14_12motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_14_12motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wgTgGGgmCCAChw",
 "branch" : 13,
 "id" : "cluster_14_node_13",
 "ic" : "8.81",
 "size" : 30,
 "name" : "cluster_14_node_13_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_13_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_13_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GTGGGrCCCAc",
 "branch" : 12,
 "id" : "cluster_14_node_12",
 "ic" : "9.47",
 "size" : 30,
 "name" : "cluster_14_node_12_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_12_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_12_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GTGGGrCCCAc",
 "branch" : 9,
 "id" : "cluster_14_node_9",
 "ic" : "9.87",
 "size" : 30,
 "name" : "cluster_14_node_9_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_9_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_9_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GTkGGGwCCAC",
 "branch" : 4,
 "id" : "cluster_14_node_4",
 "ic" : "10.51",
 "size" : 30,
 "name" : "cluster_14_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m342_AT3G45150", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m342_AT3G45150_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m342_AT3G45150_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m342_AT3G45150_logo.png",
 "name" : "AT3G45150",
 "ic" : "10.97",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTGGRCCCMAC"
 },
 {
  "label": "a.t_motifs_m492_AT5G08070", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m492_AT5G08070_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m492_AT5G08070_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m492_AT5G08070_logo.png",
 "name" : "AT5G08070",
 "ic" : "11.05",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTGGGGACCAC"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m528_AT5G23280", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m528_AT5G23280_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m528_AT5G23280_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m528_AT5G23280_logo.png",
 "name" : "AT5G23280",
 "ic" : "10.76",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RTGGGYCCCAC"
 } 
 ] 
 },
 {
  "consensus" : "gTGGgcCCmm",
 "branch" : 7,
 "id" : "cluster_14_node_7",
 "ic" : "5.67",
 "size" : 30,
 "name" : "cluster_14_node_7_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_7_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_7_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m414_AT4G18390", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m414_AT4G18390_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m414_AT4G18390_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m414_AT4G18390_logo.png",
 "name" : "AT4G18390",
 "ic" : "5.73",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTGGKMCCAC"
 },
 {
  "label": "a.t_motifs_m570_AT5G51910", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m570_AT5G51910_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m570_AT5G51910_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m570_AT5G51910_logo.png",
 "name" : "AT5G51910",
 "ic" : "6.87",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTGGGSCCCA"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "wgTgGGgmCCAChw",
 "branch" : 11,
 "id" : "cluster_14_node_11",
 "ic" : "8.81",
 "size" : 30,
 "name" : "cluster_14_node_11_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_11_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_11_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rtkGGGACCAChw",
 "branch" : 6,
 "id" : "cluster_14_node_6",
 "ic" : "10.39",
 "size" : 30,
 "name" : "cluster_14_node_6_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_6_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_6_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rtkGGGACCACww",
 "branch" : 3,
 "id" : "cluster_14_node_3",
 "ic" : "10.59",
 "size" : 30,
 "name" : "cluster_14_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m106_AT1G53230", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m106_AT1G53230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m106_AT1G53230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m106_AT1G53230_logo.png",
 "name" : "AT1G53230",
 "ic" : "10.55",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WDGTGGTCCCMAY"
 },
 {
  "label": "a.t_motifs_m272_AT3G02150", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m272_AT3G02150_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m272_AT3G02150_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m272_AT3G02150_logo.png",
 "name" : "AT3G02150",
 "ic" : "11.74",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWGTGGTCCCCAC"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m64_AT1G30210", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m64_AT1G30210_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m64_AT1G30210_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m64_AT1G30210_logo.png",
 "name" : "AT1G30210",
 "ic" : "10.19",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "DGTGGTCCCMAY"
 } 
 ] 
 },
 {
  "consensus" : "wGTGGGkCCCAChw",
 "branch" : 8,
 "id" : "cluster_14_node_8",
 "ic" : "9.57",
 "size" : 30,
 "name" : "cluster_14_node_8_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_8_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_8_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m494_AT5G08330", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m494_AT5G08330_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m494_AT5G08330_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m494_AT5G08330_logo.png",
 "name" : "AT5G08330",
 "ic" : "10.29",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "WDGTGGGKCCCACW"
 },
 {
  "consensus" : "gTGGGkCCCACmw",
 "branch" : 1,
 "id" : "cluster_14_node_1",
 "ic" : "10.30",
 "size" : 30,
 "name" : "cluster_14_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m136_AT1G69690", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m136_AT1G69690_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m136_AT1G69690_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m136_AT1G69690_logo.png",
 "name" : "AT1G69690",
 "ic" : "10.25",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTGGGKCCCACMW"
 },
 {
  "label": "a.t_motifs_m142_AT1G72010", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m142_AT1G72010_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m142_AT1G72010_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m142_AT1G72010_logo.png",
 "name" : "AT1G72010",
 "ic" : "10.51",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RTGGGKCCCACWW"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m80_AT1G35560", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m80_AT1G35560_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m80_AT1G35560_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m80_AT1G35560_logo.png",
 "name" : "AT1G35560",
 "ic" : "11.26",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGTGGGCCCC"
 } 
 ] 
 },
 {
  "consensus" : "GGGACCAC",
 "branch" : 2,
 "id" : "cluster_14_node_2",
 "ic" : "10.05",
 "size" : 30,
 "name" : "cluster_14_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m589_AT5G60970", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m589_AT5G60970_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m589_AT5G60970_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m589_AT5G60970_logo.png",
 "name" : "AT5G60970",
 "ic" : "10.53",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RTGGTCCC"
 },
 {
  "label": "a.t_motifs_m305_AT3G15030", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m305_AT3G15030_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m305_AT3G15030_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m305_AT3G15030_logo.png",
 "name" : "AT3G15030",
 "ic" : "10.03",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTGGTCCC"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "kGTGGGhCCCACrwshwatgkwkkkmyyay",
 "branch" : 15,
 "id" : "cluster_14_node_15",
 "ic" : "11.79",
 "size" : 30,
 "name" : "cluster_14_node_15_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_15_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_15_4motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m122_AT1G67260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m122_AT1G67260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m122_AT1G67260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m122_AT1G67260_logo.png",
 "name" : "AT1G67260",
 "ic" : "12.32",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "RTRRKMMMRASWGRRGAGGKGGGRCCCACW"
 },
 {
  "consensus" : "kGTGGGhCCCACrwshwatgkw",
 "branch" : 10,
 "id" : "cluster_14_node_10",
 "ic" : "11.29",
 "size" : 30,
 "name" : "cluster_14_node_10_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_10_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_10_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "GTGGGyCCCACmwkythtktw",
 "branch" : 5,
 "id" : "cluster_14_node_5",
 "ic" : "11.28",
 "size" : 30,
 "name" : "cluster_14_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_14_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_14_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m350_AT3G47620", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m350_AT3G47620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m350_AT3G47620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m350_AT3G47620_logo.png",
 "name" : "AT3G47620",
 "ic" : "16.57",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTGGGYCCCACMYSCTHTBT"
 },
 {
  "label": "a.t_motifs_m336_AT3G27010", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m336_AT3G27010_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m336_AT3G27010_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m336_AT3G27010_logo.png",
 "name" : "AT3G27010",
 "ic" : "11.05",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTGGGYCCCACHWKYTHTTTW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m256_AT2G45680", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m256_AT2G45680_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m256_AT2G45680_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m256_AT2G45680_logo.png",
 "name" : "AT2G45680",
 "ic" : "13.17",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KGTGGGACCCACRRCWAATGG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_14").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A66A7E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_14"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A66A7E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_14" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A66A7E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_14").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_14").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_14").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_14").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 8;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_15").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "rsCGraAAwtyCGsmrrarw",
 "branch" : 5,
 "id" : "cluster_15_node_5",
 "ic" : "7.70",
 "size" : 20,
 "name" : "cluster_15",
 "image" : "matrix-clustering_aligned_logos/cluster_15_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_15_logo_rc.png",

  "children": [
  {
  "consensus" : "sCGraAAwwyCGGarrarw",
 "branch" : 4,
 "id" : "cluster_15_node_4",
 "ic" : "7.93",
 "size" : 20,
 "name" : "cluster_15_node_4_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_15_node_4_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_15_node_4_5motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m253_AT2G45420", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m253_AT2G45420_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m253_AT2G45420_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m253_AT2G45420_logo.png",
 "name" : "AT2G45420",
 "ic" : "8.09",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "SCGGAAAWTCCGSMGRARW"
 },
 {
  "consensus" : "cCGraAAwwyCGGar",
 "branch" : 3,
 "id" : "cluster_15_node_3",
 "ic" : "7.78",
 "size" : 20,
 "name" : "cluster_15_node_3_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_15_node_3_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_15_node_3_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "CCggAAAwtccGGmr",
 "branch" : 1,
 "id" : "cluster_15_node_1",
 "ic" : "8.26",
 "size" : 20,
 "name" : "cluster_15_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_15_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_15_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m245_AT2G42430", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m245_AT2G42430_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m245_AT2G42430_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m245_AT2G42430_logo.png",
 "name" : "AT2G42430",
 "ic" : "7.91",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "YKCCGGAWTTTCCGG"
 },
 {
  "label": "a.t_motifs_m252_AT2G45410", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m252_AT2G45410_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m252_AT2G45410_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m252_AT2G45410_logo.png",
 "name" : "AT2G45410",
 "ic" : "8.80",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "YTCCGGAWTTTCCGG"
 } 
 ] 
 },
 {
  "consensus" : "sCGAaAAwwtCGGar",
 "branch" : 2,
 "id" : "cluster_15_node_2",
 "ic" : "8.98",
 "size" : 20,
 "name" : "cluster_15_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_15_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_15_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m13_AT1G06280", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m13_AT1G06280_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m13_AT1G06280_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m13_AT1G06280_logo.png",
 "name" : "AT1G06280",
 "ic" : "7.82",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "CTCCGATWTYTTCGS"
 },
 {
  "label": "a.t_motifs_m124_AT1G68200", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m124_AT1G68200_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m124_AT1G68200_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m124_AT1G68200_logo.png",
 "name" : "AT1G68200",
 "ic" : "10.90",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "YTCCGAWWTTTTCGG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m334_AT3G26620", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m334_AT3G26620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m334_AT3G26620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m334_AT3G26620_logo.png",
 "name" : "AT3G26620",
 "ic" : "8.20",
 "size" : 20,
 "title" : "a.t_motifs",
 "consensus_rc" : "RGCGKRAAWTMCGCY"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_15").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#976C91");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_15"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#976C91"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_15" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#976C91")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_15").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_15").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_15").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_15").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 18;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_16").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "hwwwwycTTATCCwwwwhttwk",
 "branch" : 15,
 "id" : "cluster_16_node_15",
 "ic" : "9.97",
 "size" : 22,
 "name" : "cluster_16",
 "image" : "matrix-clustering_aligned_logos/cluster_16_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_logo_rc.png",

  "children": [
  {
  "consensus" : "hyyAwccTTATCCwwwwyttwk",
 "branch" : 12,
 "id" : "cluster_16_node_12",
 "ic" : "10.95",
 "size" : 22,
 "name" : "cluster_16_node_12_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_12_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_12_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m120_AT1G66420", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m120_AT1G66420_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m120_AT1G66420_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m120_AT1G66420_logo.png",
 "name" : "AT1G66420",
 "ic" : "11.89",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "MTAAKWWATGGATAAKGTT"
 },
 {
  "label": "a.t_motifs_m230_AT2G38090", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m230_AT2G38090_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m230_AT2G38090_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m230_AT2G38090_logo.png",
 "name" : "AT2G38090",
 "ic" : "11.38",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "HYYATYCTTATCYWWWHYTTT"
 } 
 ] 
 },
 {
  "consensus" : "hwwwwycTTATCYwwwwh",
 "branch" : 14,
 "id" : "cluster_16_node_14",
 "ic" : "9.42",
 "size" : 22,
 "name" : "cluster_16_node_14_14motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_14_14motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_14_14motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "hwwwwycTTATCywhwwh",
 "branch" : 11,
 "id" : "cluster_16_node_11",
 "ic" : "9.42",
 "size" : 22,
 "name" : "cluster_16_node_11_11motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_11_11motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_11_11motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwycTTATCywwwwh",
 "branch" : 10,
 "id" : "cluster_16_node_10",
 "ic" : "9.16",
 "size" : 22,
 "name" : "cluster_16_node_10_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_10_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_10_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwycTTATCcwwwwh",
 "branch" : 9,
 "id" : "cluster_16_node_9",
 "ic" : "9.03",
 "size" : 22,
 "name" : "cluster_16_node_9_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_9_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_9_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "awycTTATCywwwwh",
 "branch" : 7,
 "id" : "cluster_16_node_7",
 "ic" : "8.83",
 "size" : 22,
 "name" : "cluster_16_node_7_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_7_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_7_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwycTTATCCawwww",
 "branch" : 3,
 "id" : "cluster_16_node_3",
 "ic" : "9.60",
 "size" : 22,
 "name" : "cluster_16_node_3_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_3_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_3_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwycTTATCCAwwww",
 "branch" : 1,
 "id" : "cluster_16_node_1",
 "ic" : "9.77",
 "size" : 22,
 "name" : "cluster_16_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m592_AT5G61620", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m592_AT5G61620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m592_AT5G61620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m592_AT5G61620_logo.png",
 "name" : "AT5G61620",
 "ic" : "9.62",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWYYTTATCCAWWWW"
 },
 {
  "label": "a.t_motifs_m580_AT5G56840", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m580_AT5G56840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m580_AT5G56840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m580_AT5G56840_logo.png",
 "name" : "AT5G56840",
 "ic" : "10.11",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWWWTGGATAAGRTW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m291_AT3G10580", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m291_AT3G10580_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m291_AT3G10580_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m291_AT3G10580_logo.png",
 "name" : "AT3G10580",
 "ic" : "9.69",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "AWBCTTATCYWWWWT"
 } 
 ] 
 },
 {
  "consensus" : "awycTTATCytmwtm",
 "branch" : 5,
 "id" : "cluster_16_node_5",
 "ic" : "9.06",
 "size" : 22,
 "name" : "cluster_16_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m294_AT3G11280", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m294_AT3G11280_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m294_AT3G11280_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m294_AT3G11280_logo.png",
 "name" : "AT3G11280",
 "ic" : "8.99",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWDAAGATAAGRWT"
 },
 {
  "label": "a.t_motifs_m484_AT5G05790", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m484_AT5G05790_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m484_AT5G05790_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m484_AT5G05790_logo.png",
 "name" : "AT5G05790",
 "ic" : "9.11",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "KAWGARGATAAGRWT"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "wwycTTATCCAwww",
 "branch" : 4,
 "id" : "cluster_16_node_4",
 "ic" : "10.21",
 "size" : 22,
 "name" : "cluster_16_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m386_AT4G00250", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m386_AT4G00250_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m386_AT4G00250_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m386_AT4G00250_logo.png",
 "name" : "AT4G00250",
 "ic" : "9.95",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWTGGATAAGRWW"
 },
 {
  "label": "a.t_motifs_m38_AT1G19000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m38_AT1G19000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m38_AT1G19000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m38_AT1G19000_logo.png",
 "name" : "AT1G19000",
 "ic" : "10.23",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWYCTTATCCAWWW"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m495_AT5G08520", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m495_AT5G08520_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m495_AT5G08520_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m495_AT5G08520_logo.png",
 "name" : "AT5G08520",
 "ic" : "9.76",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCTTATCYWHWWH"
 } 
 ] 
 },
 {
  "consensus" : "hwwwwycTTATCywhw",
 "branch" : 8,
 "id" : "cluster_16_node_8",
 "ic" : "9.19",
 "size" : 22,
 "name" : "cluster_16_node_8_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_8_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_8_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m91_AT1G49010", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m91_AT1G49010_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m91_AT1G49010_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m91_AT1G49010_logo.png",
 "name" : "AT1G49010",
 "ic" : "8.91",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "DWRGATAAGRWWWWD"
 },
 {
  "consensus" : "wwwwycTTATCYwww",
 "branch" : 2,
 "id" : "cluster_16_node_2",
 "ic" : "9.30",
 "size" : 22,
 "name" : "cluster_16_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m562_AT5G47390", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m562_AT5G47390_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m562_AT5G47390_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m562_AT5G47390_logo.png",
 "name" : "AT5G47390",
 "ic" : "9.59",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWTGGATAAGRWWWW"
 },
 {
  "label": "a.t_motifs_m584_AT5G58900", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m584_AT5G58900_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m584_AT5G58900_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m584_AT5G58900_logo.png",
 "name" : "AT5G58900",
 "ic" : "9.56",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWWWYCTTATCYWWW"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "ryyTTATCCAww",
 "branch" : 13,
 "id" : "cluster_16_node_13",
 "ic" : "9.06",
 "size" : 22,
 "name" : "cluster_16_node_13_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_13_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_13_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yyTTATCCAww",
 "branch" : 6,
 "id" : "cluster_16_node_6",
 "ic" : "9.10",
 "size" : 22,
 "name" : "cluster_16_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_16_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_16_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m138_AT1G70000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m138_AT1G70000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m138_AT1G70000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m138_AT1G70000_logo.png",
 "name" : "AT1G70000",
 "ic" : "8.04",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "YVTTATCCAW"
 },
 {
  "label": "a.t_motifs_m150_AT1G74840", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m150_AT1G74840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m150_AT1G74840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m150_AT1G74840_logo.png",
 "name" : "AT1G74840",
 "ic" : "9.15",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYTTATCCAWW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m481_AT5G04760", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m481_AT5G04760_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m481_AT5G04760_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m481_AT5G04760_logo.png",
 "name" : "AT5G04760",
 "ic" : "7.73",
 "size" : 22,
 "title" : "a.t_motifs",
 "consensus_rc" : "RCCTTATCHR"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_16").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#856EA4");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_16"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#856EA4"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_16" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#856EA4")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_16").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_16").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_16").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_16").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 8;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_17").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "CATsATCmTCATCaTCaTCaTCaTCAT",
 "branch" : 5,
 "id" : "cluster_17_node_5",
 "ic" : "19.45",
 "size" : 27,
 "name" : "cluster_17",
 "image" : "matrix-clustering_aligned_logos/cluster_17_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_17_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m143_AT1G72050", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m143_AT1G72050_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m143_AT1G72050_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m143_AT1G72050_logo.png",
 "name" : "AT1G72050",
 "ic" : "11.89",
 "size" : 27,
 "title" : "a.t_motifs",
 "consensus_rc" : "GAGGAGGAGGAGGAGGARG"
 },
 {
  "consensus" : "CATsATCATCATCATCATCATCATCAT",
 "branch" : 4,
 "id" : "cluster_17_node_4",
 "ic" : "23.54",
 "size" : 27,
 "name" : "cluster_17_node_4_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_17_node_4_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_17_node_4_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "CATCATCATCATCATCATC",
 "branch" : 3,
 "id" : "cluster_17_node_3",
 "ic" : "16.79",
 "size" : 27,
 "name" : "",
 "image" : ".",
 "image_rc" : ".",

  "children": [
  {
  "consensus" : "TCATCATCATCATCAy",
 "branch" : 2,
 "id" : "cluster_17_node_2",
 "ic" : "14.82",
 "size" : 27,
 "name" : "cluster_17_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_17_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_17_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m318_AT3G21175", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m318_AT3G21175_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m318_AT3G21175_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m318_AT3G21175_logo.png",
 "name" : "AT3G21175",
 "ic" : "17.29",
 "size" : 27,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGATGATGATGATGA"
 },
 {
  "label": "a.t_motifs_m328_AT3G24050", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m328_AT3G24050_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m328_AT3G24050_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m328_AT3G24050_logo.png",
 "name" : "AT3G24050",
 "ic" : "9.95",
 "size" : 27,
 "title" : "a.t_motifs",
 "consensus_rc" : "CAYCAYCAYCAYCAY"
 } 
 ] 
 },
 {
  "consensus" : "CATCATCATCATCATCATC",
 "branch" : 1,
 "id" : "cluster_17_node_1",
 "ic" : "16.80",
 "size" : 27,
 "name" : "cluster_17_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_17_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_17_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m99_AT1G51600", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m99_AT1G51600_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m99_AT1G51600_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m99_AT1G51600_logo.png",
 "name" : "AT1G51600",
 "ic" : "18.20",
 "size" : 27,
 "title" : "a.t_motifs",
 "consensus_rc" : "GATGATGATGATGATGATG"
 },
 {
  "label": "a.t_motifs_m281_AT3G06740", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m281_AT3G06740_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m281_AT3G06740_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m281_AT3G06740_logo.png",
 "name" : "AT3G06740",
 "ic" : "16.53",
 "size" : 27,
 "title" : "a.t_motifs",
 "consensus_rc" : "GATGATGATGATGATGATS"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m566_AT5G49300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m566_AT5G49300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m566_AT5G49300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m566_AT5G49300_logo.png",
 "name" : "AT5G49300",
 "ic" : "24.94",
 "size" : 27,
 "title" : "a.t_motifs",
 "consensus_rc" : "ATGATGATGATGATGATGATGATSATG"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_17").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#7A6EB1");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_17"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#7A6EB1"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_17" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#7A6EB1")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_17").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_17").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_17").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_17").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 44;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_18").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "ddwkwddwddwrkTwGGTrrrrrwwdtrrwr",
 "branch" : 41,
 "id" : "cluster_18_node_41",
 "ic" : "8.14",
 "size" : 31,
 "name" : "cluster_18",
 "image" : "matrix-clustering_aligned_logos/cluster_18_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_logo_rc.png",

  "children": [
  {
  "consensus" : "dwddwrGTdGkTGrdrrwtdwrrwr",
 "branch" : 40,
 "id" : "cluster_18_node_40",
 "ic" : "7.83",
 "size" : 31,
 "name" : "cluster_18_node_40_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_40_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_40_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ddkgdgGTwGGTGrrddwdwwrrwr",
 "branch" : 33,
 "id" : "cluster_18_node_33",
 "ic" : "8.88",
 "size" : 31,
 "name" : "cluster_18_node_33_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_33_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_33_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ddkgkgGTTGGTGrrrdwdkwr",
 "branch" : 27,
 "id" : "cluster_18_node_27",
 "ic" : "9.08",
 "size" : 31,
 "name" : "cluster_18_node_27_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_27_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_27_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m166_AT1G79180", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m166_AT1G79180_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m166_AT1G79180_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m166_AT1G79180_logo.png",
 "name" : "AT1G79180",
 "ic" : "10.05",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "DKGKGGTWGGTGRRRDWRKWR"
 },
 {
  "label": "a.t_motifs_m37_AT1G18960", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m37_AT1G18960_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m37_AT1G18960_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m37_AT1G18960_logo.png",
 "name" : "AT1G18960",
 "ic" : "9.29",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "DDTRWTGTTGKTGWWDWTDTTR"
 } 
 ] 
 },
 {
  "consensus" : "wrGTwGGTrrrdrwdwwrrwr",
 "branch" : 7,
 "id" : "cluster_18_node_7",
 "ic" : "8.48",
 "size" : 31,
 "name" : "cluster_18_node_7_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_7_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_7_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m326_AT3G23250", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m326_AT3G23250_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m326_AT3G23250_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m326_AT3G23250_logo.png",
 "name" : "AT3G23250",
 "ic" : "8.40",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "KGGTWGGTGRRDRWDTTGRWG"
 },
 {
  "label": "a.t_motifs_m36_AT1G18570", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m36_AT1G18570_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m36_AT1G18570_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m36_AT1G18570_logo.png",
 "name" : "AT1G18570",
 "ic" : "9.12",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "WRGTWGGTRRRWDWWWWDDWD"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "dwrdwrGTrGTTGgkrrttr",
 "branch" : 36,
 "id" : "cluster_18_node_36",
 "ic" : "8.38",
 "size" : 31,
 "name" : "cluster_18_node_36_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_36_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_36_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wdwdkTrGkTGGtrGkTr",
 "branch" : 21,
 "id" : "cluster_18_node_21",
 "ic" : "9.12",
 "size" : 31,
 "name" : "cluster_18_node_21_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_21_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_21_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m149_AT1G74650", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m149_AT1G74650_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m149_AT1G74650_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m149_AT1G74650_logo.png",
 "name" : "AT1G74650",
 "ic" : "9.09",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "DKTRGKTGGKAGKTR"
 },
 {
  "label": "a.t_motifs_m599_AT5G62470", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m599_AT5G62470_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m599_AT5G62470_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m599_AT5G62470_logo.png",
 "name" : "AT5G62470",
 "ic" : "9.09",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YAACYACCAMCYAMHWHW"
 } 
 ] 
 },
 {
  "consensus" : "dwrdwGGTrGTTGrrrrwd",
 "branch" : 31,
 "id" : "cluster_18_node_31",
 "ic" : "8.48",
 "size" : 31,
 "name" : "cluster_18_node_31_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_31_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_31_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwrrwrGTrGTTGrrrawd",
 "branch" : 1,
 "id" : "cluster_18_node_1",
 "ic" : "9.39",
 "size" : 31,
 "name" : "cluster_18_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m349_AT3G47600", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m349_AT3G47600_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m349_AT3G47600_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m349_AT3G47600_logo.png",
 "name" : "AT3G47600",
 "ic" : "9.47",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "WHYYYYCAACYACYWHYHH"
 },
 {
  "label": "a.t_motifs_m18_AT1G08810", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m18_AT1G08810_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m18_AT1G08810_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m18_AT1G08810_logo.png",
 "name" : "AT1G08810",
 "ic" : "9.54",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWRRARGTRGTTGRRRWWD"
 } 
 ] 
 },
 {
  "consensus" : "gktGGTrGTTGrrrr",
 "branch" : 19,
 "id" : "cluster_18_node_19",
 "ic" : "8.05",
 "size" : 31,
 "name" : "cluster_18_node_19_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_19_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_19_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m338_AT3G28910", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m338_AT3G28910_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m338_AT3G28910_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m338_AT3G28910_logo.png",
 "name" : "AT3G28910",
 "ic" : "8.42",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "GKTGGTRGTTGGKRR"
 },
 {
  "label": "a.t_motifs_m394_AT4G01680", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m394_AT4G01680_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m394_AT4G01680_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m394_AT4G01680_logo.png",
 "name" : "AT4G01680",
 "ic" : "8.82",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "KGTGGTKGKTGRRR"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "ddwkwddwwdwrkTwGGTrrrmwwwyt",
 "branch" : 39,
 "id" : "cluster_18_node_39",
 "ic" : "8.67",
 "size" : 31,
 "name" : "cluster_18_node_39_32motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_39_32motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_39_32motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "twrawwaArTTAGGYAar",
 "branch" : 30,
 "id" : "cluster_18_node_30",
 "ic" : "10.20",
 "size" : 31,
 "name" : "cluster_18_node_30_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_30_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_30_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaaAArTTAGGTAar",
 "branch" : 12,
 "id" : "cluster_18_node_12",
 "ic" : "11.86",
 "size" : 31,
 "name" : "cluster_18_node_12_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_12_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_12_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m363_AT3G53200", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m363_AT3G53200_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m363_AT3G53200_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m363_AT3G53200_logo.png",
 "name" : "AT3G53200",
 "ic" : "12.72",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWTACCTAAYTTTTT"
 },
 {
  "label": "a.t_motifs_m270_AT3G01530", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m270_AT3G01530_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m270_AT3G01530_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m270_AT3G01530_logo.png",
 "name" : "AT3G01530",
 "ic" : "11.58",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "WAAAGTTAGGTARR"
 } 
 ] 
 },
 {
  "consensus" : "twrrwwwArTTAGGyad",
 "branch" : 25,
 "id" : "cluster_18_node_25",
 "ic" : "8.73",
 "size" : 31,
 "name" : "cluster_18_node_25_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_25_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_25_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aaawawAgTTAGGyad",
 "branch" : 15,
 "id" : "cluster_18_node_15",
 "ic" : "9.15",
 "size" : 31,
 "name" : "cluster_18_node_15_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_15_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_15_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m125_AT1G68320", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m125_AT1G68320_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m125_AT1G68320_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m125_AT1G68320_logo.png",
 "name" : "AT1G68320",
 "ic" : "8.94",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "HTRCCTAAYTWTWTT"
 },
 {
  "label": "a.t_motifs_m51_AT1G25340", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m51_AT1G25340_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m51_AT1G25340_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m51_AT1G25340_logo.png",
 "name" : "AT1G25340",
 "ic" : "9.52",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "WRCCTAACTWTTKTT"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m280_AT3G06490", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m280_AT3G06490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m280_AT3G06490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m280_AT3G06490_logo.png",
 "name" : "AT3G06490",
 "ic" : "8.52",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "RCCWAAYTTWWCYWA"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "ddwddkdwddwrkTwGGTrrrmwwwyt",
 "branch" : 38,
 "id" : "cluster_18_node_38",
 "ic" : "8.74",
 "size" : 31,
 "name" : "cluster_18_node_38_27motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_38_27motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_38_27motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ddwddwrkTwGGTrrrmwawyt",
 "branch" : 37,
 "id" : "cluster_18_node_37",
 "ic" : "8.60",
 "size" : 31,
 "name" : "cluster_18_node_37_25motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_37_25motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_37_25motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ddwwdwrkTwGGTrrrmwawyt",
 "branch" : 34,
 "id" : "cluster_18_node_34",
 "ic" : "8.80",
 "size" : 31,
 "name" : "cluster_18_node_34_22motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_34_22motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_34_22motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ddwwdwrkTwGGTrrrmwawyt",
 "branch" : 32,
 "id" : "cluster_18_node_32",
 "ic" : "8.82",
 "size" : 31,
 "name" : "cluster_18_node_32_16motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_32_16motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_32_16motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwrkTwGGTrarcwawyt",
 "branch" : 22,
 "id" : "cluster_18_node_22",
 "ic" : "8.88",
 "size" : 31,
 "name" : "cluster_18_node_22_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_22_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_22_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwrkTAGGTrarmwah",
 "branch" : 16,
 "id" : "cluster_18_node_16",
 "ic" : "9.07",
 "size" : 31,
 "name" : "cluster_18_node_16_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_16_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_16_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m577_AT5G54230", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m577_AT5G54230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m577_AT5G54230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m577_AT5G54230_logo.png",
 "name" : "AT5G54230",
 "ic" : "8.98",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWRKTWGGTRRRMWA"
 },
 {
  "label": "a.t_motifs_m435_AT4G28110", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m435_AT4G28110_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m435_AT4G28110_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m435_AT4G28110_logo.png",
 "name" : "AT4G28110",
 "ic" : "9.23",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "ARKTAGGTRAACWAH"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m273_AT3G02940", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m273_AT3G02940_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m273_AT3G02940_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m273_AT3G02940_logo.png",
 "name" : "AT3G02940",
 "ic" : "8.78",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "ARWTWGYYCACCWAMYWW"
 } 
 ] 
 },
 {
  "consensus" : "ddwwdwrkTwGGTrrrac",
 "branch" : 28,
 "id" : "cluster_18_node_28",
 "ic" : "8.36",
 "size" : 31,
 "name" : "cluster_18_node_28_13motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_28_13motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_28_13motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ddwddwGKTwGGTrrr",
 "branch" : 11,
 "id" : "cluster_18_node_11",
 "ic" : "8.48",
 "size" : 31,
 "name" : "cluster_18_node_11_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_11_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_11_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ddwddtGGTwGGTrrr",
 "branch" : 10,
 "id" : "cluster_18_node_10",
 "ic" : "8.85",
 "size" : 31,
 "name" : "cluster_18_node_10_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_10_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_10_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dwddtGGTwGGTrrr",
 "branch" : 5,
 "id" : "cluster_18_node_5",
 "ic" : "8.71",
 "size" : 31,
 "name" : "cluster_18_node_5_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_5_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_5_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m21_AT1G09540", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m21_AT1G09540_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m21_AT1G09540_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m21_AT1G09540_logo.png",
 "name" : "AT1G09540",
 "ic" : "8.40",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "DDKKTGGTWGKTRRR"
 },
 {
  "consensus" : "dwddtGGTwGGTGrr",
 "branch" : 4,
 "id" : "cluster_18_node_4",
 "ic" : "9.17",
 "size" : 31,
 "name" : "cluster_18_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m12_AT1G06180", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m12_AT1G06180_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m12_AT1G06180_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m12_AT1G06180_logo.png",
 "name" : "AT1G06180",
 "ic" : "9.36",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYCACCWACCMHHWH"
 },
 {
  "label": "a.t_motifs_m381_AT3G61250", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m381_AT3G61250_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m381_AT3G61250_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m381_AT3G61250_logo.png",
 "name" : "AT3G61250",
 "ic" : "9.38",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYYACCTACCWWHWW"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m300_AT3G12820", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m300_AT3G12820_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m300_AT3G12820_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m300_AT3G12820_logo.png",
 "name" : "AT3G12820",
 "ic" : "9.51",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYYACCWAMCHHWHHH"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m468_AT4G38620", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m468_AT4G38620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m468_AT4G38620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m468_AT4G38620_logo.png",
 "name" : "AT4G38620",
 "ic" : "8.10",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYYACCWAMYWWWWW"
 } 
 ] 
 },
 {
  "consensus" : "wwdwrkTWGGTrrrac",
 "branch" : 23,
 "id" : "cluster_18_node_23",
 "ic" : "8.39",
 "size" : 31,
 "name" : "cluster_18_node_23_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_23_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_23_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwwwrkTAGGTrrra",
 "branch" : 18,
 "id" : "cluster_18_node_18",
 "ic" : "8.46",
 "size" : 31,
 "name" : "cluster_18_node_18_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_18_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_18_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwwarkTAGGTrrra",
 "branch" : 17,
 "id" : "cluster_18_node_17",
 "ic" : "8.45",
 "size" : 31,
 "name" : "cluster_18_node_17_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_17_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_17_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "drrkTwGGTrrrr",
 "branch" : 2,
 "id" : "cluster_18_node_2",
 "ic" : "8.46",
 "size" : 31,
 "name" : "cluster_18_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m512_AT5G16600", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m512_AT5G16600_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m512_AT5G16600_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m512_AT5G16600_logo.png",
 "name" : "AT5G16600",
 "ic" : "9.63",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYTYACCWAMYWT"
 },
 {
  "label": "a.t_motifs_m597_AT5G62320", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m597_AT5G62320_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m597_AT5G62320_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m597_AT5G62320_logo.png",
 "name" : "AT5G62320",
 "ic" : "8.39",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "DRRKTWGGTRRRD"
 } 
 ] 
 },
 {
  "consensus" : "wwwwrkTAGGTrrra",
 "branch" : 14,
 "id" : "cluster_18_node_14",
 "ic" : "8.58",
 "size" : 31,
 "name" : "cluster_18_node_14_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_14_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_14_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwwrkTAGGTrrra",
 "branch" : 8,
 "id" : "cluster_18_node_8",
 "ic" : "8.54",
 "size" : 31,
 "name" : "cluster_18_node_8_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_8_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_8_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m340_AT3G30210", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m340_AT3G30210_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m340_AT3G30210_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m340_AT3G30210_logo.png",
 "name" : "AT3G30210",
 "ic" : "8.65",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYWTACCTAMCWWW"
 },
 {
  "consensus" : "wwwrkTAGGTrrra",
 "branch" : 6,
 "id" : "cluster_18_node_6",
 "ic" : "9.23",
 "size" : 31,
 "name" : "cluster_18_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m410_AT4G17785", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m410_AT4G17785_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m410_AT4G17785_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m410_AT4G17785_logo.png",
 "name" : "AT4G17785",
 "ic" : "9.45",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYYYACCTAMYWTW"
 },
 {
  "label": "a.t_motifs_m397_AT4G05100", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m397_AT4G05100_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m397_AT4G05100_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m397_AT4G05100_logo.png",
 "name" : "AT4G05100",
 "ic" : "9.21",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "DWWRKTAGGTRRRR"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m578_AT5G56110", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m578_AT5G56110_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m578_AT5G56110_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m578_AT5G56110_logo.png",
 "name" : "AT5G56110",
 "ic" : "8.91",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "KTYYACCTAMYTWTW"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m508_AT5G14340", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m508_AT5G14340_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m508_AT5G14340_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m508_AT5G14340_logo.png",
 "name" : "AT5G14340",
 "ic" : "9.23",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "RAWRKTWGGTRRR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m33_AT1G16490", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m33_AT1G16490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m33_AT1G16490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m33_AT1G16490_logo.png",
 "name" : "AT1G16490",
 "ic" : "9.05",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "GTTYYACCWAMCMYH"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "aGkTAGGTrrr",
 "branch" : 24,
 "id" : "cluster_18_node_24",
 "ic" : "7.83",
 "size" : 31,
 "name" : "cluster_18_node_24_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_24_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_24_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "aGkTAGGTara",
 "branch" : 20,
 "id" : "cluster_18_node_20",
 "ic" : "7.99",
 "size" : 31,
 "name" : "cluster_18_node_20_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_20_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_20_5motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m585_AT5G59780", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m585_AT5G59780_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m585_AT5G59780_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m585_AT5G59780_logo.png",
 "name" : "AT5G59780",
 "ic" : "8.23",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "KKACCTAAYT"
 },
 {
  "consensus" : "aGKTAGGTrra",
 "branch" : 13,
 "id" : "cluster_18_node_13",
 "ic" : "8.37",
 "size" : 31,
 "name" : "cluster_18_node_13_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_13_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_13_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wGkTAGGTrr",
 "branch" : 9,
 "id" : "cluster_18_node_9",
 "ic" : "8.31",
 "size" : 31,
 "name" : "cluster_18_node_9_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_9_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_9_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "dGkTAGGTrs",
 "branch" : 3,
 "id" : "cluster_18_node_3",
 "ic" : "8.17",
 "size" : 31,
 "name" : "cluster_18_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m503_AT5G12870", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m503_AT5G12870_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m503_AT5G12870_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m503_AT5G12870_logo.png",
 "name" : "AT5G12870",
 "ic" : "8.27",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYACCTAMCT"
 },
 {
  "label": "a.t_motifs_m567_AT5G49330", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m567_AT5G49330_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m567_AT5G49330_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m567_AT5G49330_logo.png",
 "name" : "AT5G49330",
 "ic" : "8.43",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "SYACCTAMYH"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m267_AT2G47460", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m267_AT2G47460_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m267_AT2G47460_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m267_AT2G47460_logo.png",
 "name" : "AT2G47460",
 "ic" : "9.72",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "MGGTAGGTAW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m48_AT1G22640", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m48_AT1G22640_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m48_AT1G22640_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m48_AT1G22640_logo.png",
 "name" : "AT1G22640",
 "ic" : "8.91",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYTACCTACCY"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m499_AT5G10280", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m499_AT5G10280_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m499_AT5G10280_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m499_AT5G10280_logo.png",
 "name" : "AT5G10280",
 "ic" : "7.92",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYYACCTAMC"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "gGgdgGTwGkTGg",
 "branch" : 35,
 "id" : "cluster_18_node_35",
 "ic" : "8.26",
 "size" : 31,
 "name" : "cluster_18_node_35_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_35_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_35_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "gwkkTTGkTGr",
 "branch" : 26,
 "id" : "cluster_18_node_26",
 "ic" : "7.05",
 "size" : 31,
 "name" : "cluster_18_node_26_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_26_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_26_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m546_AT5G40330", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m546_AT5G40330_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m546_AT5G40330_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m546_AT5G40330_logo.png",
 "name" : "AT5G40330",
 "ic" : "8.14",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCAACWAMMWH"
 },
 {
  "label": "a.t_motifs_m282_AT3G08500", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m282_AT3G08500_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m282_AT3G08500_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m282_AT3G08500_logo.png",
 "name" : "AT3G08500",
 "ic" : "7.57",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCACCAACMMC"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m354_AT3G49690", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m354_AT3G49690_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m354_AT3G49690_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m354_AT3G49690_logo.png",
 "name" : "AT3G49690",
 "ic" : "12.69",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "SCACCTACCCCCC"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "ddwddkdwdrwGkTwGGTrrrmhw",
 "branch" : 29,
 "id" : "cluster_18_node_29",
 "ic" : "8.68",
 "size" : 31,
 "name" : "cluster_18_node_29_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_18_node_29_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_18_node_29_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m78_AT1G34670", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m78_AT1G34670_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m78_AT1G34670_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m78_AT1G34670_logo.png",
 "name" : "AT1G34670",
 "ic" : "8.60",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "WDKYYYAMCWAMYWHHMMMWM"
 },
 {
  "label": "a.t_motifs_m298_AT3G12720", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m298_AT3G12720_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m298_AT3G12720_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m298_AT3G12720_logo.png",
 "name" : "AT3G12720",
 "ic" : "9.11",
 "size" : 31,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCYACCWAMCAYHWHHHYWHH"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 300; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_18").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#8D69AC");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_18"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#8D69AC"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_18" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#8D69AC")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_18").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_18").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_18").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_18").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 18;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_19").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wvtTwCCaAAAawRGaAArww",
 "branch" : 15,
 "id" : "cluster_19_node_15",
 "ic" : "10.93",
 "size" : 21,
 "name" : "cluster_19",
 "image" : "matrix-clustering_aligned_logos/cluster_19_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_logo_rc.png",

  "children": [
  {
  "consensus" : "TwCCaAAAawRGAAAgw",
 "branch" : 13,
 "id" : "cluster_19_node_13",
 "ic" : "10.16",
 "size" : 21,
 "name" : "cluster_19_node_13_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_13_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_13_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TwCCaAAAatGGaAA",
 "branch" : 12,
 "id" : "cluster_19_node_12",
 "ic" : "9.61",
 "size" : 21,
 "name" : "cluster_19_node_12_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_12_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_12_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TwCCaAAAawGGaAA",
 "branch" : 4,
 "id" : "cluster_19_node_4",
 "ic" : "10.44",
 "size" : 21,
 "name" : "cluster_19_node_4_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_4_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_4_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m369_AT3G57230", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m369_AT3G57230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m369_AT3G57230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m369_AT3G57230_logo.png",
 "name" : "AT3G57230",
 "ic" : "11.27",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWCCHAAWAWGGAAA"
 },
 {
  "consensus" : "TkCCAAAAatGGmAA",
 "branch" : 2,
 "id" : "cluster_19_node_2",
 "ic" : "10.54",
 "size" : 21,
 "name" : "cluster_19_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m67_AT1G31140", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m67_AT1G31140_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m67_AT1G31140_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m67_AT1G31140_logo.png",
 "name" : "AT1G31140",
 "ic" : "11.50",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTKCCATTTTTGGMA"
 },
 {
  "label": "a.t_motifs_m364_AT3G54340", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m364_AT3G54340_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m364_AT3G54340_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m364_AT3G54340_logo.png",
 "name" : "AT3G54340",
 "ic" : "9.97",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTCYWYTTTTGGWW"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "CyAAAAatGGaAA",
 "branch" : 6,
 "id" : "cluster_19_node_6",
 "ic" : "8.43",
 "size" : 21,
 "name" : "cluster_19_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m50_AT1G24260", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m50_AT1G24260_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m50_AT1G24260_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m50_AT1G24260_logo.png",
 "name" : "AT1G24260",
 "ic" : "8.57",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTCYWTTTTTGG"
 },
 {
  "label": "a.t_motifs_m130_AT1G69120", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m130_AT1G69120_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m130_AT1G69120_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m130_AT1G69120_logo.png",
 "name" : "AT1G69120",
 "ic" : "8.13",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTCCATWTTTRG"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "CCmAAAawrGAAAgw",
 "branch" : 8,
 "id" : "cluster_19_node_8",
 "ic" : "10.06",
 "size" : 21,
 "name" : "cluster_19_node_8_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_8_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_8_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "CCmAAAAwrGAAAgw",
 "branch" : 7,
 "id" : "cluster_19_node_7",
 "ic" : "10.65",
 "size" : 21,
 "name" : "cluster_19_node_7_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_7_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_7_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m160_AT1G77080", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m160_AT1G77080_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m160_AT1G77080_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m160_AT1G77080_logo.png",
 "name" : "AT1G77080",
 "ic" : "11.65",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "MYMAAAWTRGAAAGW"
 },
 {
  "label": "a.t_motifs_m201_AT2G22540", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m201_AT2G22540_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m201_AT2G22540_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m201_AT2G22540_logo.png",
 "name" : "AT2G22540",
 "ic" : "10.99",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "CCMAAWAAGGAAARW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m523_AT5G20240", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m523_AT5G20240_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m523_AT5G20240_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m523_AT5G20240_logo.png",
 "name" : "AT5G20240",
 "ic" : "9.74",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "YTTTCYWYTTTTGK"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "wvtTwCCaAAAawrGaAArww",
 "branch" : 14,
 "id" : "cluster_19_node_14",
 "ic" : "11.14",
 "size" : 21,
 "name" : "cluster_19_node_14_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_14_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_14_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "",
 "branch" : 11,
 "id" : "cluster_19_node_11",
 "ic" : "0",
 "size" : 21,
 "name" : "",
 "image" : ".",
 "image_rc" : ".",

  "children": [
  {
  "consensus" : "sktwCCAwwwwTrGwwak",
 "branch" : 3,
 "id" : "cluster_19_node_3",
 "ic" : "9.03",
 "size" : 21,
 "name" : "cluster_19_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m181_AT2G03710", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m181_AT2G03710_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m181_AT2G03710_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m181_AT2G03710_logo.png",
 "name" : "AT2G03710",
 "ic" : "9.17",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "VTWWCYWWWWWTGGWWMS"
 },
 {
  "label": "a.t_motifs_m510_AT5G15800", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m510_AT5G15800_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m510_AT5G15800_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m510_AT5G15800_logo.png",
 "name" : "AT5G15800",
 "ic" : "9.72",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "MTTWCYAWWWWTGGWAWD"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m373_AT3G58780", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m373_AT3G58780_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m373_AT3G58780_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m373_AT3G58780_logo.png",
 "name" : "AT3G58780",
 "ic" : "8.25",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "YTTWCCCAWWWWGGHAAW"
 } 
 ] 
 },
 {
  "consensus" : "wsTTwCCaAAAAwrGAAArww",
 "branch" : 10,
 "id" : "cluster_19_node_10",
 "ic" : "11.72",
 "size" : 21,
 "name" : "cluster_19_node_10_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_10_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_10_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TTwCCaAAAAwRGaAArww",
 "branch" : 5,
 "id" : "cluster_19_node_5",
 "ic" : "11.72",
 "size" : 21,
 "name" : "cluster_19_node_5_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_5_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_5_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TTwCCaAAAAwRGaAArww",
 "branch" : 1,
 "id" : "cluster_19_node_1",
 "ic" : "11.31",
 "size" : 21,
 "name" : "cluster_19_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m419_AT4G18960", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m419_AT4G18960_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m419_AT4G18960_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m419_AT4G18960_logo.png",
 "name" : "AT4G18960",
 "ic" : "9.57",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWDCCAAAARWRGAAARWW"
 },
 {
  "label": "a.t_motifs_m254_AT2G45650", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m254_AT2G45650_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m254_AT2G45650_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m254_AT2G45650_logo.png",
 "name" : "AT2G45650",
 "ic" : "13.38",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWTTTTCYWTTTTTGGWAA"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m379_AT3G61120", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m379_AT3G61120_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m379_AT3G61120_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m379_AT3G61120_logo.png",
 "name" : "AT3G61120",
 "ic" : "14.00",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTTTWCYWTTTTTRGWAW"
 } 
 ] 
 },
 {
  "consensus" : "wsTTwCCmAAAawrGAAAgww",
 "branch" : 9,
 "id" : "cluster_19_node_9",
 "ic" : "11.81",
 "size" : 21,
 "name" : "cluster_19_node_9_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_19_node_9_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_19_node_9_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m498_AT5G10140", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m498_AT5G10140_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m498_AT5G10140_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m498_AT5G10140_logo.png",
 "name" : "AT5G10140",
 "ic" : "11.06",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWCTTTCYWTTTTKRGWWWTT"
 },
 {
  "label": "a.t_motifs_m506_AT5G13790", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m506_AT5G13790_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m506_AT5G13790_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m506_AT5G13790_logo.png",
 "name" : "AT5G13790",
 "ic" : "12.62",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "WSTTWCCMAAWAWRGAAAG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_19").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#9D64A6");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_19"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#9D64A6"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_19" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#9D64A6")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_19").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_19").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_19").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_19").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 13;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_20").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "AwwgcGsCGCCAaaa",
 "branch" : 10,
 "id" : "cluster_20_node_10",
 "ic" : "8.67",
 "size" : 15,
 "name" : "cluster_20",
 "image" : "matrix-clustering_aligned_logos/cluster_20_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_logo_rc.png",

  "children": [
  {
  "consensus" : "mgCGCCGCCscc",
 "branch" : 9,
 "id" : "cluster_20_node_9",
 "ic" : "6.89",
 "size" : 15,
 "name" : "cluster_20_node_9_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_20_node_9_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_node_9_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rgCGCCGCCscc",
 "branch" : 7,
 "id" : "cluster_20_node_7",
 "ic" : "6.96",
 "size" : 15,
 "name" : "cluster_20_node_7_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_20_node_7_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_node_7_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rgCGCCGCCrh",
 "branch" : 6,
 "id" : "cluster_20_node_6",
 "ic" : "6.76",
 "size" : 15,
 "name" : "cluster_20_node_6_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_20_node_6_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_node_6_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "scGCCGCCrh",
 "branch" : 5,
 "id" : "cluster_20_node_5",
 "ic" : "7.07",
 "size" : 15,
 "name" : "cluster_20_node_5_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_20_node_5_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_node_5_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "CGCCGCCr",
 "branch" : 2,
 "id" : "cluster_20_node_2",
 "ic" : "8.48",
 "size" : 15,
 "name" : "cluster_20_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_20_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m58_AT1G28360", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m58_AT1G28360_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m58_AT1G28360_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m58_AT1G28360_logo.png",
 "name" : "AT1G28360",
 "ic" : "9.75",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "YGGCGSCG"
 },
 {
  "label": "a.t_motifs_m11_AT1G06160", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m11_AT1G06160_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m11_AT1G06160_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m11_AT1G06160_logo.png",
 "name" : "AT1G06160",
 "ic" : "8.31",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "YGGCGGCK"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m550_AT5G43410", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m550_AT5G43410_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m550_AT5G43410_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m550_AT5G43410_logo.png",
 "name" : "AT5G43410",
 "ic" : "5.51",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "DTGGCGGCKS"
 } 
 ] 
 },
 {
  "consensus" : "rgCGCCGCmt",
 "branch" : 4,
 "id" : "cluster_20_node_4",
 "ic" : "7.03",
 "size" : 15,
 "name" : "cluster_20_node_4_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_20_node_4_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_node_4_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m461_AT4G36900", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m461_AT4G36900_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m461_AT4G36900_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m461_AT4G36900_logo.png",
 "name" : "AT4G36900",
 "ic" : "8.72",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "AGGCGGCGCY"
 },
 {
  "consensus" : "gCGCCGCm",
 "branch" : 1,
 "id" : "cluster_20_node_1",
 "ic" : "6.60",
 "size" : 15,
 "name" : "cluster_20_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_20_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m312_AT3G16770", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m312_AT3G16770_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m312_AT3G16770_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m312_AT3G16770_logo.png",
 "name" : "AT3G16770",
 "ic" : "6.59",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "KGCGGCGC"
 },
 {
  "label": "a.t_motifs_m426_AT4G23750", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m426_AT4G23750_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m426_AT4G23750_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m426_AT4G23750_logo.png",
 "name" : "AT4G23750",
 "ic" : "8.12",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "GGCGGCGS"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m235_AT2G40220", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m235_AT2G40220_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m235_AT2G40220_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m235_AT2G40220_logo.png",
 "name" : "AT2G40220",
 "ic" : "6.75",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "GGGGGCRSCG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m387_AT4G00270", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m387_AT4G00270_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m387_AT4G00270_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m387_AT4G00270_logo.png",
 "name" : "AT4G00270",
 "ic" : "7.71",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCGGCCGK"
 } 
 ] 
 },
 {
  "consensus" : "AwwwwGGCGCCAaaa",
 "branch" : 8,
 "id" : "cluster_20_node_8",
 "ic" : "10.87",
 "size" : 15,
 "name" : "cluster_20_node_8_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_20_node_8_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_node_8_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "AwwwwGGCGCCAaaa",
 "branch" : 3,
 "id" : "cluster_20_node_3",
 "ic" : "11.10",
 "size" : 15,
 "name" : "cluster_20_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_20_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_20_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m226_AT2G36010", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m226_AT2G36010_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m226_AT2G36010_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m226_AT2G36010_logo.png",
 "name" : "AT2G36010",
 "ic" : "10.05",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTGGCGCCWWWW"
 },
 {
  "label": "a.t_motifs_m90_AT1G47870", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m90_AT1G47870_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m90_AT1G47870_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m90_AT1G47870_logo.png",
 "name" : "AT1G47870",
 "ic" : "12.68",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "YTTTGGCGCCWWWWT"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m524_AT5G22220", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m524_AT5G22220_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m524_AT5G22220_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m524_AT5G22220_logo.png",
 "name" : "AT5G22220",
 "ic" : "5.93",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWDGGCGCSC"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_20").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AC5DA1");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_20"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AC5DA1"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_20" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AC5DA1")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_20").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_20").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_20").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_20").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 6;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_21").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wwwahdwTTTTSSCGSsAAAA",
 "branch" : 3,
 "id" : "cluster_21_node_3",
 "ic" : "14.84",
 "size" : 21,
 "name" : "cluster_21",
 "image" : "matrix-clustering_aligned_logos/cluster_21_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_21_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m351_AT3G48160", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m351_AT3G48160_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m351_AT3G48160_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m351_AT3G48160_logo.png",
 "name" : "AT3G48160",
 "ic" : "16.79",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTGGCGGGAAAWWTWTWKT"
 },
 {
  "consensus" : "TwwwyktTTTTGGCGGGAAAA",
 "branch" : 2,
 "id" : "cluster_21_node_2",
 "ic" : "18.15",
 "size" : 21,
 "name" : "cluster_21_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_21_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_21_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TTTaygkTTTTGGCGGGAAAA",
 "branch" : 1,
 "id" : "cluster_21_node_1",
 "ic" : "20.62",
 "size" : 21,
 "name" : "cluster_21_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_21_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_21_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m450_AT4G33280", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m450_AT4G33280_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m450_AT4G33280_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m450_AT4G33280_logo.png",
 "name" : "AT4G33280",
 "ic" : "20.80",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTCCCGCCAAAAMMRTAAA"
 },
 {
  "label": "a.t_motifs_m440_AT4G30080", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m440_AT4G30080_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m440_AT4G30080_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m440_AT4G30080_logo.png",
 "name" : "AT4G30080",
 "ic" : "21.91",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTYCCGCCAAAAMCGTAAA"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m509_AT5G14960", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m509_AT5G14960_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m509_AT5G14960_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m509_AT5G14960_logo.png",
 "name" : "AT5G14960",
 "ic" : "16.93",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTCCCGCCAAAAAHWWWW"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_21").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BA569C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_21"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BA569C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_21" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BA569C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_21").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_21").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_21").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_21").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 8;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_22").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wTGmCAGCTgkwmw",
 "branch" : 5,
 "id" : "cluster_22_node_5",
 "ic" : "8.96",
 "size" : 14,
 "name" : "cluster_22",
 "image" : "matrix-clustering_aligned_logos/cluster_22_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_22_logo_rc.png",

  "children": [
  {
  "consensus" : "wTGmCAGCTGkh",
 "branch" : 4,
 "id" : "cluster_22_node_4",
 "ic" : "9.11",
 "size" : 14,
 "name" : "cluster_22_node_4_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_22_node_4_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_22_node_4_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wTGmCAGCTGkh",
 "branch" : 3,
 "id" : "cluster_22_node_3",
 "ic" : "9.25",
 "size" : 14,
 "name" : "cluster_22_node_3_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_22_node_3_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_22_node_3_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wTGmCAGCTGkh",
 "branch" : 2,
 "id" : "cluster_22_node_2",
 "ic" : "9.30",
 "size" : 14,
 "name" : "cluster_22_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_22_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_22_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "TGmCAGCTgkh",
 "branch" : 1,
 "id" : "cluster_22_node_1",
 "ic" : "9.00",
 "size" : 14,
 "name" : "cluster_22_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_22_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_22_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m238_AT2G40620", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m238_AT2G40620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m238_AT2G40620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m238_AT2G40620_logo.png",
 "name" : "AT2G40620",
 "ic" : "8.69",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGMCAGCTGKT"
 },
 {
  "label": "a.t_motifs_m10_AT1G06070", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m10_AT1G06070_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m10_AT1G06070_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m10_AT1G06070_logo.png",
 "name" : "AT1G06070",
 "ic" : "11.15",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGMCAGCTGKM"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m84_AT1G43700", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m84_AT1G43700_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m84_AT1G43700_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m84_AT1G43700_logo.png",
 "name" : "AT1G43700",
 "ic" : "9.98",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "DMCAGCTGKCAW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m197_AT2G21230", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m197_AT2G21230_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m197_AT2G21230_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m197_AT2G21230_logo.png",
 "name" : "AT2G21230",
 "ic" : "7.02",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "MCAGCTGKCR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m186_AT2G17180", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m186_AT2G17180_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m186_AT2G17180_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m186_AT2G17180_logo.png",
 "name" : "AT2G17180",
 "ic" : "6.02",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "SSCAGCTGSG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m14_AT1G06850", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m14_AT1G06850_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m14_AT1G06850_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m14_AT1G06850_logo.png",
 "name" : "AT1G06850",
 "ic" : "8.78",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "WKAMMRGCTGKCAW"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_22").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C74D97");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_22"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C74D97"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_22" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C74D97")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_22").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_22").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_22").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_22").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 19;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_23").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "awcrtrwwwgrCACGTGtsawmwygw",
 "branch" : 16,
 "id" : "cluster_23_node_16",
 "ic" : "8.79",
 "size" : 26,
 "name" : "cluster_23",
 "image" : "matrix-clustering_aligned_logos/cluster_23_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_logo_rc.png",

  "children": [
  {
  "consensus" : "awcrtrwdwsdCACGTGygr",
 "branch" : 14,
 "id" : "cluster_23_node_14",
 "ic" : "9.17",
 "size" : 26,
 "name" : "cluster_23_node_14_12motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_14_12motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_14_12motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "adwrwrrttyrCACGTGyGr",
 "branch" : 11,
 "id" : "cluster_23_node_11",
 "ic" : "10.53",
 "size" : 26,
 "name" : "cluster_23_node_11_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_11_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_11_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m553_AT5G45300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m553_AT5G45300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m553_AT5G45300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m553_AT5G45300_logo.png",
 "name" : "AT5G45300",
 "ic" : "10.95",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "AKTTSRCACGTGTGR"
 },
 {
  "label": "a.t_motifs_m152_AT1G75080", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m152_AT1G75080_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m152_AT1G75080_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m152_AT1G75080_logo.png",
 "name" : "AT1G75080",
 "ic" : "10.66",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "ADWRWRRKDYRCACGTGYGG"
 } 
 ] 
 },
 {
  "consensus" : "acrtgwdwgtCACGTGky",
 "branch" : 13,
 "id" : "cluster_23_node_13",
 "ic" : "9.15",
 "size" : 26,
 "name" : "cluster_23_node_13_10motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_13_10motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_13_10motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "acrtgwdwgtCACGTGky",
 "branch" : 12,
 "id" : "cluster_23_node_12",
 "ic" : "9.15",
 "size" : 26,
 "name" : "cluster_23_node_12_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_12_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_12_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "cayrTkwwaCACGTGky",
 "branch" : 4,
 "id" : "cluster_23_node_4",
 "ic" : "9.58",
 "size" : 26,
 "name" : "cluster_23_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m471_AT5G01380", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m471_AT5G01380_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m471_AT5G01380_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m471_AT5G01380_logo.png",
 "name" : "AT5G01380",
 "ic" : "10.09",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "MAHWWTWWACACGTGYY"
 },
 {
  "label": "a.t_motifs_m202_AT2G22750", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m202_AT2G22750_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m202_AT2G22750_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m202_AT2G22750_logo.png",
 "name" : "AT2G22750",
 "ic" : "10.73",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "RMCACGTGDWWMACRYG"
 } 
 ] 
 },
 {
  "consensus" : "acgtgrrwgkCACGTGvy",
 "branch" : 10,
 "id" : "cluster_23_node_10",
 "ic" : "9.95",
 "size" : 26,
 "name" : "cluster_23_node_10_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_10_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_10_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "sdkrrdgyCACGTGsk",
 "branch" : 7,
 "id" : "cluster_23_node_7",
 "ic" : "9.00",
 "size" : 26,
 "name" : "cluster_23_node_7_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_7_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_7_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "sdkrrtgyCACGTGg",
 "branch" : 5,
 "id" : "cluster_23_node_5",
 "ic" : "9.21",
 "size" : 26,
 "name" : "cluster_23_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m194_AT2G20180", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m194_AT2G20180_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m194_AT2G20180_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m194_AT2G20180_logo.png",
 "name" : "AT2G20180",
 "ic" : "9.10",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CCACGTGWCCYYMY"
 },
 {
  "label": "a.t_motifs_m590_AT5G61270", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m590_AT5G61270_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m590_AT5G61270_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m590_AT5G61270_logo.png",
 "name" : "AT5G61270",
 "ic" : "10.13",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CCACGTGGSWYYMWS"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m327_AT3G23690", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m327_AT3G23690_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m327_AT3G23690_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m327_AT3G23690_logo.png",
 "name" : "AT3G23690",
 "ic" : "9.67",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "MKCACGTGVCHWMWY"
 } 
 ] 
 },
 {
  "consensus" : "acgtgmrwgkCACGTGmc",
 "branch" : 8,
 "id" : "cluster_23_node_8",
 "ic" : "10.72",
 "size" : 26,
 "name" : "cluster_23_node_8_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_8_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_8_4motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m541_AT5G38860", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m541_AT5G38860_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m541_AT5G38860_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m541_AT5G38860_logo.png",
 "name" : "AT5G38860",
 "ic" : "11.51",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "GKCACGTGASWWKCACGT"
 },
 {
  "consensus" : "cgtgarwgkCACGTG",
 "branch" : 3,
 "id" : "cluster_23_node_3",
 "ic" : "9.83",
 "size" : 26,
 "name" : "cluster_23_node_3_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_3_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_3_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m493_AT5G08130", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m493_AT5G08130_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m493_AT5G08130_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m493_AT5G08130_logo.png",
 "name" : "AT5G08130",
 "ic" : "9.88",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "GKGRRWGTCACGTG"
 },
 {
  "consensus" : "cgtgmrwgkCACGTG",
 "branch" : 1,
 "id" : "cluster_23_node_1",
 "ic" : "9.89",
 "size" : 26,
 "name" : "cluster_23_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m441_AT4G30980", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m441_AT4G30980_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m441_AT4G30980_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m441_AT4G30980_logo.png",
 "name" : "AT4G30980",
 "ic" : "11.36",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CACGTGCVWMRCACG"
 },
 {
  "label": "a.t_motifs_m129_AT1G69010", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m129_AT1G69010_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m129_AT1G69010_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m129_AT1G69010_logo.png",
 "name" : "AT1G69010",
 "ic" : "9.91",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "CGTGMRWGKCACGTG"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m423_AT4G21330", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m423_AT4G21330_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m423_AT4G21330_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m423_AT4G21330_logo.png",
 "name" : "AT4G21330",
 "ic" : "13.30",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "TCACGTGWYTCAYK"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "ycgwgwwtgmCACGTGwcmwmwygw",
 "branch" : 15,
 "id" : "cluster_23_node_15",
 "ic" : "8.93",
 "size" : 26,
 "name" : "cluster_23_node_15_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_15_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_15_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "cgtgawwrvCACGTGycammwygw",
 "branch" : 6,
 "id" : "cluster_23_node_6",
 "ic" : "8.89",
 "size" : 26,
 "name" : "cluster_23_node_6_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_6_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_6_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "cgtgwwwvsCACGTGccwcmws",
 "branch" : 2,
 "id" : "cluster_23_node_2",
 "ic" : "9.21",
 "size" : 26,
 "name" : "cluster_23_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m110_AT1G59640", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m110_AT1G59640_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m110_AT1G59640_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m110_AT1G59640_logo.png",
 "name" : "AT1G59640",
 "ic" : "8.98",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "GWGWWWSVCACGTGYCWCMWS"
 },
 {
  "label": "a.t_motifs_m23_AT1G10120", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m23_AT1G10120_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m23_AT1G10120_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m23_AT1G10120_logo.png",
 "name" : "AT1G10120",
 "ic" : "9.88",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "WGRTSKCACGTGMYWYTCACG"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m323_AT3G23210", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m323_AT3G23210_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m323_AT3G23210_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m323_AT3G23210_logo.png",
 "name" : "AT3G23210",
 "ic" : "8.89",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "WCRWGYTGRCACGTGYCWWYCAC"
 } 
 ] 
 },
 {
  "consensus" : "ycdawwwTGMCACGTswccw",
 "branch" : 9,
 "id" : "cluster_23_node_9",
 "ic" : "11.92",
 "size" : 26,
 "name" : "cluster_23_node_9_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_23_node_9_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_23_node_9_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m86_AT1G45249", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m86_AT1G45249_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m86_AT1G45249_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m86_AT1G45249_logo.png",
 "name" : "AT1G45249",
 "ic" : "11.67",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "WGGWSACGTGKCAWWWTH"
 },
 {
  "label": "a.t_motifs_m94_AT1G49720", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m94_AT1G49720_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m94_AT1G49720_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m94_AT1G49720_logo.png",
 "name" : "AT1G49720",
 "ic" : "12.91",
 "size" : 26,
 "title" : "a.t_motifs",
 "consensus_rc" : "YCBBBYGKGCCACGTGKCC"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_23").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D44291");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_23"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D44291"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_23" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D44291")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_23").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_23").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_23").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_23").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 20;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_24").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "arawyyrGATCTrarw",
 "branch" : 17,
 "id" : "cluster_24_node_17",
 "ic" : "6.99",
 "size" : 16,
 "name" : "cluster_24",
 "image" : "matrix-clustering_aligned_logos/cluster_24_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_logo_rc.png",

  "children": [
  {
  "consensus" : "tmasCGwATCTdtmt",
 "branch" : 15,
 "id" : "cluster_24_node_15",
 "ic" : "7.28",
 "size" : 16,
 "name" : "cluster_24_node_15_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_15_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_15_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rrGAATmTdd",
 "branch" : 11,
 "id" : "cluster_24_node_11",
 "ic" : "7.33",
 "size" : 16,
 "name" : "cluster_24_node_11_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_11_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_11_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m196_AT2G20570", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m196_AT2G20570_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m196_AT2G20570_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m196_AT2G20570_logo.png",
 "name" : "AT2G20570",
 "ic" : "7.31",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "HCAGATTCTY"
 },
 {
  "label": "a.t_motifs_m329_AT3G24120", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m329_AT3G24120_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m329_AT3G24120_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m329_AT3G24120_logo.png",
 "name" : "AT3G24120",
 "ic" : "7.18",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "HAKATTCY"
 } 
 ] 
 },
 {
  "consensus" : "tmasCGwATCTwtmt",
 "branch" : 13,
 "id" : "cluster_24_node_13",
 "ic" : "8.33",
 "size" : 16,
 "name" : "cluster_24_node_13_7motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_13_7motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_13_7motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "tsCGwATCTwt",
 "branch" : 9,
 "id" : "cluster_24_node_9",
 "ic" : "8.37",
 "size" : 16,
 "name" : "cluster_24_node_9_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_9_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_9_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "tsCGwATCTwt",
 "branch" : 4,
 "id" : "cluster_24_node_4",
 "ic" : "7.47",
 "size" : 16,
 "name" : "cluster_24_node_4_3motifs",
 "image" : ".",
 "image_rc" : ".",

  "children": [
  {
  "consensus" : "sCGwATCTtt",
 "branch" : 1,
 "id" : "cluster_24_node_1",
 "ic" : "7.97",
 "size" : 16,
 "name" : "cluster_24_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m123_AT1G67710", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m123_AT1G67710_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m123_AT1G67710_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m123_AT1G67710_logo.png",
 "name" : "AT1G67710",
 "ic" : "9.13",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "CCGWATCTWT"
 },
 {
  "label": "a.t_motifs_m404_AT4G16110", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m404_AT4G16110_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m404_AT4G16110_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m404_AT4G16110_logo.png",
 "name" : "AT4G16110",
 "ic" : "7.71",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAGATWCKS"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m482_AT5G05090", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m482_AT5G05090_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m482_AT5G05090_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m482_AT5G05090_logo.png",
 "name" : "AT5G05090",
 "ic" : "7.03",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYCGDATCTDT"
 } 
 ] 
 },
 {
  "consensus" : "sCGwATCT",
 "branch" : 2,
 "id" : "cluster_24_node_2",
 "ic" : "8.14",
 "size" : 16,
 "name" : "cluster_24_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m171_AT2G01760", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m171_AT2G01760_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m171_AT2G01760_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m171_AT2G01760_logo.png",
 "name" : "AT2G01760",
 "ic" : "8.20",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "SCGWATCT"
 },
 {
  "label": "a.t_motifs_m446_AT4G31920", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m446_AT4G31920_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m446_AT4G31920_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m446_AT4G31920_logo.png",
 "name" : "AT4G31920",
 "ic" : "6.65",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "SMRDATCT"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "tmascRwATCTtdmt",
 "branch" : 10,
 "id" : "cluster_24_node_10",
 "ic" : "6.34",
 "size" : 16,
 "name" : "cluster_24_node_10_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_10_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_10_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m581_AT5G58080", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m581_AT5G58080_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m581_AT5G58080_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m581_AT5G58080_logo.png",
 "name" : "AT5G58080",
 "ic" : "6.62",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "ABCRTATCTWKAT"
 },
 {
  "label": "a.t_motifs_m347_AT3G46640", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m347_AT3G46640_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m347_AT3G46640_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m347_AT3G46640_logo.png",
 "name" : "AT3G46640",
 "ic" : "6.70",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "TMASCRWATCTTDM"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "arawyyaGATCtrarw",
 "branch" : 16,
 "id" : "cluster_24_node_16",
 "ic" : "8.15",
 "size" : 16,
 "name" : "cluster_24_node_16_9motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_16_9motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_16_9motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "arawyyaGATCtrarw",
 "branch" : 14,
 "id" : "cluster_24_node_14",
 "ic" : "8.15",
 "size" : 16,
 "name" : "cluster_24_node_14_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_14_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_14_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rrawyyAGATCTrarw",
 "branch" : 12,
 "id" : "cluster_24_node_12",
 "ic" : "8.94",
 "size" : 16,
 "name" : "cluster_24_node_12_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_12_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_12_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rrawyyAGATCTrarw",
 "branch" : 8,
 "id" : "cluster_24_node_8",
 "ic" : "8.95",
 "size" : 16,
 "name" : "cluster_24_node_8_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_8_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_8_5motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m361_AT3G51080", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m361_AT3G51080_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m361_AT3G51080_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m361_AT3G51080_logo.png",
 "name" : "AT3G51080",
 "ic" : "9.86",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "RRATCTAGATCTR"
 },
 {
  "consensus" : "rrawyyAGATCTrarw",
 "branch" : 7,
 "id" : "cluster_24_node_7",
 "ic" : "8.87",
 "size" : 16,
 "name" : "cluster_24_node_7_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_7_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_7_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rrawyyAGATCTrar",
 "branch" : 3,
 "id" : "cluster_24_node_3",
 "ic" : "8.75",
 "size" : 16,
 "name" : "cluster_24_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m16_AT1G08010", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m16_AT1G08010_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m16_AT1G08010_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m16_AT1G08010_logo.png",
 "name" : "AT1G08010",
 "ic" : "9.74",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "HTCAGATCYRRWTYY"
 },
 {
  "label": "a.t_motifs_m343_AT3G45170", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m343_AT3G45170_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m343_AT3G45170_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m343_AT3G45170_logo.png",
 "name" : "AT3G45170",
 "ic" : "8.69",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "AAAAWYAGATCTAAA"
 } 
 ] 
 },
 {
  "consensus" : "rawyyAGATCyrrrw",
 "branch" : 5,
 "id" : "cluster_24_node_5",
 "ic" : "9.02",
 "size" : 16,
 "name" : "cluster_24_node_5_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_5_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_5_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m377_AT3G60530", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m377_AT3G60530_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m377_AT3G60530_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m377_AT3G60530_logo.png",
 "name" : "AT3G60530",
 "ic" : "8.86",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "RRWYYRGATCYRRRW"
 },
 {
  "label": "a.t_motifs_m534_AT5G25830", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m534_AT5G25830_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m534_AT5G25830_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m534_AT5G25830_logo.png",
 "name" : "AT5G25830",
 "ic" : "9.32",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYRGATCTRRATY"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m449_AT4G32890", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m449_AT4G32890_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m449_AT4G32890_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m449_AT4G32890_logo.png",
 "name" : "AT4G32890",
 "ic" : "8.33",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "WYAGATCTRGA"
 } 
 ] 
 },
 {
  "consensus" : "htrATCmGATCkr",
 "branch" : 6,
 "id" : "cluster_24_node_6",
 "ic" : "7.62",
 "size" : 16,
 "name" : "cluster_24_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_24_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_24_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m457_AT4G36620", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m457_AT4G36620_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m457_AT4G36620_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m457_AT4G36620_logo.png",
 "name" : "AT4G36620",
 "ic" : "8.51",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "RATCVGATCBR"
 },
 {
  "label": "a.t_motifs_m192_AT2G18380", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m192_AT2G18380_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m192_AT2G18380_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m192_AT2G18380_logo.png",
 "name" : "AT2G18380",
 "ic" : "7.48",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "HTRATCMGATCRA"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m15_AT1G08000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m15_AT1G08000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m15_AT1G08000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m15_AT1G08000_logo.png",
 "name" : "AT1G08000",
 "ic" : "8.12",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "CAGATCTA"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 250; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_24").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E0348C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_24"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E0348C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_24" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E0348C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_24").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_24").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_24").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_24").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 7;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_25").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "ahwrcrGTAAAWawdwwww",
 "branch" : 4,
 "id" : "cluster_25_node_4",
 "ic" : "9.33",
 "size" : 19,
 "name" : "cluster_25",
 "image" : "matrix-clustering_aligned_logos/cluster_25_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_25_logo_rc.png",

  "children": [
  {
  "consensus" : "rcrGTAAAAAwdwwww",
 "branch" : 1,
 "id" : "cluster_25_node_1",
 "ic" : "9.21",
 "size" : 19,
 "name" : "cluster_25_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_25_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_25_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m158_AT1G76880", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m158_AT1G76880_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m158_AT1G76880_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m158_AT1G76880_logo.png",
 "name" : "AT1G76880",
 "ic" : "9.24",
 "size" : 19,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWWWHWTTTTTACYGT"
 },
 {
  "label": "a.t_motifs_m563_AT5G47660", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m563_AT5G47660_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m563_AT5G47660_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m563_AT5G47660_logo.png",
 "name" : "AT5G47660",
 "ic" : "9.40",
 "size" : 19,
 "title" : "a.t_motifs",
 "consensus_rc" : "RCRGTWAAAAWDDWW"
 } 
 ] 
 },
 {
  "consensus" : "ahwryrGTAAAWaw",
 "branch" : 3,
 "id" : "cluster_25_node_3",
 "ic" : "8.58",
 "size" : 19,
 "name" : "cluster_25_node_3_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_25_node_3_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_25_node_3_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "cayrGTAAAWa",
 "branch" : 2,
 "id" : "cluster_25_node_2",
 "ic" : "8.32",
 "size" : 19,
 "name" : "cluster_25_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_25_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_25_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m536_AT5G28300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m536_AT5G28300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m536_AT5G28300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m536_AT5G28300_logo.png",
 "name" : "AT5G28300",
 "ic" : "7.81",
 "size" : 19,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTTTACCGYG"
 },
 {
  "label": "a.t_motifs_m74_AT1G33240", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m74_AT1G33240_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m74_AT1G33240_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m74_AT1G33240_logo.png",
 "name" : "AT1G33240",
 "ic" : "8.36",
 "size" : 19,
 "title" : "a.t_motifs",
 "consensus_rc" : "TWTTTACYRT"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m159_AT1G76890", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m159_AT1G76890_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m159_AT1G76890_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m159_AT1G76890_logo.png",
 "name" : "AT1G76890",
 "ic" : "8.53",
 "size" : 19,
 "title" : "a.t_motifs",
 "consensus_rc" : "AHWRCRGTAAAWAW"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_25").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E13A85");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_25"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E13A85"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_25" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E13A85")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_25").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_25").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_25").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_25").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 8;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_26").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wyyhCACGCGCytyy",
 "branch" : 5,
 "id" : "cluster_26_node_5",
 "ic" : "7.99",
 "size" : 15,
 "name" : "cluster_26",
 "image" : "matrix-clustering_aligned_logos/cluster_26_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_26_logo_rc.png",

  "children": [
  {
  "consensus" : "wyyhCACGCGCytyy",
 "branch" : 3,
 "id" : "cluster_26_node_3",
 "ic" : "8.09",
 "size" : 15,
 "name" : "cluster_26_node_3_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_26_node_3_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_26_node_3_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yhcACGCGcTtt",
 "branch" : 1,
 "id" : "cluster_26_node_1",
 "ic" : "8.20",
 "size" : 15,
 "name" : "cluster_26_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_26_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_26_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m319_AT3G22170", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m319_AT3G22170_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m319_AT3G22170_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m319_AT3G22170_logo.png",
 "name" : "AT3G22170",
 "ic" : "8.31",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "WDAGCGCGTGWR"
 },
 {
  "label": "a.t_motifs_m496_AT5G09410", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m496_AT5G09410_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m496_AT5G09410_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m496_AT5G09410_logo.png",
 "name" : "AT5G09410",
 "ic" : "8.76",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "YHMACGCGYTTT"
 } 
 ] 
 },
 {
  "consensus" : "wyyhCACGCGCctcy",
 "branch" : 2,
 "id" : "cluster_26_node_2",
 "ic" : "8.74",
 "size" : 15,
 "name" : "cluster_26_node_2_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_26_node_2_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_26_node_2_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m178_AT2G02820", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m178_AT2G02820_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m178_AT2G02820_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m178_AT2G02820_logo.png",
 "name" : "AT2G02820",
 "ic" : "8.23",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "RGWGGMGCGTGKRKD"
 },
 {
  "label": "a.t_motifs_m403_AT4G15090", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m403_AT4G15090_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m403_AT4G15090_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m403_AT4G15090_logo.png",
 "name" : "AT4G15090",
 "ic" : "10.38",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "RRARGCGCGTGRRRT"
 } 
 ] 
 } 
 ] 
 },
 {
  "consensus" : "mCGCGthww",
 "branch" : 4,
 "id" : "cluster_26_node_4",
 "ic" : "5.05",
 "size" : 15,
 "name" : "cluster_26_node_4_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_26_node_4_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_26_node_4_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m199_AT2G22300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m199_AT2G22300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m199_AT2G22300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m199_AT2G22300_logo.png",
 "name" : "AT2G22300",
 "ic" : "6.03",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "NBDACRCGG"
 },
 {
  "label": "a.t_motifs_m604_AT5G64220", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m604_AT5G64220_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m604_AT5G64220_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m604_AT5G64220_logo.png",
 "name" : "AT5G64220",
 "ic" : "6.09",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "ACRCGSHTW"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_26").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D5547A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_26"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D5547A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_26" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D5547A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_26").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_26").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_26").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_26").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 11;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_27").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wwhwayACGymAcyth",
 "branch" : 8,
 "id" : "cluster_27_node_8",
 "ic" : "7.47",
 "size" : 16,
 "name" : "cluster_27",
 "image" : "matrix-clustering_aligned_logos/cluster_27_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_27_logo_rc.png",

  "children": [
  {
  "consensus" : "wwhwayACGymAcyth",
 "branch" : 7,
 "id" : "cluster_27_node_7",
 "ic" : "7.46",
 "size" : 16,
 "name" : "cluster_27_node_7_8motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_27_node_7_8motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_27_node_7_8motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwhwayACGymWcyt",
 "branch" : 5,
 "id" : "cluster_27_node_5",
 "ic" : "7.47",
 "size" : 16,
 "name" : "cluster_27_node_5_6motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_27_node_5_6motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_27_node_5_6motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wwhwayACGymWcyt",
 "branch" : 4,
 "id" : "cluster_27_node_4",
 "ic" : "7.55",
 "size" : 16,
 "name" : "cluster_27_node_4_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_27_node_4_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_27_node_4_5motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m279_AT3G04070", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m279_AT3G04070_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m279_AT3G04070_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m279_AT3G04070_logo.png",
 "name" : "AT3G04070",
 "ic" : "7.71",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWHWAYACGTMWCYT"
 },
 {
  "consensus" : "vtayACGymAyyt",
 "branch" : 3,
 "id" : "cluster_27_node_3",
 "ic" : "7.43",
 "size" : 16,
 "name" : "cluster_27_node_3_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_27_node_3_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_27_node_3_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "rkayACGymAyyt",
 "branch" : 2,
 "id" : "cluster_27_node_2",
 "ic" : "7.66",
 "size" : 16,
 "name" : "cluster_27_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_27_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_27_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "tayACGymAyyt",
 "branch" : 1,
 "id" : "cluster_27_node_1",
 "ic" : "7.71",
 "size" : 16,
 "name" : "cluster_27_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_27_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_27_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m103_AT1G52890", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m103_AT1G52890_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m103_AT1G52890_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m103_AT1G52890_logo.png",
 "name" : "AT1G52890",
 "ic" : "8.84",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "MRGTTVCGTRTA"
 },
 {
  "label": "a.t_motifs_m133_AT1G69490", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m133_AT1G69490_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m133_AT1G69490_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m133_AT1G69490_logo.png",
 "name" : "AT1G69490",
 "ic" : "7.37",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "ARRTKRCGTRT"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m141_AT1G71930", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m141_AT1G71930_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m141_AT1G71930_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m141_AT1G71930_logo.png",
 "name" : "AT1G71930",
 "ic" : "7.11",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "RGTKSCGTGTMY"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m383_AT3G61910", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m383_AT3G61910_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m383_AT3G61910_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m383_AT3G61910_logo.png",
 "name" : "AT3G61910",
 "ic" : "6.44",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "WSRTTGCGTRTWS"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m480_AT5G04410", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m480_AT5G04410_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m480_AT5G04410_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m480_AT5G04410_logo.png",
 "name" : "AT5G04410",
 "ic" : "6.62",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "TBTKGCKTGYTA"
 } 
 ] 
 },
 {
  "consensus" : "datTACGCwACCbh",
 "branch" : 6,
 "id" : "cluster_27_node_6",
 "ic" : "9.85",
 "size" : 16,
 "name" : "cluster_27_node_6_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_27_node_6_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_27_node_6_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m244_AT2G42400", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m244_AT2G42400_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m244_AT2G42400_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m244_AT2G42400_logo.png",
 "name" : "AT2G42400",
 "ic" : "9.90",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "DTACGCWACCBH"
 },
 {
  "label": "a.t_motifs_m72_AT1G32770", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m72_AT1G32770_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m72_AT1G32770_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m72_AT1G32770_logo.png",
 "name" : "AT1G32770",
 "ic" : "10.60",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "DATTACGCAAYC"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m113_AT1G61110", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m113_AT1G61110_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m113_AT1G61110_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m113_AT1G61110_logo.png",
 "name" : "AT1G61110",
 "ic" : "7.84",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "RTTRCGTR"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_27").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C7676E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_27"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C7676E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_27" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C7676E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_27").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_27").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_27").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_27").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 8;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_28").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "awTTTrAATTTtwaAww",
 "branch" : 5,
 "id" : "cluster_28_node_5",
 "ic" : "11.58",
 "size" : 17,
 "name" : "cluster_28",
 "image" : "matrix-clustering_aligned_logos/cluster_28_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_28_logo_rc.png",

  "children": [
  {
  "consensus" : "wTTTrAATTTtwaAww",
 "branch" : 4,
 "id" : "cluster_28_node_4",
 "ic" : "11.63",
 "size" : 17,
 "name" : "cluster_28_node_4_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_28_node_4_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_28_node_4_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wTTTrAATTTtwaAww",
 "branch" : 2,
 "id" : "cluster_28_node_2",
 "ic" : "11.89",
 "size" : 17,
 "name" : "cluster_28_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_28_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_28_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "wTTTrAATTTtwaAw",
 "branch" : 1,
 "id" : "cluster_28_node_1",
 "ic" : "11.55",
 "size" : 17,
 "name" : "cluster_28_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_28_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_28_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m402_AT4G14770", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m402_AT4G14770_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m402_AT4G14770_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m402_AT4G14770_logo.png",
 "name" : "AT4G14770",
 "ic" : "12.26",
 "size" : 17,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTTYRAATTTTRAAW"
 },
 {
  "label": "a.t_motifs_m193_AT2G20110", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m193_AT2G20110_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m193_AT2G20110_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m193_AT2G20110_logo.png",
 "name" : "AT2G20110",
 "ic" : "12.14",
 "size" : 17,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTWAAAWATTYAAAW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m321_AT3G22780", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m321_AT3G22780_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m321_AT3G22780_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m321_AT3G22780_logo.png",
 "name" : "AT3G22780",
 "ic" : "12.27",
 "size" : 17,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTRAATTTTWAWWW"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m228_AT2G36610", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m228_AT2G36610_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m228_AT2G36610_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m228_AT2G36610_logo.png",
 "name" : "AT2G36610",
 "ic" : "6.21",
 "size" : 17,
 "title" : "a.t_motifs",
 "consensus_rc" : "AWWWAWATTATWA"
 } 
 ] 
 },
 {
  "consensus" : "arTTTRAAtt",
 "branch" : 3,
 "id" : "cluster_28_node_3",
 "ic" : "7.67",
 "size" : 17,
 "name" : "cluster_28_node_3_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_28_node_3_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_28_node_3_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m320_AT3G22760", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m320_AT3G22760_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m320_AT3G22760_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m320_AT3G22760_logo.png",
 "name" : "AT3G22760",
 "ic" : "7.27",
 "size" : 17,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTTYAAAH"
 },
 {
  "label": "a.t_motifs_m438_AT4G29000", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m438_AT4G29000_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m438_AT4G29000_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m438_AT4G29000_logo.png",
 "name" : "AT4G29000",
 "ic" : "8.48",
 "size" : 17,
 "title" : "a.t_motifs",
 "consensus_rc" : "ARTTCAAAYT"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_28").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B97662");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_28"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B97662"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_28" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B97662")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_28").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_28").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_28").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_28").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 5;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_29").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "AGAGAGAGAGAGAGAGAGAGAGAGAGAGAG",
 "branch" : 2,
 "id" : "cluster_29_node_2",
 "ic" : "30.15",
 "size" : 30,
 "name" : "cluster_29",
 "image" : "matrix-clustering_aligned_logos/cluster_29_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_29_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m469_AT4G38910", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m469_AT4G38910_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m469_AT4G38910_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m469_AT4G38910_logo.png",
 "name" : "AT4G38910",
 "ic" : "37.76",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "CTCTCTCTCTCTCTCTCTCTCTCTCTCTCT"
 },
 {
  "consensus" : "GAGAGAGAGAGAGAGAGAGAGAGA",
 "branch" : 1,
 "id" : "cluster_29_node_1",
 "ic" : "22.29",
 "size" : 30,
 "name" : "cluster_29_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_29_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_29_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m172_AT2G01930", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m172_AT2G01930_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m172_AT2G01930_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m172_AT2G01930_logo.png",
 "name" : "AT2G01930",
 "ic" : "22.26",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "TCTCTCTCTCTCTCTCTCTCTCTC"
 },
 {
  "label": "a.t_motifs_m548_AT5G42520", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m548_AT5G42520_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m548_AT5G42520_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m548_AT5G42520_logo.png",
 "name" : "AT5G42520",
 "ic" : "21.15",
 "size" : 30,
 "title" : "a.t_motifs",
 "consensus_rc" : "KAGAGAGAGAGAGAGAGAGAG"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_29").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AA8356");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_29"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AA8356"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_29" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AA8356")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_29").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_29").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_29").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_29").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 8;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_30").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wcacthwCACTmthh",
 "branch" : 5,
 "id" : "cluster_30_node_5",
 "ic" : "5.45",
 "size" : 15,
 "name" : "cluster_30",
 "image" : "matrix-clustering_aligned_logos/cluster_30_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_30_logo_rc.png",

  "children": [
  {
  "consensus" : "yywcywwCACTmthh",
 "branch" : 4,
 "id" : "cluster_30_node_4",
 "ic" : "6.44",
 "size" : 15,
 "name" : "cluster_30_node_4_5motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_30_node_4_5motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_30_node_4_5motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yywcywtCACTmthh",
 "branch" : 3,
 "id" : "cluster_30_node_3",
 "ic" : "6.48",
 "size" : 15,
 "name" : "cluster_30_node_3_4motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_30_node_3_4motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_30_node_3_4motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yywcywtCACTmthh",
 "branch" : 2,
 "id" : "cluster_30_node_2",
 "ic" : "6.64",
 "size" : 15,
 "name" : "cluster_30_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_30_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_30_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "ywcywwCACTm",
 "branch" : 1,
 "id" : "cluster_30_node_1",
 "ic" : "5.93",
 "size" : 15,
 "name" : "cluster_30_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_30_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_30_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m479_AT5G04390", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m479_AT5G04390_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m479_AT5G04390_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m479_AT5G04390_logo.png",
 "name" : "AT5G04390",
 "ic" : "6.45",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "YWMYWWCACTH"
 },
 {
  "label": "a.t_motifs_m55_AT1G27730", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m55_AT1G27730_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m55_AT1G27730_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m55_AT1G27730_logo.png",
 "name" : "AT1G27730",
 "ic" : "6.49",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "KASTGDDASWR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m345_AT3G46070", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m345_AT3G46070_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m345_AT3G46070_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m345_AT3G46070_logo.png",
 "name" : "AT3G46070",
 "ic" : "8.48",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "DDAGAGTGARRDWRR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m346_AT3G46090", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m346_AT3G46090_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m346_AT3G46090_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m346_AT3G46090_logo.png",
 "name" : "AT3G46090",
 "ic" : "5.62",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "CAGYACACTVDDK"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m478_AT5G04340", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m478_AT5G04340_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m478_AT5G04340_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m478_AT5G04340_logo.png",
 "name" : "AT5G04340",
 "ic" : "7.80",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "KTAGTGTTAR"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m618_AT5G67450", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m618_AT5G67450_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m618_AT5G67450_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m618_AT5G67450_logo.png",
 "name" : "AT5G67450",
 "ic" : "6.96",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "WCACTSWCWCW"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 200; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_30").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#998E49");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_30"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#998E49"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_30" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#998E49")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_30").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_30").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_30").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_30").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 5;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_31").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "wyrTCGCCGGArawdt",
 "branch" : 2,
 "id" : "cluster_31_node_2",
 "ic" : "9.22",
 "size" : 16,
 "name" : "cluster_31",
 "image" : "matrix-clustering_aligned_logos/cluster_31_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_31_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m304_AT3G14180", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m304_AT3G14180_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m304_AT3G14180_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m304_AT3G14180_logo.png",
 "name" : "AT3G14180",
 "ic" : "9.51",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "WTYTCCGGYGA"
 },
 {
  "consensus" : "wyrtCGCCGGArawdt",
 "branch" : 1,
 "id" : "cluster_31_node_1",
 "ic" : "9.05",
 "size" : 16,
 "name" : "cluster_31_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_31_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_31_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m372_AT3G58630", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m372_AT3G58630_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m372_AT3G58630_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m372_AT3G58630_logo.png",
 "name" : "AT3G58630",
 "ic" : "9.32",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "YGTCGCCGGAGAWDT"
 },
 {
  "label": "a.t_motifs_m483_AT5G05550", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m483_AT5G05550_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m483_AT5G05550_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m483_AT5G05550_logo.png",
 "name" : "AT5G05550",
 "ic" : "8.98",
 "size" : 16,
 "title" : "a.t_motifs",
 "consensus_rc" : "WYRTCGCCGGARAWD"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_31").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#87983A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_31"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#87983A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_31" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#87983A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_31").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_31").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_31").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_31").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 6;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_32").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "trywTGCATGyatdt",
 "branch" : 3,
 "id" : "cluster_32_node_3",
 "ic" : "8.98",
 "size" : 15,
 "name" : "cluster_32",
 "image" : "matrix-clustering_aligned_logos/cluster_32_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_32_logo_rc.png",

  "children": [
  {
  "consensus" : "cTGCwTGCa",
 "branch" : 2,
 "id" : "cluster_32_node_2",
 "ic" : "7.70",
 "size" : 15,
 "name" : "cluster_32_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_32_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_32_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m532_AT5G25475", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m532_AT5G25475_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m532_AT5G25475_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m532_AT5G25475_logo.png",
 "name" : "AT5G25475",
 "ic" : "7.99",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGCTTG"
 },
 {
  "consensus" : "ctGCATGCa",
 "branch" : 1,
 "id" : "cluster_32_node_1",
 "ic" : "7.38",
 "size" : 15,
 "name" : "cluster_32_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_32_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_32_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m331_AT3G24650", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m331_AT3G24650_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m331_AT3G24650_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m331_AT3G24650_logo.png",
 "name" : "AT3G24650",
 "ic" : "7.13",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGCATGCAR"
 },
 {
  "label": "a.t_motifs_m57_AT1G28300", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m57_AT1G28300_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m57_AT1G28300_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m57_AT1G28300_logo.png",
 "name" : "AT1G28300",
 "ic" : "10.44",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCATGCAK"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m335_AT3G26790", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m335_AT3G26790_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m335_AT3G26790_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m335_AT3G26790_logo.png",
 "name" : "AT3G26790",
 "ic" : "10.24",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "TRYWTGCATGYATDT"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_32").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#71A228");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_32"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#71A228"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_32" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#71A228")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_32").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_32").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_32").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_32").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 6;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_33").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "tyydyCTcGrrAwyCGtGcmm",
 "branch" : 3,
 "id" : "cluster_33_node_3",
 "ic" : "9.41",
 "size" : 21,
 "name" : "cluster_33",
 "image" : "matrix-clustering_aligned_logos/cluster_33_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_33_logo_rc.png",

  "children": [
  {
  "consensus" : "tyydycTcGrrAwyCGtGcmm",
 "branch" : 2,
 "id" : "cluster_33_node_2",
 "ic" : "9.19",
 "size" : 21,
 "name" : "cluster_33_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_33_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_33_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "consensus" : "yykycTcGrrAwyCGtGcm",
 "branch" : 1,
 "id" : "cluster_33_node_1",
 "ic" : "8.87",
 "size" : 21,
 "name" : "cluster_33_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_33_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_33_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m500_AT5G10510", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m500_AT5G10510_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m500_AT5G10510_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m500_AT5G10510_logo.png",
 "name" : "AT5G10510",
 "ic" : "8.05",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "GCACGRWTYYCGAKR"
 },
 {
  "label": "a.t_motifs_m317_AT3G20840", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m317_AT3G20840_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m317_AT3G20840_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m317_AT3G20840_logo.png",
 "name" : "AT3G20840",
 "ic" : "10.05",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "YYKYCTCGRRAWYCGTGCM"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m465_AT4G37750", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m465_AT4G37750_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m465_AT4G37750_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m465_AT4G37750_logo.png",
 "name" : "AT4G37750",
 "ic" : "13.38",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "TKCRCMTBGGGAWCYGTGCMM"
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m610_AT5G65510", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m610_AT5G65510_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m610_AT5G65510_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m610_AT5G65510_logo.png",
 "name" : "AT5G65510",
 "ic" : "7.23",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "CTCGRRAWYCG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_33").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#71A61C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_33"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#71A61C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_33" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#71A61C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_33").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_33").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_33").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_33").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 6;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_34").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "tTGAAAACw",
 "branch" : 3,
 "id" : "cluster_34_node_3",
 "ic" : "8.14",
 "size" : 9,
 "name" : "cluster_34",
 "image" : "matrix-clustering_aligned_logos/cluster_34_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_34_logo_rc.png",

  "children": [
  {
  "consensus" : "tTGAAAACa",
 "branch" : 2,
 "id" : "cluster_34_node_2",
 "ic" : "8.53",
 "size" : 9,
 "name" : "cluster_34_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_34_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_34_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m302_AT3G13040", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m302_AT3G13040_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m302_AT3G13040_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m302_AT3G13040_logo.png",
 "name" : "AT3G13040",
 "ic" : "8.63",
 "size" : 9,
 "title" : "a.t_motifs",
 "consensus_rc" : "TGTTTTCWT"
 },
 {
  "consensus" : "TTGAAAAs",
 "branch" : 1,
 "id" : "cluster_34_node_1",
 "ic" : "9.54",
 "size" : 9,
 "name" : "cluster_34_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_34_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_34_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m241_AT2G41835", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m241_AT2G41835_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m241_AT2G41835_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m241_AT2G41835_logo.png",
 "name" : "AT2G41835",
 "ic" : "9.47",
 "size" : 9,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTTTCAA"
 },
 {
  "label": "a.t_motifs_m19_AT1G09030", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m19_AT1G09030_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m19_AT1G09030_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m19_AT1G09030_logo.png",
 "name" : "AT1G09030",
 "ic" : "8.33",
 "size" : 9,
 "title" : "a.t_motifs",
 "consensus_rc" : "STTTTCA"
 } 
 ] 
 } 
 ] 
 },
 {
  "label": "a.t_motifs_m355_AT3G49930", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m355_AT3G49930_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m355_AT3G49930_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m355_AT3G49930_logo.png",
 "name" : "AT3G49930",
 "ic" : "8.24",
 "size" : 9,
 "title" : "a.t_motifs",
 "consensus_rc" : "WGATTTC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_34").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#83A81A");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_34"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#83A81A"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_34" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#83A81A")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_34").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_34").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_34").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_34").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 6;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_35").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "waaawhmtwwrCCCTAAwyyyTAA",
 "branch" : 3,
 "id" : "cluster_35_node_3",
 "ic" : "13.17",
 "size" : 24,
 "name" : "cluster_35",
 "image" : "matrix-clustering_aligned_logos/cluster_35_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_35_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m42_AT1G19790", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m42_AT1G19790_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m42_AT1G19790_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m42_AT1G19790_logo.png",
 "name" : "AT1G19790",
 "ic" : "24.28",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTAGGGTTTAGGGTTTAGGGTTT"
 },
 {
  "consensus" : "waawwhhtwwrCCCTAAwyyy",
 "branch" : 2,
 "id" : "cluster_35_node_2",
 "ic" : "9.71",
 "size" : 24,
 "name" : "cluster_35_node_2_3motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_35_node_2_3motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_35_node_2_3motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m220_AT2G33550", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m220_AT2G33550_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m220_AT2G33550_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m220_AT2G33550_logo.png",
 "name" : "AT2G33550",
 "ic" : "7.81",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "TTWAGGGYWWWTWTTTTW"
 },
 {
  "consensus" : "awwhhtwARCCCTAAwyyy",
 "branch" : 1,
 "id" : "cluster_35_node_1",
 "ic" : "11.13",
 "size" : 24,
 "name" : "cluster_35_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_35_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_35_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m145_AT1G72740", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m145_AT1G72740_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m145_AT1G72740_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m145_AT1G72740_logo.png",
 "name" : "AT1G72740",
 "ic" : "12.28",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "GRWTTAGGGTTTAGG"
 },
 {
  "label": "a.t_motifs_m619_AT5G67580", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m619_AT5G67580_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m619_AT5G67580_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m619_AT5G67580_logo.png",
 "name" : "AT5G67580",
 "ic" : "10.97",
 "size" : 24,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWAWTTAGGGYWWADWWWT"
 } 
 ] 
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_35").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#94A917");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_35"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#94A917"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_35" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#94A917")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_35").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_35").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_35").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_35").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_36").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "ygaarwCGAwgwCGw",
 "branch" : 1,
 "id" : "cluster_36_node_1",
 "ic" : "7.28",
 "size" : 15,
 "name" : "cluster_36",
 "image" : "matrix-clustering_aligned_logos/cluster_36_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_36_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m185_AT2G15740", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m185_AT2G15740_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m185_AT2G15740_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m185_AT2G15740_logo.png",
 "name" : "AT2G15740",
 "ic" : "6.79",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "WCGTCRYCGWY"
 },
 {
  "label": "a.t_motifs_m527_AT5G22990", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m527_AT5G22990_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m527_AT5G22990_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m527_AT5G22990_logo.png",
 "name" : "AT5G22990",
 "ic" : "7.84",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "YGAARWCGAWGWCGW"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_36").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A4AA14");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_36"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A4AA14"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_36" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A4AA14")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_36").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_36").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_36").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_36").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_37").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "TTAAGTAAT",
 "branch" : 1,
 "id" : "cluster_37_node_1",
 "ic" : "9.02",
 "size" : 9,
 "name" : "cluster_37",
 "image" : "matrix-clustering_aligned_logos/cluster_37_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_37_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m378_AT3G60580", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m378_AT3G60580_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m378_AT3G60580_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m378_AT3G60580_logo.png",
 "name" : "AT3G60580",
 "ic" : "6.48",
 "size" : 9,
 "title" : "a.t_motifs",
 "consensus_rc" : "YTACTWMW"
 },
 {
  "label": "a.t_motifs_m455_AT4G35580", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m455_AT4G35580_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m455_AT4G35580_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m455_AT4G35580_logo.png",
 "name" : "AT4G35580",
 "ic" : "11.48",
 "size" : 9,
 "title" : "a.t_motifs",
 "consensus_rc" : "ATTACTTAA"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_37").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B4AA11");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_37"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B4AA11"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_37" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B4AA11")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_37").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_37").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_37").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_37").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 5;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_38").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "cCwTTAGGkyg",
 "branch" : 2,
 "id" : "cluster_38_node_2",
 "ic" : "8.94",
 "size" : 11,
 "name" : "cluster_38",
 "image" : "matrix-clustering_aligned_logos/cluster_38_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_38_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m360_AT3G51060", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m360_AT3G51060_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m360_AT3G51060_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m360_AT3G51060_logo.png",
 "name" : "AT3G51060",
 "ic" : "9.26",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "VCCCTAGGGG"
 },
 {
  "consensus" : "wTTAGGkyg",
 "branch" : 1,
 "id" : "cluster_38_node_1",
 "ic" : "8.13",
 "size" : 11,
 "name" : "cluster_38_node_1_2motifs",
 "image" : "matrix-clustering_aligned_logos/cluster_38_node_1_2motifs_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_38_node_1_2motifs_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m32_AT1G15720", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m32_AT1G15720_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m32_AT1G15720_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m32_AT1G15720_logo.png",
 "name" : "AT1G15720",
 "ic" : "8.86",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "WGCCCTAR"
 },
 {
  "label": "a.t_motifs_m95_AT1G49950", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m95_AT1G49950_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m95_AT1G49950_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m95_AT1G49950_logo.png",
 "name" : "AT1G49950",
 "ic" : "8.33",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "CRMCCTAAW"
 } 
 ] 
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_38").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C3AB0D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_38"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C3AB0D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_38" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C3AB0D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_38").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_38").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_38").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_38").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_39").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "ryGtcyAgrTwCAwTGwatht",
 "branch" : 1,
 "id" : "cluster_39_node_1",
 "ic" : "8.85",
 "size" : 21,
 "name" : "cluster_39",
 "image" : "matrix-clustering_aligned_logos/cluster_39_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_39_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m147_AT1G73730", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m147_AT1G73730_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m147_AT1G73730_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m147_AT1G73730_logo.png",
 "name" : "AT1G73730",
 "ic" : "11.11",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "ADATWYWWTGAAYCTRGACRY"
 },
 {
  "label": "a.t_motifs_m316_AT3G20770", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m316_AT3G20770_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m316_AT3G20770_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m316_AT3G20770_logo.png",
 "name" : "AT3G20770",
 "ic" : "8.00",
 "size" : 21,
 "title" : "a.t_motifs",
 "consensus_rc" : "WCAWTGWAYYTRGAC"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_39").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D2AB08");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_39"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D2AB08"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_39" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D2AB08")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_39").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_39").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_39").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_39").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_40").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "mmyTAACYrTrGTTAAawywtaacm",
 "branch" : 1,
 "id" : "cluster_40_node_1",
 "ic" : "12.74",
 "size" : 25,
 "name" : "cluster_40",
 "image" : "matrix-clustering_aligned_logos/cluster_40_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_40_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m29_AT1G13450", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m29_AT1G13450_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m29_AT1G13450_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m29_AT1G13450_logo.png",
 "name" : "AT1G13450",
 "ic" : "10.43",
 "size" : 25,
 "title" : "a.t_motifs",
 "consensus_rc" : "RWTTTAACYAYRGTTARKK"
 },
 {
  "label": "a.t_motifs_m333_AT3G25990", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m333_AT3G25990_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m333_AT3G25990_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m333_AT3G25990_logo.png",
 "name" : "AT3G25990",
 "ic" : "15.86",
 "size" : 25,
 "title" : "a.t_motifs",
 "consensus_rc" : "KGTTAWRWTTTAACCATGGTT"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_40").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E1AB03");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_40"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E1AB03"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_40" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E1AB03")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_40").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_40").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_40").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_40").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 4;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_41").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
  {
  "consensus" : "yhtkktCAGGTgwtwtCTg",
 "branch" : 1,
 "id" : "cluster_41_node_1",
 "ic" : "9.06",
 "size" : 19,
 "name" : "cluster_41",
 "image" : "matrix-clustering_aligned_logos/cluster_41_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/cluster_41_logo_rc.png",

  "children": [
  {
  "label": "a.t_motifs_m391_AT4G01500", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m391_AT4G01500_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m391_AT4G01500_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m391_AT4G01500_logo.png",
 "name" : "AT4G01500",
 "ic" : "7.99",
 "size" : 19,
 "title" : "a.t_motifs",
 "consensus_rc" : "AWWWCACCTGAMMARR"
 },
 {
  "label": "a.t_motifs_m526_AT5G22890", 
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m526_AT5G22890_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m526_AT5G22890_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m526_AT5G22890_logo.png",
 "name" : "AT5G22890",
 "ic" : "10.15",
 "size" : 19,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWRKGYAGGTKTTATCTG"
 } 
 ] 
 } 
 ]}
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_41").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#E0A607");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_41"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#E0A607"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_41" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#E0A607")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_41").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_41").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_41").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_41").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_42").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m286_AT3G10030",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m286_AT3G10030_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m286_AT3G10030_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m286_AT3G10030_logo.png",
 "name" : "AT3G10030",
 "ic" : "9.67",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "TRACGCCGTTAAHT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_42").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#D79F0D");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_42"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#D79F0D"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_42" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#D79F0D")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_42").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_42").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_42").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_42").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_43").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m429_AT4G24470",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m429_AT4G24470_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m429_AT4G24470_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m429_AT4G24470_logo.png",
 "name" : "AT4G24470",
 "ic" : "11.64",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "AWYSRACGGYYRAGA"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_43").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#CF9811");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_43"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#CF9811"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_43" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#CF9811")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_43").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_43").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_43").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_43").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_44").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m77_AT1G34370",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m77_AT1G34370_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m77_AT1G34370_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m77_AT1G34370_logo.png",
 "name" : "AT1G34370",
 "ic" : "7.48",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "TYAWCYGGKGAAGGT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_44").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#C79115");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_44"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#C79115"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_44" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#C79115")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_44").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_44").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_44").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_44").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_45").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m98_AT1G51220",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m98_AT1G51220_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m98_AT1G51220_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m98_AT1G51220_logo.png",
 "name" : "AT1G51220",
 "ic" : "7.36",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "YWTGTTCTSCAGGTW"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_45").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#BF8A17");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_45"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#BF8A17"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_45" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#BF8A17")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_45").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_45").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_45").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_45").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_46").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m586_AT5G60120",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m586_AT5G60120_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m586_AT5G60120_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m586_AT5G60120_logo.png",
 "name" : "AT5G60120",
 "ic" : "8.71",
 "size" : 10,
 "title" : "a.t_motifs",
 "consensus_rc" : "WCGTAGGTTW"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_46").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#B78419");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_46"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#B78419"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_46" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#B78419")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_46").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_46").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_46").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_46").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_47").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m405_AT4G16150",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m405_AT4G16150_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m405_AT4G16150_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m405_AT4G16150_logo.png",
 "name" : "AT4G16150",
 "ic" : "7.86",
 "size" : 18,
 "title" : "a.t_motifs",
 "consensus_rc" : "MACRCGBTTYWYACRCGK"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_47").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#AF7D1B");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_47"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#AF7D1B"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_47" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#AF7D1B")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_47").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_47").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_47").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_47").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_48").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m148_AT1G74480",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m148_AT1G74480_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m148_AT1G74480_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m148_AT1G74480_logo.png",
 "name" : "AT1G74480",
 "ic" : "10.95",
 "size" : 19,
 "title" : "a.t_motifs",
 "consensus_rc" : "RRGGAAGAYGAARMGTCRC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_48").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A7761C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_48"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A7761C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_48" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A7761C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_48").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_48").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_48").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_48").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_49").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m517_AT5G18090",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m517_AT5G18090_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m517_AT5G18090_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m517_AT5G18090_logo.png",
 "name" : "AT5G18090",
 "ic" : "8.87",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "HTYTKYTTCATCWTC"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_49").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#A07428");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_49"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#A07428"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_49" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#A07428")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_49").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_49").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_49").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_49").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_50").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m157_AT1G76870",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m157_AT1G76870_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m157_AT1G76870_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m157_AT1G76870_logo.png",
 "name" : "AT1G76870",
 "ic" : "8.23",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "WWSYGGTTTWRKWT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_50").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#987233");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_50"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#987233"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_50" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#987233")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_50").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_50").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_50").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_50").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_51").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m44_AT1G20640",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m44_AT1G20640_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m44_AT1G20640_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m44_AT1G20640_logo.png",
 "name" : "AT1G20640",
 "ic" : "7.73",
 "size" : 15,
 "title" : "a.t_motifs",
 "consensus_rc" : "TSYYGCTGCTGCWDH"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_51").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#91703C");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_51"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#91703C"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_51" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#91703C")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_51").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_51").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_51").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_51").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_52").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m31_AT1G14687",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m31_AT1G14687_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m31_AT1G14687_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m31_AT1G14687_logo.png",
 "name" : "AT1G14687",
 "ic" : "7.84",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "AWWATDCGWWW"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_52").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#896D45");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_52"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#896D45"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_52" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#896D45")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_52").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_52").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_52").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_52").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_53").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m184_AT2G06200",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m184_AT2G06200_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m184_AT2G06200_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m184_AT2G06200_logo.png",
 "name" : "AT2G06200",
 "ic" : "8.83",
 "size" : 14,
 "title" : "a.t_motifs",
 "consensus_rc" : "TCTGACAMWWTYWS"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_53").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#816B4E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_53"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#816B4E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_53" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#816B4E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_53").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_53").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_53").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_53").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_54").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m22_AT1G09770",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m22_AT1G09770_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m22_AT1G09770_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m22_AT1G09770_logo.png",
 "name" : "AT1G09770",
 "ic" : "8.22",
 "size" : 11,
 "title" : "a.t_motifs",
 "consensus_rc" : "CSCGCTGAGSY"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_54").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#796956");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_54"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#796956"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_54" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#796956")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_54").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_54").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_54").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_54").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_55").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m352_AT3G48430",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m352_AT3G48430_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m352_AT3G48430_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m352_AT3G48430_logo.png",
 "name" : "AT3G48430",
 "ic" : "11.50",
 "size" : 12,
 "title" : "a.t_motifs",
 "consensus_rc" : "TRCTCTGTTTYT"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_55").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#70675E");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_55"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#70675E"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_55" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#70675E")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_55").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_55").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_55").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_55").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	




	(function() {
        var width = 2500,
	height = 50 + 87 * 3;
	;

        var i = 0,
        duration = 750,
        root;

	var cluster = d3.layout.cluster()
		.size([height, 350])
	        .separation(function(a, b) { return (a.parent == b.parent ? 1 : 1); });


	var diagonal = function elbow(d, i) {
		
		return "M" + d.source.y + "," + d.source.x
		+ "V" + d.target.x + "H" + d.target.y;
	}


	var svg = d3.select("#cluster_56").append("svg")
		.attr("width", width)
		.attr("height", height)
		.append("g")
		.attr("class","drawarea")
		.attr("transform", "translate(90,0)");
		

       var jsontree = {
 "name": "",
 "children":[
 {
  "label": "a.t_motifs_m593_AT5G61850",
 
 "image" : "matrix-clustering_aligned_logos/a.t_motifs_m593_AT5G61850_logo.png",
 "image_rc" : "matrix-clustering_aligned_logos/a.t_motifs_m593_AT5G61850_logo_rc.png",
 "url" : "matrix-clustering_aligned_logos/a.t_motifs_m593_AT5G61850_logo.png",
 "name" : "AT5G61850",
 "ic" : "12.46",
 "size" : 19,
 "title" : "a.t_motifs",
 "consensus_rc" : "YATKRACCGSCGGTYMATR"
 }
 ]
 }
;

	root = jsontree;
	root.x0 = height / 2;
	root.y0 = 0;	
	update(root);

function update(source) {

// compute the new height
var levelWidth = [1];
var childCount = function(level, n) {

  if (n.children && n.children.length > 0) {
    if (levelWidth.length <= level + 1) levelWidth.push(0);

    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 150; // 20 pixels per line  // 250 ----------> This number must be calculated 
cluster= cluster.size([newHeight, 350]);

// Re-draw the tree
svg = d3.select("#cluster_56").select("svg")
		.attr("width", width)
		.attr("height", newHeight)
		.attr("transform", "translate(90,0)");

  // Compute the new tree layout.
  var nodes = cluster.nodes(root).reverse(),
      links = cluster.links(nodes);

  // Update the nodes…
  var node = svg.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent"s previous position.
  var nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", click);

  nodeEnter.append("circle")
	.attr("r", 5)
        .attr("fill", "#666666");

	nodeEnter.append("a")
			.attr("xlink:href", function(d) { return d.link_ext; })
			.append("text")
        		.style("font-size", "20px")
			.text(function(d) { return d.children ? "" :  d.name; })
			.attr("dx", function(d) { return d.children ? 0 : 20; })
			.attr("dy", function(d) { return d.children ? 0 : 3; })
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "start"; });


	nodeEnter.append("text")
			.text(function(d) { return d.children ? "" : d.ic; })
			.attr("x", function(d) { return d.children ? 0 : -5; })
			.attr("dy", function(d) { return d.children ? 0 : -2; })
			.attr("class", function(d) { return d.children ? "" : "show_con_cluster_56"; })
			.attr("display", function(d) { return d.children ? "" : "none"; })
        		.attr("font-size", "20px")
			.style("fill", "blue")
			.attr("text-anchor", function(d) { return d.children ? "end" : "end"; });

       /*Insert labels*/

       /*Insert consensus*/

	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
		.attr("x", 180)    
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");	

/*		
	nodeEnter.append("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 13)
  		.attr("x", function(d) { return (d.size + 2)  * 2 + 180 + 7; })  
		.attr("y", -7) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });


  nodeUpdate.select("circle")
	.attr("r", 5)
        .attr("fill", function(d) { return d._children ? "black" : "#666666"; })
      .attr("font-size", "15px");


  nodeUpdate.select("text")
      .text(function(d) { return d.children ? d.ic :  d.name; })
      .attr("dx", function(d) { return d.children ? -3 : 20; })
      .attr("dy", function(d) { return d.children ? -6 : 3; })
      .attr("class", function(d) { return d.children ? "show_con_cluster_56" : ""; })
      .style("display", function(d) { return d.children ? "none" : ""; })
      .attr("fill", function(d) { return d.children ? "blue" : "black"; })
      .attr("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .attr("font-size", "20px");

	nodeUpdate.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
		.attr("width", function(d) { return (d.size + 2)  * 15; })
		.attr("height", 80)
		.attr("x", 165)    
		.attr("y", -33) 
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");

/*
	node.select("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; })  
		.attr("width", function(d) { return (d.size + 2)  * 25; })
		.attr("height", 80)
 		.attr("x", function(d) { return (d.size + 2)  * 25 + 296 + 25; })  
		.attr("y", -33)
		.attr("cursor", "default") 
		.attr("preserveAspectRatio", "none");
*/


  // Transition exiting nodes to the parent"s new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6)
      .attr("font-size", "15px");

  nodeExit.selectAll("image")
      .remove();

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = svg.selectAll("path.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links at the parent"s previous position.
  link.enter().insert("path", "g")
      .attr("class", "link")
      .attr("stroke", "#666666")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      });

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent"s new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });


// Toggle children on click.
function click(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
  update(d);
}
}


})();

// Add the buttons to change the orientation
d3.select("#cluster_56").append("text")
	.attr("x", 700)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_56").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image; }) 
	})
	.text("Direct");  


d3.select("#cluster_56").append("text")
	.attr("x", 1000)             
	.attr("y", 0)   
      .attr("font-size", "10px") 
	.attr("class", "legend")     
	.on("click", function(){
		// change the orientation
		d3.select("#cluster_56").selectAll("image")
		.attr("xlink:href", function(d) { return d.children ? "" : d.image_rc; }) 
	})
	.text("Reverse") ; 

	





</script>



<!-- Dynamic JQuery code -->
<script>



d3.select("#cluster_1").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_1") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_1').click(function() {
        $('.show_con_cluster_1').toggle();
    }); 
});



d3.select("#cluster_2").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_2") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_2').click(function() {
        $('.show_con_cluster_2').toggle();
    }); 
});



d3.select("#cluster_3").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_3") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_3').click(function() {
        $('.show_con_cluster_3').toggle();
    }); 
});



d3.select("#cluster_4").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_4") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_4').click(function() {
        $('.show_con_cluster_4').toggle();
    }); 
});



d3.select("#cluster_5").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_5") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_5').click(function() {
        $('.show_con_cluster_5').toggle();
    }); 
});



d3.select("#cluster_6").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_6") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_6').click(function() {
        $('.show_con_cluster_6').toggle();
    }); 
});



d3.select("#cluster_7").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_7") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_7').click(function() {
        $('.show_con_cluster_7').toggle();
    }); 
});



d3.select("#cluster_8").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_8") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_8').click(function() {
        $('.show_con_cluster_8').toggle();
    }); 
});



d3.select("#cluster_9").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_9") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_9').click(function() {
        $('.show_con_cluster_9').toggle();
    }); 
});



d3.select("#cluster_10").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_10") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_10').click(function() {
        $('.show_con_cluster_10').toggle();
    }); 
});



d3.select("#cluster_11").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_11") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_11').click(function() {
        $('.show_con_cluster_11').toggle();
    }); 
});



d3.select("#cluster_12").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_12") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_12').click(function() {
        $('.show_con_cluster_12').toggle();
    }); 
});



d3.select("#cluster_13").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_13") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_13').click(function() {
        $('.show_con_cluster_13').toggle();
    }); 
});



d3.select("#cluster_14").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_14") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_14').click(function() {
        $('.show_con_cluster_14').toggle();
    }); 
});



d3.select("#cluster_15").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_15") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_15').click(function() {
        $('.show_con_cluster_15').toggle();
    }); 
});



d3.select("#cluster_16").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_16") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_16').click(function() {
        $('.show_con_cluster_16').toggle();
    }); 
});



d3.select("#cluster_17").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_17") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_17').click(function() {
        $('.show_con_cluster_17').toggle();
    }); 
});



d3.select("#cluster_18").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_18") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_18').click(function() {
        $('.show_con_cluster_18').toggle();
    }); 
});



d3.select("#cluster_19").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_19") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_19').click(function() {
        $('.show_con_cluster_19').toggle();
    }); 
});



d3.select("#cluster_20").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_20") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_20').click(function() {
        $('.show_con_cluster_20').toggle();
    }); 
});



d3.select("#cluster_21").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_21") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_21').click(function() {
        $('.show_con_cluster_21').toggle();
    }); 
});



d3.select("#cluster_22").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_22") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_22').click(function() {
        $('.show_con_cluster_22').toggle();
    }); 
});



d3.select("#cluster_23").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_23") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_23').click(function() {
        $('.show_con_cluster_23').toggle();
    }); 
});



d3.select("#cluster_24").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_24") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_24').click(function() {
        $('.show_con_cluster_24').toggle();
    }); 
});



d3.select("#cluster_25").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_25") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_25').click(function() {
        $('.show_con_cluster_25').toggle();
    }); 
});



d3.select("#cluster_26").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_26") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_26').click(function() {
        $('.show_con_cluster_26').toggle();
    }); 
});



d3.select("#cluster_27").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_27") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_27').click(function() {
        $('.show_con_cluster_27').toggle();
    }); 
});



d3.select("#cluster_28").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_28") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_28').click(function() {
        $('.show_con_cluster_28').toggle();
    }); 
});



d3.select("#cluster_29").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_29") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_29').click(function() {
        $('.show_con_cluster_29').toggle();
    }); 
});



d3.select("#cluster_30").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_30") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_30').click(function() {
        $('.show_con_cluster_30').toggle();
    }); 
});



d3.select("#cluster_31").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_31") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_31').click(function() {
        $('.show_con_cluster_31').toggle();
    }); 
});



d3.select("#cluster_32").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_32") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_32').click(function() {
        $('.show_con_cluster_32').toggle();
    }); 
});



d3.select("#cluster_33").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_33") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_33').click(function() {
        $('.show_con_cluster_33').toggle();
    }); 
});



d3.select("#cluster_34").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_34") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_34').click(function() {
        $('.show_con_cluster_34').toggle();
    }); 
});



d3.select("#cluster_35").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_35") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_35').click(function() {
        $('.show_con_cluster_35').toggle();
    }); 
});



d3.select("#cluster_36").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_36") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_36').click(function() {
        $('.show_con_cluster_36').toggle();
    }); 
});



d3.select("#cluster_37").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_37") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_37').click(function() {
        $('.show_con_cluster_37').toggle();
    }); 
});



d3.select("#cluster_38").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_38") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_38').click(function() {
        $('.show_con_cluster_38').toggle();
    }); 
});



d3.select("#cluster_39").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_39") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_39').click(function() {
        $('.show_con_cluster_39').toggle();
    }); 
});



d3.select("#cluster_40").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_40") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_40').click(function() {
        $('.show_con_cluster_40').toggle();
    }); 
});



d3.select("#cluster_41").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_41") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_41').click(function() {
        $('.show_con_cluster_41').toggle();
    }); 
});



d3.select("#cluster_42").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_42") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_42').click(function() {
        $('.show_con_cluster_42').toggle();
    }); 
});



d3.select("#cluster_43").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_43") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_43').click(function() {
        $('.show_con_cluster_43').toggle();
    }); 
});



d3.select("#cluster_44").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_44") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_44').click(function() {
        $('.show_con_cluster_44').toggle();
    }); 
});



d3.select("#cluster_45").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_45") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_45').click(function() {
        $('.show_con_cluster_45').toggle();
    }); 
});



d3.select("#cluster_46").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_46") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_46').click(function() {
        $('.show_con_cluster_46').toggle();
    }); 
});



d3.select("#cluster_47").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_47") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_47').click(function() {
        $('.show_con_cluster_47').toggle();
    }); 
});



d3.select("#cluster_48").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_48") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_48').click(function() {
        $('.show_con_cluster_48').toggle();
    }); 
});



d3.select("#cluster_49").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_49") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_49').click(function() {
        $('.show_con_cluster_49').toggle();
    }); 
});



d3.select("#cluster_50").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_50") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_50').click(function() {
        $('.show_con_cluster_50').toggle();
    }); 
});



d3.select("#cluster_51").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_51") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_51').click(function() {
        $('.show_con_cluster_51').toggle();
    }); 
});



d3.select("#cluster_52").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_52") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_52').click(function() {
        $('.show_con_cluster_52').toggle();
    }); 
});



d3.select("#cluster_53").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_53") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_53').click(function() {
        $('.show_con_cluster_53').toggle();
    }); 
});



d3.select("#cluster_54").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_54") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_54').click(function() {
        $('.show_con_cluster_54').toggle();
    }); 
});



d3.select("#cluster_55").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_55") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_55').click(function() {
        $('.show_con_cluster_55').toggle();
    }); 
});



d3.select("#cluster_56").append("text")
	.attr("x", 1000)             
	.attr("y", 0)    
	.attr("class", "legend")     
	.attr("id", "cons_button_cluster_56") 
      .attr("font-size", "20px")
	.text("IC") ; 


// Slide the Heatmap View
$(document).ready(function() {
    $('#cons_button_cluster_56').click(function() {
        $('.show_con_cluster_56').toggle();
    }); 
});



</script>
